static long mem_seek ( jas_stream_obj_t * obj , long offset , int origin ) //<S2SV> { //<S2SV> jas_stream_memobj_t * m = ( jas_stream_memobj_t * ) obj ; //<S2SV> long newpos ; //<S2SV> JAS_DBGLOG ( 100 , ( "mem_seek(%p,<S2SV_blank>%ld,<S2SV_blank>%d)\\n" , obj , offset , origin ) ) ; //<S2SV> switch ( origin ) { //<S2SV> case SEEK_SET : //<S2SV> newpos = offset ; //<S2SV> break ; //<S2SV> case SEEK_END : //<S2SV> newpos = m -> len_ - offset ; //<S2SV> break ; //<S2SV> case SEEK_CUR : //<S2SV> newpos = m -> pos_ + offset ; //<S2SV> break ; //<S2SV> default : //<S2SV> abort ( ) ; //<S2SV> break ; //<S2SV> } //<S2SV> if ( newpos < 0 ) { //<S2SV> return - 1 ; //<S2SV> } //<S2SV> m -> pos_ = newpos ; //<S2SV> return m -> pos_ ; //<S2SV> } //<S2SV> 