static int jp2_cmap_getdata ( jp2_box_t * box , jas_stream_t * in ) //<S2SV> { //<S2SV> jp2_cmap_t * cmap = & box -> data . cmap ; //<S2SV> jp2_cmapent_t * ent ; //<S2SV> unsigned int i ; //<S2SV> cmap -> numchans = ( box -> datalen ) / 4 ; //<S2SV> if ( ! ( cmap -> ents = jas_alloc2 ( cmap -> numchans , sizeof ( jp2_cmapent_t ) ) ) ) { //<S2SV> return - 1 ; //<S2SV> } //<S2SV> for ( i = 0 ; i < cmap -> numchans ; ++ i ) { //<S2SV> ent = & cmap -> ents [ i ] ; //<S2SV> if ( jp2_getuint16 ( in , & ent -> cmptno ) || //<S2SV> jp2_getuint8 ( in , & ent -> map ) || //<S2SV> jp2_getuint8 ( in , & ent -> pcol ) ) { //<S2SV> return - 1 ; //<S2SV> } //<S2SV> } //<S2SV> return 0 ; //<S2SV> } //<S2SV> 