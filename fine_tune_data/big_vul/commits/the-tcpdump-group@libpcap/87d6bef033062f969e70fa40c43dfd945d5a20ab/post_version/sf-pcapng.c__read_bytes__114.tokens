static int //<S2SV> read_bytes ( FILE * fp , void * buf , size_t bytes_to_read , int fail_on_eof , //<S2SV> char * errbuf ) //<S2SV> { //<S2SV> size_t amt_read ; //<S2SV> amt_read = fread ( buf , 1 , bytes_to_read , fp ) ; //<S2SV> if ( amt_read != bytes_to_read ) { //<S2SV> if ( ferror ( fp ) ) { //<S2SV> pcap_fmt_errmsg_for_errno ( errbuf , PCAP_ERRBUF_SIZE , //<S2SV> errno , "error<S2SV_blank>reading<S2SV_blank>dump<S2SV_blank>file" ) ; //<S2SV> } else { //<S2SV> if ( amt_read == 0 && ! fail_on_eof ) //<S2SV> return ( 0 ) ; //<S2SV> pcap_snprintf ( errbuf , PCAP_ERRBUF_SIZE , //<S2SV> "truncated<S2SV_blank>pcapng<S2SV_blank>dump<S2SV_blank>file;<S2SV_blank>tried<S2SV_blank>to<S2SV_blank>read<S2SV_blank>%" PRIsize "<S2SV_blank>bytes,<S2SV_blank>only<S2SV_blank>got<S2SV_blank>%" PRIsize , //<S2SV> bytes_to_read , amt_read ) ; //<S2SV> } //<S2SV> return ( - 1 ) ; //<S2SV> } //<S2SV> return ( 1 ) ; //<S2SV> } //<S2SV> 