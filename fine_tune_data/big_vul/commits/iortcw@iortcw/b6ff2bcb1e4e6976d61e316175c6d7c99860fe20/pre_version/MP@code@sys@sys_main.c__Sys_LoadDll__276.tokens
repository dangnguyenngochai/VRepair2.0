void * Sys_LoadDll ( const char * name , qboolean useSystemLib ) //<S2SV> { //<S2SV> void * dllhandle ; //<S2SV> if ( useSystemLib ) //<S2SV> Com_Printf ( "Trying<S2SV_blank>to<S2SV_blank>load<S2SV_blank>\\"%s\\"...\\n" , name ) ; //<S2SV> if ( ! useSystemLib || ! ( dllhandle = Sys_LoadLibrary ( name ) ) ) //<S2SV> { //<S2SV> const char * topDir ; //<S2SV> char libPath [ MAX_OSPATH ] ; //<S2SV> topDir = Sys_BinaryPath ( ) ; //<S2SV> if ( ! * topDir ) //<S2SV> topDir = "." ; //<S2SV> Com_Printf ( "Trying<S2SV_blank>to<S2SV_blank>load<S2SV_blank>\\"%s\\"<S2SV_blank>from<S2SV_blank>\\"%s\\"...\\n" , name , topDir ) ; //<S2SV> Com_sprintf ( libPath , sizeof ( libPath ) , "%s%c%s" , topDir , PATH_SEP , name ) ; //<S2SV> if ( ! ( dllhandle = Sys_LoadLibrary ( libPath ) ) ) //<S2SV> { //<S2SV> const char * basePath = Cvar_VariableString ( "fs_basepath" ) ; //<S2SV> if ( ! basePath || ! * basePath ) //<S2SV> basePath = "." ; //<S2SV> if ( FS_FilenameCompare ( topDir , basePath ) ) //<S2SV> { //<S2SV> Com_Printf ( "Trying<S2SV_blank>to<S2SV_blank>load<S2SV_blank>\\"%s\\"<S2SV_blank>from<S2SV_blank>\\"%s\\"...\\n" , name , basePath ) ; //<S2SV> Com_sprintf ( libPath , sizeof ( libPath ) , "%s%c%s" , basePath , PATH_SEP , name ) ; //<S2SV> dllhandle = Sys_LoadLibrary ( libPath ) ; //<S2SV> } //<S2SV> if ( ! dllhandle ) //<S2SV> Com_Printf ( "Loading<S2SV_blank>\\"%s\\"<S2SV_blank>failed\\n" , name ) ; //<S2SV> } //<S2SV> } //<S2SV> return dllhandle ; //<S2SV> } //<S2SV> 