int //<S2SV> set_interface_var ( const char * iface , //<S2SV> const char * var , const char * name , //<S2SV> uint32_t val ) //<S2SV> { //<S2SV> FILE * fp ; //<S2SV> char spath [ 64 + IFNAMSIZ ] ; //<S2SV> if ( snprintf ( spath , sizeof ( spath ) , var , iface ) >= sizeof ( spath ) ) //<S2SV> return - 1 ; //<S2SV> if ( strstr ( name , ".." ) || strchr ( name , '/' ) ) //<S2SV> return - 1 ; //<S2SV> if ( access ( spath , F_OK ) != 0 ) //<S2SV> return - 1 ; //<S2SV> fp = fopen ( spath , "w" ) ; //<S2SV> if ( ! fp ) { //<S2SV> if ( name ) //<S2SV> flog ( LOG_ERR , "failed<S2SV_blank>to<S2SV_blank>set<S2SV_blank>%s<S2SV_blank>(%u)<S2SV_blank>for<S2SV_blank>%s:<S2SV_blank>%s" , //<S2SV> name , val , iface , strerror ( errno ) ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> fprintf ( fp , "%u" , val ) ; //<S2SV> fclose ( fp ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 