static void //<S2SV> __xml_acl_post_process ( xmlNode * xml ) //<S2SV> { //<S2SV> xmlNode * cIter = __xml_first_child ( xml ) ; //<S2SV> xml_private_t * p = xml -> _private ; //<S2SV> if ( is_set ( p -> flags , xpf_created ) ) { //<S2SV> xmlAttr * xIter = NULL ; //<S2SV> char * path = xml_get_path ( xml ) ; //<S2SV> for ( xIter = crm_first_attr ( xml ) ; xIter != NULL ; xIter = xIter -> next ) { //<S2SV> const char * prop_name = ( const char * ) xIter -> name ; //<S2SV> if ( strcmp ( prop_name , XML_ATTR_ID ) == 0 && strstr ( path , "/" XML_CIB_TAG_ACLS "/" ) == NULL ) { //<S2SV> continue ; //<S2SV> } else if ( __xml_acl_check ( xml , NULL , xpf_acl_write ) ) { //<S2SV> crm_trace ( "Creation<S2SV_blank>of<S2SV_blank>%s=%s<S2SV_blank>is<S2SV_blank>allowed" , crm_element_name ( xml ) , ID ( xml ) ) ; //<S2SV> break ; //<S2SV> } else { //<S2SV> crm_trace ( "Cannot<S2SV_blank>add<S2SV_blank>new<S2SV_blank>node<S2SV_blank>%s<S2SV_blank>at<S2SV_blank>%s" , crm_element_name ( xml ) , path ) ; //<S2SV> if ( xml != xmlDocGetRootElement ( xml -> doc ) ) { //<S2SV> xmlUnlinkNode ( xml ) ; //<S2SV> xmlFreeNode ( xml ) ; //<S2SV> } //<S2SV> free ( path ) ; //<S2SV> return ; //<S2SV> } //<S2SV> } //<S2SV> free ( path ) ; //<S2SV> } //<S2SV> while ( cIter != NULL ) { //<S2SV> xmlNode * child = cIter ; //<S2SV> cIter = __xml_next ( cIter ) ; //<S2SV> __xml_acl_post_process ( child ) ; //<S2SV> } //<S2SV> } //<S2SV> 