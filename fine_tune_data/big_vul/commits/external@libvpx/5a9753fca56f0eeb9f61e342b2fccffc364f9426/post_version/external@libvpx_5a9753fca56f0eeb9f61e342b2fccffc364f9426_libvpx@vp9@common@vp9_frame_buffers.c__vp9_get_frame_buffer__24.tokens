int vp9_get_frame_buffer ( void * cb_priv , size_t min_size , //<S2SV> vpx_codec_frame_buffer_t * fb ) { //<S2SV> int i ; //<S2SV> InternalFrameBufferList * const int_fb_list = //<S2SV> ( InternalFrameBufferList * ) cb_priv ; //<S2SV> if ( int_fb_list == NULL ) //<S2SV> return - 1 ; //<S2SV> for ( i = 0 ; i < int_fb_list -> num_internal_frame_buffers ; ++ i ) { //<S2SV> if ( ! int_fb_list -> int_fb [ i ] . in_use ) //<S2SV> break ; //<S2SV> } //<S2SV> if ( i == int_fb_list -> num_internal_frame_buffers ) //<S2SV> return - 1 ; //<S2SV> if ( int_fb_list -> int_fb [ i ] . size < min_size ) { //<S2SV> int_fb_list -> int_fb [ i ] . data = //<S2SV> ( uint8_t * ) vpx_realloc ( int_fb_list -> int_fb [ i ] . data , min_size ) ; //<S2SV> if ( ! int_fb_list -> int_fb [ i ] . data ) //<S2SV> return - 1 ; //<S2SV> memset ( int_fb_list -> int_fb [ i ] . data , 0 , min_size ) ; //<S2SV> int_fb_list -> int_fb [ i ] . size = min_size ; //<S2SV> } //<S2SV> fb -> data = int_fb_list -> int_fb [ i ] . data ; //<S2SV> fb -> size = int_fb_list -> int_fb [ i ] . size ; //<S2SV> int_fb_list -> int_fb [ i ] . in_use = 1 ; //<S2SV> fb -> priv = & int_fb_list -> int_fb [ i ] ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 