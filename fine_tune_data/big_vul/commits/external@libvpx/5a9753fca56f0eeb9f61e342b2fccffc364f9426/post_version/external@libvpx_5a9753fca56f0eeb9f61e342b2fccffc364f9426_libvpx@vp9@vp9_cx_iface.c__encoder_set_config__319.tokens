static vpx_codec_err_t encoder_set_config ( vpx_codec_alg_priv_t * ctx , //<S2SV> const vpx_codec_enc_cfg_t * cfg ) { //<S2SV> vpx_codec_err_t res ; //<S2SV> int force_key = 0 ; //<S2SV> if ( cfg -> g_w != ctx -> cfg . g_w || cfg -> g_h != ctx -> cfg . g_h ) { //<S2SV> if ( cfg -> g_lag_in_frames > 1 || cfg -> g_pass != VPX_RC_ONE_PASS ) //<S2SV> ERROR ( "Cannot<S2SV_blank>change<S2SV_blank>width<S2SV_blank>or<S2SV_blank>height<S2SV_blank>after<S2SV_blank>initialization" ) ; //<S2SV> if ( ! valid_ref_frame_size ( ctx -> cfg . g_w , ctx -> cfg . g_h , cfg -> g_w , cfg -> g_h ) || //<S2SV> ( ctx -> cpi -> initial_width && ( int ) cfg -> g_w > ctx -> cpi -> initial_width ) || //<S2SV> ( ctx -> cpi -> initial_height && ( int ) cfg -> g_h > ctx -> cpi -> initial_height ) ) //<S2SV> force_key = 1 ; //<S2SV> } //<S2SV> if ( cfg -> g_lag_in_frames > ctx -> cfg . g_lag_in_frames ) //<S2SV> ERROR ( "Cannot<S2SV_blank>increase<S2SV_blank>lag_in_frames" ) ; //<S2SV> res = validate_config ( ctx , cfg , & ctx -> extra_cfg ) ; //<S2SV> if ( res == VPX_CODEC_OK ) { //<S2SV> ctx -> cfg = * cfg ; //<S2SV> set_encoder_config ( & ctx -> oxcf , & ctx -> cfg , & ctx -> extra_cfg ) ; //<S2SV> force_key |= ctx -> cpi -> common . profile != ctx -> oxcf . profile ; //<S2SV> vp9_change_config ( ctx -> cpi , & ctx -> oxcf ) ; //<S2SV> } //<S2SV> if ( force_key ) //<S2SV> ctx -> next_frame_flags |= VPX_EFLAG_FORCE_KF ; //<S2SV> return res ; //<S2SV> } //<S2SV> 