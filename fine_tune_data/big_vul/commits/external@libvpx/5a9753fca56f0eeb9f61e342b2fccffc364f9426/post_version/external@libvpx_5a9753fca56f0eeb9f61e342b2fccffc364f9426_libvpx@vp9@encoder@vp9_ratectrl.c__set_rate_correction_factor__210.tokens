static void set_rate_correction_factor ( VP9_COMP * cpi , double factor ) { //<S2SV> RATE_CONTROL * const rc = & cpi -> rc ; //<S2SV> factor /= rcf_mult [ cpi -> rc . frame_size_selector ] ; //<S2SV> factor = fclamp ( factor , MIN_BPB_FACTOR , MAX_BPB_FACTOR ) ; //<S2SV> if ( cpi -> common . frame_type == KEY_FRAME ) { //<S2SV> rc -> rate_correction_factors [ KF_STD ] = factor ; //<S2SV> } else if ( cpi -> oxcf . pass == 2 ) { //<S2SV> RATE_FACTOR_LEVEL rf_lvl = //<S2SV> cpi -> twopass . gf_group . rf_level [ cpi -> twopass . gf_group . index ] ; //<S2SV> rc -> rate_correction_factors [ rf_lvl ] = factor ; //<S2SV> } else { //<S2SV> if ( ( cpi -> refresh_alt_ref_frame || cpi -> refresh_golden_frame ) && //<S2SV> ! rc -> is_src_frame_alt_ref && ! cpi -> use_svc && //<S2SV> ( cpi -> oxcf . rc_mode != VPX_CBR || cpi -> oxcf . gf_cbr_boost_pct > 20 ) ) //<S2SV> rc -> rate_correction_factors [ GF_ARF_STD ] = factor ; //<S2SV> else //<S2SV> rc -> rate_correction_factors [ INTER_NORMAL ] = factor ; //<S2SV> } //<S2SV> } //<S2SV> 