static void update_buffer_level ( VP9_COMP * cpi , int encoded_frame_size ) { //<S2SV> const VP9_COMMON * const cm = & cpi -> common ; //<S2SV> RATE_CONTROL * const rc = & cpi -> rc ; //<S2SV> if ( ! cm -> show_frame ) { //<S2SV> rc -> bits_off_target -= encoded_frame_size ; //<S2SV> } else { //<S2SV> rc -> bits_off_target += rc -> avg_frame_bandwidth - encoded_frame_size ; //<S2SV> } //<S2SV> rc -> bits_off_target = MIN ( rc -> bits_off_target , rc -> maximum_buffer_size ) ; //<S2SV> rc -> buffer_level = rc -> bits_off_target ; //<S2SV> if ( is_one_pass_cbr_svc ( cpi ) ) { //<S2SV> update_layer_buffer_level ( & cpi -> svc , encoded_frame_size ) ; //<S2SV> } //<S2SV> } //<S2SV> 