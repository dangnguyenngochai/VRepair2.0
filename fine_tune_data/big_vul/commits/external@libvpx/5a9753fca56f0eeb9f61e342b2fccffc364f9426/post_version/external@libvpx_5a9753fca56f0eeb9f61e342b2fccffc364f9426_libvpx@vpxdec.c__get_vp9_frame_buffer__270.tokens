static int get_vp9_frame_buffer ( void * cb_priv , size_t min_size , //<S2SV> vpx_codec_frame_buffer_t * fb ) { //<S2SV> int i ; //<S2SV> struct ExternalFrameBufferList * const ext_fb_list = //<S2SV> ( struct ExternalFrameBufferList * ) cb_priv ; //<S2SV> if ( ext_fb_list == NULL ) //<S2SV> return - 1 ; //<S2SV> for ( i = 0 ; i < ext_fb_list -> num_external_frame_buffers ; ++ i ) { //<S2SV> if ( ! ext_fb_list -> ext_fb [ i ] . in_use ) //<S2SV> break ; //<S2SV> } //<S2SV> if ( i == ext_fb_list -> num_external_frame_buffers ) //<S2SV> return - 1 ; //<S2SV> if ( ext_fb_list -> ext_fb [ i ] . size < min_size ) { //<S2SV> free ( ext_fb_list -> ext_fb [ i ] . data ) ; //<S2SV> ext_fb_list -> ext_fb [ i ] . data = ( uint8_t * ) calloc ( min_size , sizeof ( uint8_t ) ) ; //<S2SV> if ( ! ext_fb_list -> ext_fb [ i ] . data ) //<S2SV> return - 1 ; //<S2SV> ext_fb_list -> ext_fb [ i ] . size = min_size ; //<S2SV> } //<S2SV> fb -> data = ext_fb_list -> ext_fb [ i ] . data ; //<S2SV> fb -> size = ext_fb_list -> ext_fb [ i ] . size ; //<S2SV> ext_fb_list -> ext_fb [ i ] . in_use = 1 ; //<S2SV> fb -> priv = & ext_fb_list -> ext_fb [ i ] ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 