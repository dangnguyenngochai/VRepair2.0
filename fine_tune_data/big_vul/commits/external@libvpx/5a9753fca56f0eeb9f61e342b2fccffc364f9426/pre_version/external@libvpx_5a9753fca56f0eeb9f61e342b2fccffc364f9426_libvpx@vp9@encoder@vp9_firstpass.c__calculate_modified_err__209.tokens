static double calculate_modified_err ( const VP9_COMP * cpi , //<S2SV> const FIRSTPASS_STATS * this_frame ) { //<S2SV> const struct twopass_rc * twopass = & cpi -> twopass ; //<S2SV> const SVC * const svc = & cpi -> svc ; //<S2SV> const FIRSTPASS_STATS * stats ; //<S2SV> double av_err ; //<S2SV> double modified_error ; //<S2SV> if ( svc -> number_spatial_layers > 1 && //<S2SV> svc -> number_temporal_layers == 1 ) { //<S2SV> twopass = & svc -> layer_context [ svc -> spatial_layer_id ] . twopass ; //<S2SV> } //<S2SV> stats = & twopass -> total_stats ; //<S2SV> av_err = stats -> ssim_weighted_pred_err / stats -> count ; //<S2SV> modified_error = av_err * pow ( this_frame -> ssim_weighted_pred_err / //<S2SV> DOUBLE_DIVIDE_CHECK ( av_err ) , //<S2SV> cpi -> oxcf . two_pass_vbrbias / 100.0 ) ; //<S2SV> return fclamp ( modified_error , //<S2SV> twopass -> modified_error_min , twopass -> modified_error_max ) ; //<S2SV> } //<S2SV> 