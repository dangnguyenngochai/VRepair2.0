static TX_MODE select_tx_mode ( const VP9_COMP * cpi ) { //<S2SV> if ( cpi -> oxcf . lossless ) { //<S2SV> return ONLY_4X4 ; //<S2SV> } else if ( cpi -> common . current_video_frame == 0 ) { //<S2SV> return TX_MODE_SELECT ; //<S2SV> } else { //<S2SV> if ( cpi -> sf . tx_size_search_method == USE_LARGESTALL ) { //<S2SV> return ALLOW_32X32 ; //<S2SV> } else if ( cpi -> sf . tx_size_search_method == USE_FULL_RD ) { //<S2SV> const MV_REFERENCE_FRAME frame_type = get_frame_type ( cpi ) ; //<S2SV> return cpi -> rd_tx_select_threshes [ frame_type ] [ ALLOW_32X32 ] > //<S2SV> cpi -> rd_tx_select_threshes [ frame_type ] [ TX_MODE_SELECT ] ? //<S2SV> ALLOW_32X32 : TX_MODE_SELECT ; //<S2SV> } else { //<S2SV> unsigned int total = 0 ; //<S2SV> int i ; //<S2SV> for ( i = 0 ; i < TX_SIZES ; ++ i ) //<S2SV> total += cpi -> tx_stepdown_count [ i ] ; //<S2SV> if ( total ) { //<S2SV> const double fraction = ( double ) cpi -> tx_stepdown_count [ 0 ] / total ; //<S2SV> return fraction > 0.90 ? ALLOW_32X32 : TX_MODE_SELECT ; //<S2SV> } else { //<S2SV> return cpi -> common . tx_mode ; //<S2SV> } //<S2SV> } //<S2SV> } //<S2SV> } //<S2SV> 