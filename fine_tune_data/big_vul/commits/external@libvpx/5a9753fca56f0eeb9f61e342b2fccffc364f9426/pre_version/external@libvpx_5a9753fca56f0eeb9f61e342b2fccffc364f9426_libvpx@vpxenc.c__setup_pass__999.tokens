static void setup_pass ( struct stream_state * stream , //<S2SV> struct VpxEncoderConfig * global , //<S2SV> int pass ) { //<S2SV> if ( stream -> config . stats_fn ) { //<S2SV> if ( ! stats_open_file ( & stream -> stats , stream -> config . stats_fn , //<S2SV> pass ) ) //<S2SV> fatal ( "Failed<S2SV_blank>to<S2SV_blank>open<S2SV_blank>statistics<S2SV_blank>store" ) ; //<S2SV> } else { //<S2SV> if ( ! stats_open_mem ( & stream -> stats , pass ) ) //<S2SV> fatal ( "Failed<S2SV_blank>to<S2SV_blank>open<S2SV_blank>statistics<S2SV_blank>store" ) ; //<S2SV> } //<S2SV> stream -> config . cfg . g_pass = global -> passes == 2 //<S2SV> ? pass ? VPX_RC_LAST_PASS : VPX_RC_FIRST_PASS //<S2SV> : VPX_RC_ONE_PASS ; //<S2SV> if ( pass ) //<S2SV> stream -> config . cfg . rc_twopass_stats_in = stats_get ( & stream -> stats ) ; //<S2SV> stream -> cx_time = 0 ; //<S2SV> stream -> nbytes = 0 ; //<S2SV> stream -> frames_out = 0 ; //<S2SV> } //<S2SV> 