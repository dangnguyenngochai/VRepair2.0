void open_input_file ( struct VpxInputContext * input ) { //<S2SV> input -> file = strcmp ( input -> filename , "-" ) //<S2SV> ? fopen ( input -> filename , "rb" ) : set_binary_mode ( stdin ) ; //<S2SV> if ( ! input -> file ) //<S2SV> fatal ( "Failed<S2SV_blank>to<S2SV_blank>open<S2SV_blank>input<S2SV_blank>file" ) ; //<S2SV> if ( ! fseeko ( input -> file , 0 , SEEK_END ) ) { //<S2SV> input -> length = ftello ( input -> file ) ; //<S2SV> rewind ( input -> file ) ; //<S2SV> } //<S2SV> input -> detect . buf_read = fread ( input -> detect . buf , 1 , 4 , input -> file ) ; //<S2SV> input -> detect . position = 0 ; //<S2SV> if ( input -> detect . buf_read == 4 //<S2SV> && file_is_y4m ( input -> detect . buf ) ) { //<S2SV> if ( y4m_input_open ( & input -> y4m , input -> file , input -> detect . buf , 4 , //<S2SV> input -> only_i420 ) >= 0 ) { //<S2SV> input -> file_type = FILE_TYPE_Y4M ; //<S2SV> input -> width = input -> y4m . pic_w ; //<S2SV> input -> height = input -> y4m . pic_h ; //<S2SV> input -> framerate . numerator = input -> y4m . fps_n ; //<S2SV> input -> framerate . denominator = input -> y4m . fps_d ; //<S2SV> input -> use_i420 = 0 ; //<S2SV> } else //<S2SV> fatal ( "Unsupported<S2SV_blank>Y4M<S2SV_blank>stream." ) ; //<S2SV> } else if ( input -> detect . buf_read == 4 && fourcc_is_ivf ( input -> detect . buf ) ) { //<S2SV> fatal ( "IVF<S2SV_blank>is<S2SV_blank>not<S2SV_blank>supported<S2SV_blank>as<S2SV_blank>input." ) ; //<S2SV> } else { //<S2SV> input -> file_type = FILE_TYPE_RAW ; //<S2SV> } //<S2SV> } //<S2SV> 