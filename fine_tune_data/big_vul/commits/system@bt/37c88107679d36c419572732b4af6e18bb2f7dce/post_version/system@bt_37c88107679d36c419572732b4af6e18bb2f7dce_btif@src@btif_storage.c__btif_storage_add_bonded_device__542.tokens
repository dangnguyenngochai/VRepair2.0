bt_status_t btif_storage_add_bonded_device ( bt_bdaddr_t * remote_bd_addr , //<S2SV> LINK_KEY link_key , //<S2SV> uint8_t key_type , //<S2SV> uint8_t pin_length ) //<S2SV> { //<S2SV> bdstr_t bdstr ; //<S2SV> bdaddr_to_string ( remote_bd_addr , bdstr , sizeof ( bdstr ) ) ; //<S2SV> int ret = btif_config_set_int ( bdstr , "LinkKeyType" , ( int ) key_type ) ; //<S2SV> ret &= btif_config_set_int ( bdstr , "PinLength" , ( int ) pin_length ) ; //<S2SV> ret &= btif_config_set_bin ( bdstr , "LinkKey" , link_key , sizeof ( LINK_KEY ) ) ; //<S2SV> if ( is_restricted_mode ( ) ) { //<S2SV> BTIF_TRACE_WARNING ( "%s:<S2SV_blank>\'%s\'<S2SV_blank>pairing<S2SV_blank>will<S2SV_blank>be<S2SV_blank>removed<S2SV_blank>if<S2SV_blank>unrestricted" , //<S2SV> __func__ , bdstr ) ; //<S2SV> btif_config_set_int ( bdstr , "Restricted" , 1 ) ; //<S2SV> } //<S2SV> btif_config_flush ( ) ; //<S2SV> return ret ? BT_STATUS_SUCCESS : BT_STATUS_FAIL ; //<S2SV> } //<S2SV> 