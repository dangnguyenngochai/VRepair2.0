int sock_recv_all ( int sock_fd , uint8_t * buf , int len ) //<S2SV> { //<S2SV> int r = len ; //<S2SV> int ret = - 1 ; //<S2SV> while ( r ) //<S2SV> { //<S2SV> do ret = recv ( sock_fd , buf , r , MSG_WAITALL ) ; //<S2SV> while ( ret < 0 && errno == EINTR ) ; //<S2SV> if ( ret <= 0 ) //<S2SV> { //<S2SV> BTIF_TRACE_ERROR ( "sock<S2SV_blank>fd:%d<S2SV_blank>recv<S2SV_blank>errno:%d,<S2SV_blank>ret:%d" , sock_fd , errno , ret ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> buf += ret ; //<S2SV> r -= ret ; //<S2SV> } //<S2SV> return len ; //<S2SV> } //<S2SV> 