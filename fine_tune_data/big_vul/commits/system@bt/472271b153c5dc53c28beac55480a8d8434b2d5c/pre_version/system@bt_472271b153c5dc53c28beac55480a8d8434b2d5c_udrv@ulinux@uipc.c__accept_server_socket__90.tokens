static int accept_server_socket ( int sfd ) //<S2SV> { //<S2SV> struct sockaddr_un remote ; //<S2SV> struct pollfd pfd ; //<S2SV> int fd ; //<S2SV> socklen_t len = sizeof ( struct sockaddr_un ) ; //<S2SV> BTIF_TRACE_EVENT ( "accept<S2SV_blank>fd<S2SV_blank>%d" , sfd ) ; //<S2SV> pfd . fd = sfd ; //<S2SV> pfd . events = POLLIN ; //<S2SV> if ( poll ( & pfd , 1 , 0 ) == 0 ) //<S2SV> { //<S2SV> BTIF_TRACE_EVENT ( "accept<S2SV_blank>poll<S2SV_blank>timeout" ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> if ( ( fd = accept ( sfd , ( struct sockaddr * ) & remote , & len ) ) == - 1 ) //<S2SV> { //<S2SV> BTIF_TRACE_ERROR ( "sock<S2SV_blank>accept<S2SV_blank>failed<S2SV_blank>(%s)" , strerror ( errno ) ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> return fd ; //<S2SV> } //<S2SV> 