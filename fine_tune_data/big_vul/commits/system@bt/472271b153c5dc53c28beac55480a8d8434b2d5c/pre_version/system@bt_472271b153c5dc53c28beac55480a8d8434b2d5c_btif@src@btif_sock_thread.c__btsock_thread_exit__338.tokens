int btsock_thread_exit ( int h ) //<S2SV> { //<S2SV> if ( h < 0 || h >= MAX_THREAD ) //<S2SV> { //<S2SV> APPL_TRACE_ERROR ( "invalid<S2SV_blank>bt<S2SV_blank>thread<S2SV_blank>handle:%d" , h ) ; //<S2SV> return FALSE ; //<S2SV> } //<S2SV> if ( ts [ h ] . cmd_fdw == - 1 ) //<S2SV> { //<S2SV> APPL_TRACE_ERROR ( "cmd<S2SV_blank>socket<S2SV_blank>is<S2SV_blank>not<S2SV_blank>created" ) ; //<S2SV> return FALSE ; //<S2SV> } //<S2SV> sock_cmd_t cmd = { CMD_EXIT , 0 , 0 , 0 , 0 } ; //<S2SV> if ( send ( ts [ h ] . cmd_fdw , & cmd , sizeof ( cmd ) , 0 ) == sizeof ( cmd ) ) //<S2SV> { //<S2SV> pthread_join ( ts [ h ] . thread_id , 0 ) ; //<S2SV> pthread_mutex_lock ( & thread_slot_lock ) ; //<S2SV> free_thread_slot ( h ) ; //<S2SV> pthread_mutex_unlock ( & thread_slot_lock ) ; //<S2SV> return TRUE ; //<S2SV> } //<S2SV> return FALSE ; //<S2SV> } //<S2SV> 