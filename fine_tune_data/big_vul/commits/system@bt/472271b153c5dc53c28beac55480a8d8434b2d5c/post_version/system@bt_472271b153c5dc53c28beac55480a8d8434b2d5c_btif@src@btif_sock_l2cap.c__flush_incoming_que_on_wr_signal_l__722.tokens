static BOOLEAN flush_incoming_que_on_wr_signal_l ( l2cap_socket * sock ) //<S2SV> { //<S2SV> uint8_t * buf ; //<S2SV> uint32_t len ; //<S2SV> while ( packet_get_head_l ( sock , & buf , & len ) ) { //<S2SV> int sent = TEMP_FAILURE_RETRY ( send ( sock -> our_fd , buf , len , MSG_DONTWAIT ) ) ; //<S2SV> if ( sent == ( signed ) len ) //<S2SV> osi_free ( buf ) ; //<S2SV> else if ( sent >= 0 ) { //<S2SV> packet_put_head_l ( sock , buf + sent , len - sent ) ; //<S2SV> osi_free ( buf ) ; //<S2SV> if ( ! sent ) //<S2SV> return TRUE ; //<S2SV> } //<S2SV> else { //<S2SV> packet_put_head_l ( sock , buf , len ) ; //<S2SV> osi_free ( buf ) ; //<S2SV> return errno == EINTR || errno == EWOULDBLOCK || errno == EAGAIN ; //<S2SV> } //<S2SV> } //<S2SV> return FALSE ; //<S2SV> } //<S2SV> 