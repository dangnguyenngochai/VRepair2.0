static void ikev2_parent_outI1_continue ( struct pluto_crypto_req_cont * pcrc , //<S2SV> struct pluto_crypto_req * r , //<S2SV> err_t ugh ) //<S2SV> { //<S2SV> struct ke_continuation * ke = ( struct ke_continuation * ) pcrc ; //<S2SV> struct msg_digest * md = ke -> md ; //<S2SV> struct state * const st = md -> st ; //<S2SV> stf_status e ; //<S2SV> DBG ( DBG_CONTROLMORE , //<S2SV> DBG_log ( "ikev2<S2SV_blank>parent<S2SV_blank>outI1:<S2SV_blank>calculated<S2SV_blank>ke+nonce,<S2SV_blank>sending<S2SV_blank>I1" ) ) ; //<S2SV> if ( st == NULL ) { //<S2SV> loglog ( RC_LOG_SERIOUS , //<S2SV> "%s:<S2SV_blank>Request<S2SV_blank>was<S2SV_blank>disconnected<S2SV_blank>from<S2SV_blank>state" , //<S2SV> __FUNCTION__ ) ; //<S2SV> if ( ke -> md ) //<S2SV> release_md ( ke -> md ) ; //<S2SV> return ; //<S2SV> } //<S2SV> passert ( ugh == NULL ) ; //<S2SV> passert ( cur_state == NULL ) ; //<S2SV> passert ( st != NULL ) ; //<S2SV> passert ( st -> st_suspended_md == ke -> md ) ; //<S2SV> set_suspended ( st , NULL ) ; //<S2SV> set_cur_state ( st ) ; //<S2SV> st -> st_calculating = FALSE ; //<S2SV> e = ikev2_parent_outI1_tail ( pcrc , r ) ; //<S2SV> if ( ke -> md != NULL ) { //<S2SV> complete_v2_state_transition ( & ke -> md , e ) ; //<S2SV> if ( ke -> md ) //<S2SV> release_md ( ke -> md ) ; //<S2SV> } //<S2SV> reset_cur_state ( ) ; //<S2SV> reset_globals ( ) ; //<S2SV> } //<S2SV> 