static Channel * //<S2SV> server_request_direct_streamlocal ( void ) //<S2SV> { //<S2SV> Channel * c = NULL ; //<S2SV> char * target , * originator ; //<S2SV> u_short originator_port ; //<S2SV> target = packet_get_string ( NULL ) ; //<S2SV> originator = packet_get_string ( NULL ) ; //<S2SV> originator_port = packet_get_int ( ) ; //<S2SV> packet_check_eom ( ) ; //<S2SV> debug ( "server_request_direct_streamlocal:<S2SV_blank>originator<S2SV_blank>%s<S2SV_blank>port<S2SV_blank>%d,<S2SV_blank>target<S2SV_blank>%s" , //<S2SV> originator , originator_port , target ) ; //<S2SV> if ( ( options . allow_streamlocal_forwarding & FORWARD_LOCAL ) != 0 && //<S2SV> ! no_port_forwarding_flag && ! options . disable_forwarding && //<S2SV> use_privsep ) { //<S2SV> c = channel_connect_to_path ( target , //<S2SV> "direct-streamlocal@openssh.com" , "direct-streamlocal" ) ; //<S2SV> } else { //<S2SV> logit ( "refused<S2SV_blank>streamlocal<S2SV_blank>port<S2SV_blank>forward:<S2SV_blank>" //<S2SV> "originator<S2SV_blank>%s<S2SV_blank>port<S2SV_blank>%d,<S2SV_blank>target<S2SV_blank>%s" , //<S2SV> originator , originator_port , target ) ; //<S2SV> } //<S2SV> free ( originator ) ; //<S2SV> free ( target ) ; //<S2SV> return c ; //<S2SV> } //<S2SV> 