struct monitor * //<S2SV> monitor_init ( void ) //<S2SV> { //<S2SV> struct ssh * ssh = active_state ; //<S2SV> struct monitor * mon ; //<S2SV> mon = xcalloc ( 1 , sizeof ( * mon ) ) ; //<S2SV> monitor_openfds ( mon , 1 ) ; //<S2SV> if ( options . compression ) { //<S2SV> mon -> m_zback = mm_create ( NULL , MM_MEMSIZE ) ; //<S2SV> mon -> m_zlib = mm_create ( mon -> m_zback , 20 * MM_MEMSIZE ) ; //<S2SV> ssh_packet_set_compress_hooks ( ssh , mon -> m_zlib , //<S2SV> ( ssh_packet_comp_alloc_func * ) mm_zalloc , //<S2SV> ( ssh_packet_comp_free_func * ) mm_zfree ) ; //<S2SV> } //<S2SV> return mon ; //<S2SV> } //<S2SV> 