int oidc_handle_redirect_uri_request ( request_rec * r , oidc_cfg * c , //<S2SV> oidc_session_t * session ) { //<S2SV> if ( oidc_proto_is_redirect_authorization_response ( r , c ) ) { //<S2SV> return oidc_handle_redirect_authorization_response ( r , c , session ) ; //<S2SV> } else if ( oidc_proto_is_post_authorization_response ( r , c ) ) { //<S2SV> return oidc_handle_post_authorization_response ( r , c , session ) ; //<S2SV> } else if ( oidc_is_discovery_response ( r , c ) ) { //<S2SV> return oidc_handle_discovery_response ( r , c ) ; //<S2SV> } else if ( oidc_util_request_has_parameter ( r , "logout" ) ) { //<S2SV> return oidc_handle_logout ( r , c , session ) ; //<S2SV> } else if ( oidc_util_request_has_parameter ( r , "jwks" ) ) { //<S2SV> return oidc_handle_jwks ( r , c ) ; //<S2SV> } else if ( oidc_util_request_has_parameter ( r , "session" ) ) { //<S2SV> return oidc_handle_session_management ( r , c , session ) ; //<S2SV> } else if ( oidc_util_request_has_parameter ( r , "refresh" ) ) { //<S2SV> return oidc_handle_refresh_token_request ( r , c , session ) ; //<S2SV> } else if ( oidc_util_request_has_parameter ( r , "request_uri" ) ) { //<S2SV> return oidc_handle_request_uri ( r , c ) ; //<S2SV> } else if ( oidc_util_request_has_parameter ( r , "remove_at_cache" ) ) { //<S2SV> return oidc_handle_remove_at_cache ( r , c ) ; //<S2SV> } else if ( ( r -> args == NULL ) || ( apr_strnatcmp ( r -> args , "" ) == 0 ) ) { //<S2SV> return oidc_proto_javascript_implicit ( r , c ) ; //<S2SV> } //<S2SV> if ( oidc_util_request_has_parameter ( r , "error" ) ) { //<S2SV> oidc_handle_redirect_authorization_response ( r , c , session ) ; //<S2SV> } //<S2SV> return oidc_util_html_send_error ( r , c -> error_template , "Invalid<S2SV_blank>Request" , //<S2SV> apr_psprintf ( r -> pool , //<S2SV> "The<S2SV_blank>OpenID<S2SV_blank>Connect<S2SV_blank>callback<S2SV_blank>URL<S2SV_blank>received<S2SV_blank>an<S2SV_blank>invalid<S2SV_blank>request:<S2SV_blank>%s" , //<S2SV> r -> args ) , HTTP_INTERNAL_SERVER_ERROR ) ; //<S2SV> } //<S2SV> 