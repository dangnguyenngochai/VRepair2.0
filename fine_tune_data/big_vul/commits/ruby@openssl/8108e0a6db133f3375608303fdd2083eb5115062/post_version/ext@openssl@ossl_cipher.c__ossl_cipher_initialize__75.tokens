static VALUE //<S2SV> ossl_cipher_initialize ( VALUE self , VALUE str ) //<S2SV> { //<S2SV> EVP_CIPHER_CTX * ctx ; //<S2SV> const EVP_CIPHER * cipher ; //<S2SV> char * name ; //<S2SV> name = StringValueCStr ( str ) ; //<S2SV> GetCipherInit ( self , ctx ) ; //<S2SV> if ( ctx ) { //<S2SV> ossl_raise ( rb_eRuntimeError , "Cipher<S2SV_blank>already<S2SV_blank>inititalized!" ) ; //<S2SV> } //<S2SV> AllocCipher ( self , ctx ) ; //<S2SV> if ( ! ( cipher = EVP_get_cipherbyname ( name ) ) ) { //<S2SV> ossl_raise ( rb_eRuntimeError , "unsupported<S2SV_blank>cipher<S2SV_blank>algorithm<S2SV_blank>(%" PRIsVALUE ")" , str ) ; //<S2SV> } //<S2SV> if ( EVP_CipherInit_ex ( ctx , cipher , NULL , NULL , NULL , - 1 ) != 1 ) //<S2SV> ossl_raise ( eCipherError , NULL ) ; //<S2SV> return self ; //<S2SV> } //<S2SV> 