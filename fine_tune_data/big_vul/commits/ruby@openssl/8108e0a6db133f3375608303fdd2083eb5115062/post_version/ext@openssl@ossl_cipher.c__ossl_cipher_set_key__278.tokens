static VALUE //<S2SV> ossl_cipher_set_key ( VALUE self , VALUE key ) //<S2SV> { //<S2SV> EVP_CIPHER_CTX * ctx ; //<S2SV> int key_len ; //<S2SV> StringValue ( key ) ; //<S2SV> GetCipher ( self , ctx ) ; //<S2SV> key_len = EVP_CIPHER_CTX_key_length ( ctx ) ; //<S2SV> if ( RSTRING_LEN ( key ) != key_len ) //<S2SV> ossl_raise ( rb_eArgError , "key<S2SV_blank>must<S2SV_blank>be<S2SV_blank>%d<S2SV_blank>bytes" , key_len ) ; //<S2SV> if ( EVP_CipherInit_ex ( ctx , NULL , NULL , ( unsigned char * ) RSTRING_PTR ( key ) , NULL , - 1 ) != 1 ) //<S2SV> ossl_raise ( eCipherError , NULL ) ; //<S2SV> rb_ivar_set ( self , id_key_set , Qtrue ) ; //<S2SV> return key ; //<S2SV> } //<S2SV> 