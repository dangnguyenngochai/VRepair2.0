static void DefragTrackerInit ( DefragTracker * dt , Packet * p ) //<S2SV> { //<S2SV> COPY_ADDRESS ( & p -> src , & dt -> src_addr ) ; //<S2SV> COPY_ADDRESS ( & p -> dst , & dt -> dst_addr ) ; //<S2SV> if ( PKT_IS_IPV4 ( p ) ) { //<S2SV> dt -> id = ( int32_t ) IPV4_GET_IPID ( p ) ; //<S2SV> dt -> af = AF_INET ; //<S2SV> } else { //<S2SV> dt -> id = ( int32_t ) IPV6_EXTHDR_GET_FH_ID ( p ) ; //<S2SV> dt -> af = AF_INET6 ; //<S2SV> } //<S2SV> dt -> vlan_id [ 0 ] = p -> vlan_id [ 0 ] ; //<S2SV> dt -> vlan_id [ 1 ] = p -> vlan_id [ 1 ] ; //<S2SV> dt -> policy = DefragGetOsPolicy ( p ) ; //<S2SV> dt -> host_timeout = DefragPolicyGetHostTimeout ( p ) ; //<S2SV> dt -> remove = 0 ; //<S2SV> dt -> seen_last = 0 ; //<S2SV> TAILQ_INIT ( & dt -> frags ) ; //<S2SV> ( void ) DefragTrackerIncrUsecnt ( dt ) ; //<S2SV> } //<S2SV> 