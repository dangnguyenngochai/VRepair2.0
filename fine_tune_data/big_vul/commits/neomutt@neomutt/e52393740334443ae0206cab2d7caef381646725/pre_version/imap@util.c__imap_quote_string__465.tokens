void imap_quote_string ( char * dest , size_t dlen , const char * src ) //<S2SV> { //<S2SV> static const char quote [ ] = "\\"\\\\" ; //<S2SV> char * pt = dest ; //<S2SV> const char * s = src ; //<S2SV> * pt ++ = \'"\' ; //<S2SV> dlen -= 2 ; //<S2SV> for ( ; * s && dlen ; s ++ ) //<S2SV> { //<S2SV> if ( strchr ( quote , * s ) ) //<S2SV> { //<S2SV> dlen -= 2 ; //<S2SV> if ( dlen == 0 ) //<S2SV> break ; //<S2SV> * pt ++ = '\\\\' ; //<S2SV> * pt ++ = * s ; //<S2SV> } //<S2SV> else //<S2SV> { //<S2SV> * pt ++ = * s ; //<S2SV> dlen -- ; //<S2SV> } //<S2SV> } //<S2SV> * pt ++ = \'"\' ; //<S2SV> * pt = '\\0' ; //<S2SV> } //<S2SV> 