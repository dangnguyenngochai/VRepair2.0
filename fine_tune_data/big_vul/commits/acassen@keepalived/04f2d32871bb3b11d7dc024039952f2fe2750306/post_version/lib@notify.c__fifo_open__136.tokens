static void //<S2SV> fifo_open ( notify_fifo_t * fifo , int ( * script_exit ) ( thread_t * ) , const char * type ) //<S2SV> { //<S2SV> int ret ; //<S2SV> int sav_errno ; //<S2SV> if ( fifo -> name ) { //<S2SV> sav_errno = 0 ; //<S2SV> if ( ! ( ret = mkfifo ( fifo -> name , S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH ) ) ) //<S2SV> fifo -> created_fifo = true ; //<S2SV> else { //<S2SV> sav_errno = errno ; //<S2SV> if ( sav_errno != EEXIST ) //<S2SV> log_message ( LOG_INFO , "Unable<S2SV_blank>to<S2SV_blank>create<S2SV_blank>%snotify<S2SV_blank>fifo<S2SV_blank>%s" , type , fifo -> name ) ; //<S2SV> } //<S2SV> if ( ! sav_errno || sav_errno == EEXIST ) { //<S2SV> if ( fifo -> script ) //<S2SV> notify_fifo_exec ( master , script_exit , fifo , fifo -> script ) ; //<S2SV> if ( ( fifo -> fd = open ( fifo -> name , O_RDWR | O_CLOEXEC | O_NONBLOCK | O_NOFOLLOW ) ) == - 1 ) { //<S2SV> log_message ( LOG_INFO , "Unable<S2SV_blank>to<S2SV_blank>open<S2SV_blank>%snotify<S2SV_blank>fifo<S2SV_blank>%s<S2SV_blank>-<S2SV_blank>errno<S2SV_blank>%d" , type , fifo -> name , errno ) ; //<S2SV> if ( fifo -> created_fifo ) { //<S2SV> unlink ( fifo -> name ) ; //<S2SV> fifo -> created_fifo = false ; //<S2SV> } //<S2SV> } //<S2SV> } //<S2SV> if ( fifo -> fd == - 1 ) { //<S2SV> FREE ( fifo -> name ) ; //<S2SV> fifo -> name = NULL ; //<S2SV> } //<S2SV> } //<S2SV> } //<S2SV> 