char * path_name ( const struct name_path * path , const char * name ) //<S2SV> { //<S2SV> const struct name_path * p ; //<S2SV> char * n , * m ; //<S2SV> int nlen = strlen ( name ) ; //<S2SV> int len = nlen + 1 ; //<S2SV> for ( p = path ; p ; p = p -> up ) { //<S2SV> if ( p -> elem_len ) //<S2SV> len += p -> elem_len + 1 ; //<S2SV> } //<S2SV> n = xmalloc ( len ) ; //<S2SV> m = n + len - ( nlen + 1 ) ; //<S2SV> memcpy ( m , name , nlen + 1 ) ; //<S2SV> for ( p = path ; p ; p = p -> up ) { //<S2SV> if ( p -> elem_len ) { //<S2SV> m -= p -> elem_len + 1 ; //<S2SV> memcpy ( m , p -> elem , p -> elem_len ) ; //<S2SV> m [ p -> elem_len ] = '/' ; //<S2SV> } //<S2SV> } //<S2SV> return n ; //<S2SV> } //<S2SV> 