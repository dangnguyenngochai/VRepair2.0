GPMF_ERR IsValidSize ( GPMF_stream * ms , uint32_t size ) //<S2SV> { //<S2SV> if ( ms ) //<S2SV> { //<S2SV> int32_t nestsize = ( int32_t ) ms -> nest_size [ ms -> nest_level ] ; //<S2SV> if ( nestsize == 0 && ms -> nest_level == 0 ) //<S2SV> nestsize = ms -> buffer_size_longs ; //<S2SV> if ( size + 2 <= nestsize ) return GPMF_OK ; //<S2SV> } //<S2SV> return GPMF_ERROR_BAD_STRUCTURE ; //<S2SV> } //<S2SV> 