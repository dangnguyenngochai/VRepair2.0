static RList * r_bin_wasm_get_data_entries ( RBinWasmObj * bin , RBinWasmSection * sec ) { //<S2SV> RList * ret = NULL ; //<S2SV> RBinWasmDataEntry * ptr = NULL ; //<S2SV> ut32 len = sec -> payload_len ; //<S2SV> if ( ! ( ret = r_list_newf ( ( RListFree ) free ) ) ) { //<S2SV> return NULL ; //<S2SV> } //<S2SV> ut8 * buf = bin -> buf -> buf + ( ut32 ) sec -> payload_data ; //<S2SV> int buflen = bin -> buf -> length - ( ut32 ) sec -> payload_data ; //<S2SV> ut32 count = sec -> count ; //<S2SV> ut32 i = 0 , r = 0 ; //<S2SV> size_t n = 0 ; //<S2SV> while ( i < len && len < buflen && r < count ) { //<S2SV> if ( ! ( ptr = R_NEW0 ( RBinWasmDataEntry ) ) ) { //<S2SV> return ret ; //<S2SV> } //<S2SV> if ( ! ( consume_u32 ( buf + i , buf + len , & ptr -> index , & i ) ) ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> if ( i + 4 >= buflen ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> if ( ! ( n = consume_init_expr ( buf + i , buf + len , R_BIN_WASM_END_OF_CODE , NULL , & i ) ) ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> ptr -> offset . len = n ; //<S2SV> if ( ! ( consume_u32 ( buf + i , buf + len , & ptr -> size , & i ) ) ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> if ( i + 4 >= buflen ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> ptr -> data = sec -> payload_data + i ; //<S2SV> r_list_append ( ret , ptr ) ; //<S2SV> r += 1 ; //<S2SV> } //<S2SV> return ret ; //<S2SV> beach : //<S2SV> free ( ptr ) ; //<S2SV> return ret ; //<S2SV> } //<S2SV> 