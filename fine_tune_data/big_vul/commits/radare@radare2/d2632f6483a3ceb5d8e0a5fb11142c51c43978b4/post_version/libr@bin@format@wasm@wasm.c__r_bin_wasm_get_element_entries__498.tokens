static RList * r_bin_wasm_get_element_entries ( RBinWasmObj * bin , RBinWasmSection * sec ) { //<S2SV> RList * ret = NULL ; //<S2SV> RBinWasmElementEntry * ptr = NULL ; //<S2SV> if ( ! ( ret = r_list_newf ( ( RListFree ) free ) ) ) { //<S2SV> return NULL ; //<S2SV> } //<S2SV> ut8 * buf = bin -> buf -> buf + ( ut32 ) sec -> payload_data ; //<S2SV> int buflen = bin -> buf -> length - ( ut32 ) sec -> payload_data ; //<S2SV> ut32 len = sec -> payload_len ; //<S2SV> ut32 count = sec -> count ; //<S2SV> ut32 i = 0 , r = 0 ; //<S2SV> while ( i < len && len < buflen && r < count ) { //<S2SV> if ( ! ( ptr = R_NEW0 ( RBinWasmElementEntry ) ) ) { //<S2SV> return ret ; //<S2SV> } //<S2SV> if ( ! ( consume_u32 ( buf + i , buf + len , & ptr -> index , & i ) ) ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> if ( ! ( consume_init_expr ( buf + i , buf + len , R_BIN_WASM_END_OF_CODE , NULL , & i ) ) ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> if ( ! ( consume_u32 ( buf + i , buf + len , & ptr -> num_elem , & i ) ) ) { //<S2SV> goto beach ; //<S2SV> } //<S2SV> ut32 j = 0 ; //<S2SV> while ( i < len && j < ptr -> num_elem ) { //<S2SV> ut32 e ; //<S2SV> if ( ! ( consume_u32 ( buf + i , buf + len , & e , & i ) ) ) { //<S2SV> free ( ptr ) ; //<S2SV> return ret ; //<S2SV> } //<S2SV> } //<S2SV> r_list_append ( ret , ptr ) ; //<S2SV> r += 1 ; //<S2SV> } //<S2SV> return ret ; //<S2SV> beach : //<S2SV> free ( ptr ) ; //<S2SV> return ret ; //<S2SV> } //<S2SV> 