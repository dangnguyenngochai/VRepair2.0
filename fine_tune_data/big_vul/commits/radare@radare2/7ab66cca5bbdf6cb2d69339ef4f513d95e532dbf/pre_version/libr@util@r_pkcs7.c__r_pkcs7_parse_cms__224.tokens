RCMS * r_pkcs7_parse_cms ( const ut8 * buffer , ut32 length ) { //<S2SV> RASN1Object * object ; //<S2SV> RCMS * container ; //<S2SV> if ( ! buffer || ! length ) { //<S2SV> return NULL ; //<S2SV> } //<S2SV> container = R_NEW0 ( RCMS ) ; //<S2SV> if ( ! container ) { //<S2SV> return NULL ; //<S2SV> } //<S2SV> object = r_asn1_create_object ( buffer , length ) ; //<S2SV> if ( ! object || object -> list . length != 2 || ! object -> list . objects [ 0 ] || object -> list . objects [ 1 ] -> list . length != 1 ) { //<S2SV> r_asn1_free_object ( object ) ; //<S2SV> free ( container ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> container -> contentType = r_asn1_stringify_oid ( object -> list . objects [ 0 ] -> sector , object -> list . objects [ 0 ] -> length ) ; //<S2SV> r_pkcs7_parse_signeddata ( & container -> signedData , object -> list . objects [ 1 ] -> list . objects [ 0 ] ) ; //<S2SV> r_asn1_free_object ( object ) ; //<S2SV> return container ; //<S2SV> } //<S2SV> 