static int store_xauthority ( void ) { //<S2SV> fs_build_mnt_dir ( ) ; //<S2SV> char * src ; //<S2SV> char * dest = RUN_XAUTHORITY_FILE ; //<S2SV> FILE * fp = fopen ( dest , "w" ) ; //<S2SV> if ( fp ) { //<S2SV> fprintf ( fp , "\\n" ) ; //<S2SV> SET_PERMS_STREAM ( fp , getuid ( ) , getgid ( ) , 0600 ) ; //<S2SV> fclose ( fp ) ; //<S2SV> } //<S2SV> if ( asprintf ( & src , "%s/.Xauthority" , cfg . homedir ) == - 1 ) //<S2SV> errExit ( "asprintf" ) ; //<S2SV> struct stat s ; //<S2SV> if ( stat ( src , & s ) == 0 ) { //<S2SV> if ( is_link ( src ) ) { //<S2SV> fprintf ( stderr , "Warning:<S2SV_blank>invalid<S2SV_blank>.Xauthority<S2SV_blank>file\\n" ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> copy_file_as_user ( src , dest , getuid ( ) , getgid ( ) , 0600 ) ; //<S2SV> fs_logger2 ( "clone" , dest ) ; //<S2SV> return 1 ; //<S2SV> } //<S2SV> return 0 ; //<S2SV> } //<S2SV> 