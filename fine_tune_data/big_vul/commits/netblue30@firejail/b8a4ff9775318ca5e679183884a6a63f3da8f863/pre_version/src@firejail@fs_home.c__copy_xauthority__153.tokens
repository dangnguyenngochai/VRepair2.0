static void copy_xauthority ( void ) { //<S2SV> char * src = RUN_XAUTHORITY_FILE ; //<S2SV> char * dest ; //<S2SV> if ( asprintf ( & dest , "%s/.Xauthority" , cfg . homedir ) == - 1 ) //<S2SV> errExit ( "asprintf" ) ; //<S2SV> if ( is_link ( dest ) ) { //<S2SV> fprintf ( stderr , "Error:<S2SV_blank>%s<S2SV_blank>is<S2SV_blank>a<S2SV_blank>symbolic<S2SV_blank>link\\n" , dest ) ; //<S2SV> exit ( 1 ) ; //<S2SV> } //<S2SV> pid_t child = fork ( ) ; //<S2SV> if ( child < 0 ) //<S2SV> errExit ( "fork" ) ; //<S2SV> if ( child == 0 ) { //<S2SV> drop_privs ( 0 ) ; //<S2SV> int rv = copy_file ( src , dest , getuid ( ) , getgid ( ) , S_IRUSR | S_IWUSR ) ; //<S2SV> if ( rv ) //<S2SV> fprintf ( stderr , "Warning:<S2SV_blank>cannot<S2SV_blank>transfer<S2SV_blank>.Xauthority<S2SV_blank>in<S2SV_blank>private<S2SV_blank>home<S2SV_blank>directory\\n" ) ; //<S2SV> else { //<S2SV> fs_logger2 ( "clone" , dest ) ; //<S2SV> } //<S2SV> _exit ( 0 ) ; //<S2SV> } //<S2SV> waitpid ( child , NULL , 0 ) ; //<S2SV> unlink ( src ) ; //<S2SV> } //<S2SV> 