static void detect_allow_debuggers ( int argc , char * * argv ) { //<S2SV> int i ; //<S2SV> for ( i = 1 ; i < argc ; i ++ ) { //<S2SV> if ( strcmp ( argv [ i ] , "--allow-debuggers" ) == 0 ) { //<S2SV> struct utsname u ; //<S2SV> int rv = uname ( & u ) ; //<S2SV> if ( rv != 0 ) //<S2SV> errExit ( "uname" ) ; //<S2SV> int major ; //<S2SV> int minor ; //<S2SV> if ( 2 != sscanf ( u . release , "%d.%d" , & major , & minor ) ) { //<S2SV> fprintf ( stderr , "Error:<S2SV_blank>cannot<S2SV_blank>extract<S2SV_blank>Linux<S2SV_blank>kernel<S2SV_blank>version:<S2SV_blank>%s\\n" , u . version ) ; //<S2SV> exit ( 1 ) ; //<S2SV> } //<S2SV> if ( major < 4 || ( major == 4 && minor < 8 ) ) { //<S2SV> fprintf ( stderr , "Error:<S2SV_blank>--allow-debuggers<S2SV_blank>is<S2SV_blank>disabled<S2SV_blank>on<S2SV_blank>Linux<S2SV_blank>kernels<S2SV_blank>prior<S2SV_blank>to<S2SV_blank>4.8.<S2SV_blank>" //<S2SV> "A<S2SV_blank>bug<S2SV_blank>in<S2SV_blank>ptrace<S2SV_blank>call<S2SV_blank>allows<S2SV_blank>a<S2SV_blank>full<S2SV_blank>bypass<S2SV_blank>of<S2SV_blank>the<S2SV_blank>seccomp<S2SV_blank>filter.<S2SV_blank>" //<S2SV> "Your<S2SV_blank>current<S2SV_blank>kernel<S2SV_blank>version<S2SV_blank>is<S2SV_blank>%d.%d.\\n" , major , minor ) ; //<S2SV> exit ( 1 ) ; //<S2SV> } //<S2SV> arg_allow_debuggers = 1 ; //<S2SV> break ; //<S2SV> } //<S2SV> if ( strcmp ( argv [ i ] , "--" ) == 0 ) //<S2SV> break ; //<S2SV> if ( strncmp ( argv [ i ] , "--" , 2 ) != 0 ) //<S2SV> break ; //<S2SV> } //<S2SV> } //<S2SV> 