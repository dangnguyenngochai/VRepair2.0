void preproc_mount_mnt_dir ( void ) { //<S2SV> if ( ! tmpfs_mounted ) { //<S2SV> if ( arg_debug ) //<S2SV> printf ( "Mounting<S2SV_blank>tmpfs<S2SV_blank>on<S2SV_blank>%s<S2SV_blank>directory\\n" , RUN_MNT_DIR ) ; //<S2SV> if ( mount ( "tmpfs" , RUN_MNT_DIR , "tmpfs" , MS_NOSUID | MS_STRICTATIME , "mode=755,gid=0" ) < 0 ) //<S2SV> errExit ( "mounting<S2SV_blank>/run/firejail/mnt" ) ; //<S2SV> tmpfs_mounted = 1 ; //<S2SV> fs_logger2 ( "tmpfs" , RUN_MNT_DIR ) ; //<S2SV> # ifdef HAVE_SECCOMP //<S2SV> create_empty_dir_as_root ( RUN_SECCOMP_DIR , 0755 ) ; //<S2SV> if ( arg_seccomp_block_secondary ) //<S2SV> copy_file ( PATH_SECCOMP_BLOCK_SECONDARY , RUN_SECCOMP_BLOCK_SECONDARY , getuid ( ) , getgid ( ) , 0644 ) ; //<S2SV> else { //<S2SV> copy_file ( PATH_SECCOMP_32 , RUN_SECCOMP_32 , getuid ( ) , getgid ( ) , 0644 ) ; //<S2SV> } //<S2SV> if ( arg_allow_debuggers ) //<S2SV> copy_file ( PATH_SECCOMP_DEFAULT_DEBUG , RUN_SECCOMP_CFG , getuid ( ) , getgid ( ) , 0644 ) ; //<S2SV> else //<S2SV> copy_file ( PATH_SECCOMP_DEFAULT , RUN_SECCOMP_CFG , getuid ( ) , getgid ( ) , 0644 ) ; //<S2SV> if ( arg_memory_deny_write_execute ) //<S2SV> copy_file ( PATH_SECCOMP_MDWX , RUN_SECCOMP_MDWX , getuid ( ) , getgid ( ) , 0644 ) ; //<S2SV> create_empty_file_as_root ( RUN_SECCOMP_PROTOCOL , 0644 ) ; //<S2SV> if ( set_perms ( RUN_SECCOMP_PROTOCOL , getuid ( ) , getgid ( ) , 0644 ) ) //<S2SV> errExit ( "set_perms" ) ; //<S2SV> create_empty_file_as_root ( RUN_SECCOMP_POSTEXEC , 0644 ) ; //<S2SV> if ( set_perms ( RUN_SECCOMP_POSTEXEC , getuid ( ) , getgid ( ) , 0644 ) ) //<S2SV> errExit ( "set_perms" ) ; //<S2SV> # endif //<S2SV> } //<S2SV> } //<S2SV> 