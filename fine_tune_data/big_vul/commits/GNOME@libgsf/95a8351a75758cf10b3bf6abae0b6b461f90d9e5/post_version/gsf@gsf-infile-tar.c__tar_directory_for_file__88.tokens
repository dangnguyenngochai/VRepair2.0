static GsfInfileTar * //<S2SV> tar_directory_for_file ( GsfInfileTar * dir , const char * name , gboolean last ) //<S2SV> { //<S2SV> const char * s = name ; //<S2SV> while ( 1 ) { //<S2SV> const char * s0 = s ; //<S2SV> char * dirname ; //<S2SV> while ( 1 ) { //<S2SV> if ( * s == 0 ) { //<S2SV> if ( last && s != s0 ) //<S2SV> break ; //<S2SV> else //<S2SV> return dir ; //<S2SV> } //<S2SV> if ( * s == '/' ) //<S2SV> break ; //<S2SV> s ++ ; //<S2SV> } //<S2SV> dirname = g_strndup ( s0 , s - s0 ) ; //<S2SV> while ( * s == '/' ) //<S2SV> s ++ ; //<S2SV> if ( strcmp ( dirname , "." ) != 0 ) { //<S2SV> GsfInput * subdir = //<S2SV> gsf_infile_child_by_name ( GSF_INFILE ( dir ) , //<S2SV> dirname ) ; //<S2SV> if ( subdir ) { //<S2SV> dir = GSF_IS_INFILE_TAR ( subdir ) //<S2SV> ? GSF_INFILE_TAR ( subdir ) //<S2SV> : dir ; //<S2SV> g_object_unref ( subdir ) ; //<S2SV> } else //<S2SV> dir = tar_create_dir ( dir , dirname ) ; //<S2SV> } //<S2SV> g_free ( dirname ) ; //<S2SV> } //<S2SV> } //<S2SV> 