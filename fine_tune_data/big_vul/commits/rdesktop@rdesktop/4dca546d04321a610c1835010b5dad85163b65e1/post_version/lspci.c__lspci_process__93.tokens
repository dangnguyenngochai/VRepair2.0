static void //<S2SV> lspci_process ( STREAM s ) //<S2SV> { //<S2SV> unsigned int pkglen ; //<S2SV> static char * rest = NULL ; //<S2SV> char * buf ; //<S2SV> struct stream packet = * s ; //<S2SV> if ( ! s_check ( s ) ) //<S2SV> { //<S2SV> rdp_protocol_error ( "lspci_process(),<S2SV_blank>stream<S2SV_blank>is<S2SV_blank>in<S2SV_blank>unstable<S2SV_blank>state" , & packet ) ; //<S2SV> } //<S2SV> pkglen = s -> end - s -> p ; //<S2SV> buf = xmalloc ( pkglen + 1 ) ; //<S2SV> STRNCPY ( buf , ( char * ) s -> p , pkglen + 1 ) ; //<S2SV> str_handle_lines ( buf , & rest , lspci_process_line , NULL ) ; //<S2SV> xfree ( buf ) ; //<S2SV> } //<S2SV> 