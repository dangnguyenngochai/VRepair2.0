RD_BOOL //<S2SV> ber_parse_header ( STREAM s , int tagval , uint32 * length ) //<S2SV> { //<S2SV> int tag , len ; //<S2SV> if ( tagval > 0xff ) //<S2SV> { //<S2SV> in_uint16_be ( s , tag ) ; //<S2SV> } //<S2SV> else //<S2SV> { //<S2SV> in_uint8 ( s , tag ) ; //<S2SV> } //<S2SV> if ( tag != tagval ) //<S2SV> { //<S2SV> logger ( Core , Error , "ber_parse_header(),<S2SV_blank>expected<S2SV_blank>tag<S2SV_blank>%d,<S2SV_blank>got<S2SV_blank>%d" , tagval , tag ) ; //<S2SV> return False ; //<S2SV> } //<S2SV> in_uint8 ( s , len ) ; //<S2SV> if ( len & 0x80 ) //<S2SV> { //<S2SV> len &= ~ 0x80 ; //<S2SV> * length = 0 ; //<S2SV> while ( len -- ) //<S2SV> next_be ( s , * length ) ; //<S2SV> } //<S2SV> else //<S2SV> * length = len ; //<S2SV> return s_check ( s ) ; //<S2SV> } //<S2SV> 