static Status //<S2SV> accept_xsmp_connection ( SmsConn sms_conn , //<S2SV> GsmXsmpServer * server , //<S2SV> unsigned long * mask_ret , //<S2SV> SmsCallbacks * callbacks_ret , //<S2SV> char * * failure_reason_ret ) //<S2SV> { //<S2SV> IceConn ice_conn ; //<S2SV> GsmClient * client ; //<S2SV> GsmIceConnectionWatch * data ; //<S2SV> if ( server -> priv -> xsmp_sockets == NULL ) { //<S2SV> g_debug ( "GsmXsmpServer:<S2SV_blank>In<S2SV_blank>shutdown,<S2SV_blank>rejecting<S2SV_blank>new<S2SV_blank>client" ) ; //<S2SV> * failure_reason_ret = strdup ( _ ( "Refusing<S2SV_blank>new<S2SV_blank>client<S2SV_blank>connection<S2SV_blank>because<S2SV_blank>the<S2SV_blank>session<S2SV_blank>is<S2SV_blank>currently<S2SV_blank>being<S2SV_blank>shut<S2SV_blank>down\\n" ) ) ; //<S2SV> return FALSE ; //<S2SV> } //<S2SV> ice_conn = SmsGetIceConnection ( sms_conn ) ; //<S2SV> data = ice_conn -> context ; //<S2SV> free_ice_connection_watch ( data ) ; //<S2SV> client = gsm_xsmp_client_new ( ice_conn ) ; //<S2SV> gsm_store_add ( server -> priv -> client_store , gsm_client_peek_id ( client ) , G_OBJECT ( client ) ) ; //<S2SV> g_object_unref ( client ) ; //<S2SV> gsm_xsmp_client_connect ( GSM_XSMP_CLIENT ( client ) , sms_conn , mask_ret , callbacks_ret ) ; //<S2SV> return TRUE ; //<S2SV> } //<S2SV> 