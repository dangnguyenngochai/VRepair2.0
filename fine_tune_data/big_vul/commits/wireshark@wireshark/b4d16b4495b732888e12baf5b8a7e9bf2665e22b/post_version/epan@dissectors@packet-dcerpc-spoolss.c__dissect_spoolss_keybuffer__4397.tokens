static int //<S2SV> dissect_spoolss_keybuffer ( tvbuff_t * tvb , int offset , packet_info * pinfo , //<S2SV> proto_tree * tree , dcerpc_info * di , guint8 * drep ) //<S2SV> { //<S2SV> guint32 size ; //<S2SV> int end_offset ; //<S2SV> if ( di -> conformant_run ) //<S2SV> return offset ; //<S2SV> offset = dissect_ndr_uint32 ( tvb , offset , pinfo , tree , di , drep , //<S2SV> hf_keybuffer_size , & size ) ; //<S2SV> end_offset = offset + ( size * 2 ) ; //<S2SV> if ( end_offset < offset ) { //<S2SV> end_offset = tvb_reported_length_remaining ( tvb , offset ) + 1 ; //<S2SV> } //<S2SV> while ( offset > 0 && offset < end_offset ) { //<S2SV> offset = dissect_spoolss_uint16uni ( //<S2SV> tvb , offset , pinfo , tree , drep , NULL , hf_keybuffer ) ; //<S2SV> } //<S2SV> return offset ; //<S2SV> } //<S2SV> 