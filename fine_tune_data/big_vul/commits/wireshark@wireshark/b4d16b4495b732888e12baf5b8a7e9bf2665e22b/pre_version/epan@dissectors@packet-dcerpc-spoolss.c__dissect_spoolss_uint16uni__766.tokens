static int //<S2SV> dissect_spoolss_uint16uni ( tvbuff_t * tvb , int offset , packet_info * pinfo _U_ , //<S2SV> proto_tree * tree , guint8 * drep _U_ , char * * data , //<S2SV> int hf_name ) //<S2SV> { //<S2SV> gint len , remaining ; //<S2SV> char * text ; //<S2SV> if ( offset % 2 ) //<S2SV> offset += 2 - ( offset % 2 ) ; //<S2SV> remaining = tvb_captured_length_remaining ( tvb , offset ) ; //<S2SV> if ( remaining <= 0 ) { //<S2SV> if ( data ) //<S2SV> * data = g_strdup ( "" ) ; //<S2SV> return offset ; //<S2SV> } //<S2SV> text = tvb_get_string_enc ( NULL , tvb , offset , remaining , ENC_UTF_16 | ENC_LITTLE_ENDIAN ) ; //<S2SV> len = ( int ) strlen ( text ) ; //<S2SV> proto_tree_add_string ( tree , hf_name , tvb , offset , len * 2 , text ) ; //<S2SV> if ( data ) //<S2SV> * data = text ; //<S2SV> else //<S2SV> g_free ( text ) ; //<S2SV> return offset + ( len + 1 ) * 2 ; //<S2SV> } //<S2SV> 