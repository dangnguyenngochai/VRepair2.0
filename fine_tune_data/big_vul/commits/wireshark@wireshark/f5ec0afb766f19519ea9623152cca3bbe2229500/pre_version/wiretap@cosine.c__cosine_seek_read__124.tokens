static gboolean //<S2SV> cosine_seek_read ( wtap * wth , gint64 seek_off , struct wtap_pkthdr * phdr , //<S2SV> Buffer * buf , int * err , gchar * * err_info ) //<S2SV> { //<S2SV> int pkt_len ; //<S2SV> char line [ COSINE_LINE_LENGTH ] ; //<S2SV> if ( file_seek ( wth -> random_fh , seek_off , SEEK_SET , err ) == - 1 ) //<S2SV> return FALSE ; //<S2SV> if ( file_gets ( line , COSINE_LINE_LENGTH , wth -> random_fh ) == NULL ) { //<S2SV> * err = file_error ( wth -> random_fh , err_info ) ; //<S2SV> if ( * err == 0 ) { //<S2SV> * err = WTAP_ERR_SHORT_READ ; //<S2SV> } //<S2SV> return FALSE ; //<S2SV> } //<S2SV> pkt_len = parse_cosine_rec_hdr ( phdr , line , err , err_info ) ; //<S2SV> if ( pkt_len == - 1 ) //<S2SV> return FALSE ; //<S2SV> return parse_cosine_hex_dump ( wth -> random_fh , phdr , pkt_len , buf , err , //<S2SV> err_info ) ; //<S2SV> } //<S2SV> 