static gboolean netscreen_read ( wtap * wth , int * err , gchar * * err_info , //<S2SV> gint64 * data_offset ) //<S2SV> { //<S2SV> gint64 offset ; //<S2SV> char line [ NETSCREEN_LINE_LENGTH ] ; //<S2SV> offset = netscreen_seek_next_packet ( wth , err , err_info , line ) ; //<S2SV> if ( offset < 0 ) //<S2SV> return FALSE ; //<S2SV> if ( ! parse_netscreen_packet ( wth -> fh , & wth -> phdr , //<S2SV> wth -> frame_buffer , line , err , err_info ) ) //<S2SV> return FALSE ; //<S2SV> if ( wth -> file_encap == WTAP_ENCAP_UNKNOWN ) //<S2SV> wth -> file_encap = wth -> phdr . pkt_encap ; //<S2SV> else { //<S2SV> if ( wth -> file_encap != wth -> phdr . pkt_encap ) //<S2SV> wth -> file_encap = WTAP_ENCAP_PER_PACKET ; //<S2SV> } //<S2SV> * data_offset = offset ; //<S2SV> return TRUE ; //<S2SV> } //<S2SV> 