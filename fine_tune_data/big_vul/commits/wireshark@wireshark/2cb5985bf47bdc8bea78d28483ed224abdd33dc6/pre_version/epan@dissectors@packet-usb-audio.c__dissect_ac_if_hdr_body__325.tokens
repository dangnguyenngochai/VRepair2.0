static gint //<S2SV> dissect_ac_if_hdr_body ( tvbuff_t * tvb , gint offset , packet_info * pinfo _U_ , //<S2SV> proto_tree * tree , usb_conv_info_t * usb_conv_info ) //<S2SV> { //<S2SV> gint offset_start ; //<S2SV> guint16 bcdADC ; //<S2SV> guint8 ver_major ; //<S2SV> double ver ; //<S2SV> guint8 if_in_collection , i ; //<S2SV> audio_conv_info_t * audio_conv_info ; //<S2SV> offset_start = offset ; //<S2SV> bcdADC = tvb_get_letohs ( tvb , offset ) ; //<S2SV> ver_major = USB_AUDIO_BCD44_TO_DEC ( bcdADC >> 8 ) ; //<S2SV> ver = ver_major + USB_AUDIO_BCD44_TO_DEC ( bcdADC & 0xFF ) / 100.0 ; //<S2SV> proto_tree_add_double_format_value ( tree , hf_ac_if_hdr_ver , //<S2SV> tvb , offset , 2 , ver , "%2.2f" , ver ) ; //<S2SV> audio_conv_info = ( audio_conv_info_t * ) usb_conv_info -> class_data ; //<S2SV> if ( ! audio_conv_info ) { //<S2SV> audio_conv_info = wmem_new ( wmem_file_scope ( ) , audio_conv_info_t ) ; //<S2SV> usb_conv_info -> class_data = audio_conv_info ; //<S2SV> } //<S2SV> audio_conv_info -> ver_major = ver_major ; //<S2SV> offset += 2 ; //<S2SV> if ( ver_major == 1 ) { //<S2SV> proto_tree_add_item ( tree , hf_ac_if_hdr_total_len , //<S2SV> tvb , offset , 2 , ENC_LITTLE_ENDIAN ) ; //<S2SV> offset += 2 ; //<S2SV> if_in_collection = tvb_get_guint8 ( tvb , offset ) ; //<S2SV> proto_tree_add_item ( tree , hf_ac_if_hdr_bInCollection , //<S2SV> tvb , offset , 1 , ENC_LITTLE_ENDIAN ) ; //<S2SV> offset ++ ; //<S2SV> for ( i = 0 ; i < if_in_collection ; i ++ ) { //<S2SV> proto_tree_add_item ( tree , hf_ac_if_hdr_if_num , //<S2SV> tvb , offset , 1 , ENC_LITTLE_ENDIAN ) ; //<S2SV> offset ++ ; //<S2SV> } //<S2SV> } //<S2SV> return offset - offset_start ; //<S2SV> } //<S2SV> 