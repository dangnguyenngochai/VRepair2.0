protected int //<S2SV> file_check_mem ( struct magic_set * ms , unsigned int level ) //<S2SV> { //<S2SV> size_t len ; //<S2SV> if ( level >= ms -> c . len ) { //<S2SV> len = ( ms -> c . len = 20 + level ) * sizeof ( * ms -> c . li ) ; //<S2SV> ms -> c . li = CAST ( struct level_info * , ( ms -> c . li == NULL ) ? //<S2SV> malloc ( len ) : //<S2SV> realloc ( ms -> c . li , len ) ) ; //<S2SV> if ( ms -> c . li == NULL ) { //<S2SV> file_oomem ( ms , len ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> } //<S2SV> ms -> c . li [ level ] . got_match = 0 ; //<S2SV> # ifdef ENABLE_CONDITIONALS //<S2SV> ms -> c . li [ level ] . last_match = 0 ; //<S2SV> ms -> c . li [ level ] . last_cond = COND_NONE ; //<S2SV> # endif //<S2SV> return 0 ; //<S2SV> } //<S2SV> 