char * curl_easy_unescape ( CURL * handle , const char * string , int length , //<S2SV> int * olen ) //<S2SV> { //<S2SV> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; //<S2SV> char * ns = malloc ( alloc ) ; //<S2SV> unsigned char in ; //<S2SV> int strindex = 0 ; //<S2SV> unsigned long hex ; //<S2SV> CURLcode res ; //<S2SV> if ( ! ns ) //<S2SV> return NULL ; //<S2SV> while ( -- alloc > 0 ) { //<S2SV> in = * string ; //<S2SV> if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { //<S2SV> char hexstr [ 3 ] ; //<S2SV> char * ptr ; //<S2SV> hexstr [ 0 ] = string [ 1 ] ; //<S2SV> hexstr [ 1 ] = string [ 2 ] ; //<S2SV> hexstr [ 2 ] = 0 ; //<S2SV> hex = strtoul ( hexstr , & ptr , 16 ) ; //<S2SV> in = curlx_ultouc ( hex ) ; //<S2SV> res = Curl_convert_from_network ( handle , & in , 1 ) ; //<S2SV> if ( res ) { //<S2SV> free ( ns ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> string += 2 ; //<S2SV> alloc -= 2 ; //<S2SV> } //<S2SV> ns [ strindex ++ ] = in ; //<S2SV> string ++ ; //<S2SV> } //<S2SV> ns [ strindex ] = 0 ; //<S2SV> if ( olen ) //<S2SV> * olen = strindex ; //<S2SV> return ns ; //<S2SV> } //<S2SV> 