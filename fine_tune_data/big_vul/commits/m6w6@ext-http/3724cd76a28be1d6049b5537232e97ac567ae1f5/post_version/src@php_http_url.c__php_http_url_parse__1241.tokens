php_http_url_t * php_http_url_parse ( const char * str , size_t len , unsigned flags TSRMLS_DC ) //<S2SV> { //<S2SV> size_t maxlen = 3 * len + 8 ; //<S2SV> struct parse_state * state = ecalloc ( 1 , sizeof ( * state ) + maxlen ) ; //<S2SV> state -> end = str + len ; //<S2SV> state -> ptr = str ; //<S2SV> state -> flags = flags ; //<S2SV> state -> maxlen = maxlen ; //<S2SV> TSRMLS_SET_CTX ( state -> ts ) ; //<S2SV> if ( ! parse_scheme ( state ) ) { //<S2SV> php_error_docref ( NULL TSRMLS_CC , E_WARNING , "Failed<S2SV_blank>to<S2SV_blank>parse<S2SV_blank>URL<S2SV_blank>scheme:<S2SV_blank>\'%s\'" , state -> ptr ) ; //<S2SV> efree ( state ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> if ( ! parse_hier ( state ) ) { //<S2SV> efree ( state ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> if ( ! parse_query ( state ) ) { //<S2SV> php_error_docref ( NULL TSRMLS_CC , E_WARNING , "Failed<S2SV_blank>to<S2SV_blank>parse<S2SV_blank>URL<S2SV_blank>query:<S2SV_blank>\'%s\'" , state -> ptr ) ; //<S2SV> efree ( state ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> if ( ! parse_fragment ( state ) ) { //<S2SV> php_error_docref ( NULL TSRMLS_CC , E_WARNING , "Failed<S2SV_blank>to<S2SV_blank>parse<S2SV_blank>URL<S2SV_blank>fragment:<S2SV_blank>\'%s\'" , state -> ptr ) ; //<S2SV> efree ( state ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> return ( php_http_url_t * ) state ; //<S2SV> } //<S2SV> 