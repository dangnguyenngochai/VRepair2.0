static void scsi_read_complete ( void * opaque , int ret ) //<S2SV> { //<S2SV> SCSIDiskReq * r = ( SCSIDiskReq * ) opaque ; //<S2SV> SCSIDiskState * s = DO_UPCAST ( SCSIDiskState , qdev , r -> req . dev ) ; //<S2SV> int n ; //<S2SV> if ( r -> req . aiocb != NULL ) { //<S2SV> r -> req . aiocb = NULL ; //<S2SV> bdrv_acct_done ( s -> bs , & r -> acct ) ; //<S2SV> } //<S2SV> if ( ret ) { //<S2SV> if ( scsi_handle_rw_error ( r , - ret , SCSI_REQ_STATUS_RETRY_READ ) ) { //<S2SV> return ; //<S2SV> } //<S2SV> } //<S2SV> DPRINTF ( "Data<S2SV_blank>ready<S2SV_blank>tag=0x%x<S2SV_blank>len=%zd\\n" , r -> req . tag , r -> iov . iov_len ) ; //<S2SV> n = r -> iov . iov_len / 512 ; //<S2SV> r -> sector += n ; //<S2SV> r -> sector_count -= n ; //<S2SV> scsi_req_data ( & r -> req , r -> iov . iov_len ) ; //<S2SV> } //<S2SV> 