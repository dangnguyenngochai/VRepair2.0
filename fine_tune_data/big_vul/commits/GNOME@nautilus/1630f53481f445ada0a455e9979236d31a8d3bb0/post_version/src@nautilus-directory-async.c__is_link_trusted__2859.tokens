static gboolean //<S2SV> is_link_trusted ( NautilusFile * file , //<S2SV> gboolean is_launcher ) //<S2SV> { //<S2SV> GFile * location ; //<S2SV> gboolean res ; //<S2SV> g_autofree gchar * trusted = NULL ; //<S2SV> if ( ! is_launcher ) //<S2SV> { //<S2SV> return TRUE ; //<S2SV> } //<S2SV> trusted = nautilus_file_get_metadata ( file , //<S2SV> NAUTILUS_METADATA_KEY_DESKTOP_FILE_TRUSTED , //<S2SV> NULL ) ; //<S2SV> if ( nautilus_file_can_execute ( file ) && trusted != NULL ) //<S2SV> { //<S2SV> return TRUE ; //<S2SV> } //<S2SV> res = FALSE ; //<S2SV> if ( nautilus_file_is_local ( file ) ) //<S2SV> { //<S2SV> location = nautilus_file_get_location ( file ) ; //<S2SV> res = nautilus_is_in_system_dir ( location ) ; //<S2SV> g_object_unref ( location ) ; //<S2SV> } //<S2SV> return res ; //<S2SV> } //<S2SV> 