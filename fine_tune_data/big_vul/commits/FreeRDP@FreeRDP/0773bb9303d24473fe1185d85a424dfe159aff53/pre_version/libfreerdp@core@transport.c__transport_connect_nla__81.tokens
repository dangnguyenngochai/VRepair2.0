BOOL transport_connect_nla ( rdpTransport * transport ) //<S2SV> { //<S2SV> freerdp * instance ; //<S2SV> rdpSettings * settings ; //<S2SV> if ( transport -> layer == TRANSPORT_LAYER_TSG ) //<S2SV> return TRUE ; //<S2SV> if ( ! transport_connect_tls ( transport ) ) //<S2SV> return FALSE ; //<S2SV> if ( transport -> settings -> Authentication != TRUE ) //<S2SV> return TRUE ; //<S2SV> settings = transport -> settings ; //<S2SV> instance = ( freerdp * ) settings -> instance ; //<S2SV> if ( transport -> credssp == NULL ) //<S2SV> transport -> credssp = credssp_new ( instance , transport , settings ) ; //<S2SV> if ( credssp_authenticate ( transport -> credssp ) < 0 ) //<S2SV> { //<S2SV> if ( ! connectErrorCode ) //<S2SV> connectErrorCode = AUTHENTICATIONERROR ; //<S2SV> fprintf ( stderr , "Authentication<S2SV_blank>failure,<S2SV_blank>check<S2SV_blank>credentials.\\n" //<S2SV> "If<S2SV_blank>credentials<S2SV_blank>are<S2SV_blank>valid,<S2SV_blank>the<S2SV_blank>NTLMSSP<S2SV_blank>implementation<S2SV_blank>may<S2SV_blank>be<S2SV_blank>to<S2SV_blank>blame.\\n" ) ; //<S2SV> credssp_free ( transport -> credssp ) ; //<S2SV> return FALSE ; //<S2SV> } //<S2SV> credssp_free ( transport -> credssp ) ; //<S2SV> return TRUE ; //<S2SV> } //<S2SV> 