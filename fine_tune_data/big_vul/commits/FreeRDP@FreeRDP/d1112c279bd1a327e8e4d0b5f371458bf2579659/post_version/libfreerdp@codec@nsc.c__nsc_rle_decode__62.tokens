static BOOL nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 outSize , UINT32 originalSize ) //<S2SV> { //<S2SV> UINT32 len ; //<S2SV> UINT32 left ; //<S2SV> BYTE value ; //<S2SV> left = originalSize ; //<S2SV> while ( left > 4 ) //<S2SV> { //<S2SV> value = * in ++ ; //<S2SV> if ( left == 5 ) //<S2SV> { //<S2SV> if ( outSize < 1 ) //<S2SV> return FALSE ; //<S2SV> outSize -- ; //<S2SV> * out ++ = value ; //<S2SV> left -- ; //<S2SV> } //<S2SV> else if ( value == * in ) //<S2SV> { //<S2SV> in ++ ; //<S2SV> if ( * in < 0xFF ) //<S2SV> { //<S2SV> len = ( UINT32 ) * in ++ ; //<S2SV> len += 2 ; //<S2SV> } //<S2SV> else //<S2SV> { //<S2SV> in ++ ; //<S2SV> len = * ( ( UINT32 * ) in ) ; //<S2SV> in += 4 ; //<S2SV> } //<S2SV> if ( outSize < len ) //<S2SV> return FALSE ; //<S2SV> outSize -= len ; //<S2SV> FillMemory ( out , len , value ) ; //<S2SV> out += len ; //<S2SV> left -= len ; //<S2SV> } //<S2SV> else //<S2SV> { //<S2SV> if ( outSize < 1 ) //<S2SV> return FALSE ; //<S2SV> outSize -- ; //<S2SV> * out ++ = value ; //<S2SV> left -- ; //<S2SV> } //<S2SV> } //<S2SV> if ( ( outSize < 4 ) || ( left < 4 ) ) //<S2SV> return FALSE ; //<S2SV> memcpy ( out , in , 4 ) ; //<S2SV> return TRUE ; //<S2SV> } //<S2SV> 