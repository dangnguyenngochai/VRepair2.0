static int ntlm_read_message_fields_buffer ( wStream * s , NTLM_MESSAGE_FIELDS * fields ) //<S2SV> { //<S2SV> if ( fields -> Len > 0 ) //<S2SV> { //<S2SV> const UINT64 offset = ( UINT64 ) fields -> BufferOffset + ( UINT64 ) fields -> Len ; //<S2SV> if ( offset > Stream_Length ( s ) ) //<S2SV> return - 1 ; //<S2SV> fields -> Buffer = ( PBYTE ) malloc ( fields -> Len ) ; //<S2SV> if ( ! fields -> Buffer ) //<S2SV> return - 1 ; //<S2SV> Stream_SetPosition ( s , fields -> BufferOffset ) ; //<S2SV> Stream_Read ( s , fields -> Buffer , fields -> Len ) ; //<S2SV> } //<S2SV> return 1 ; //<S2SV> } //<S2SV> 