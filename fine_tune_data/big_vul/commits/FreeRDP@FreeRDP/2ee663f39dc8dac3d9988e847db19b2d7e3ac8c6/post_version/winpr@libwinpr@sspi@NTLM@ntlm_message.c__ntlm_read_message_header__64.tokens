static int ntlm_read_message_header ( wStream * s , NTLM_MESSAGE_HEADER * header ) //<S2SV> { //<S2SV> if ( Stream_GetRemainingLength ( s ) < 12 ) //<S2SV> return - 1 ; //<S2SV> Stream_Read ( s , header -> Signature , 8 ) ; //<S2SV> Stream_Read_UINT32 ( s , header -> MessageType ) ; //<S2SV> if ( strncmp ( ( char * ) header -> Signature , NTLM_SIGNATURE , 8 ) != 0 ) //<S2SV> return - 1 ; //<S2SV> return 1 ; //<S2SV> } //<S2SV> 