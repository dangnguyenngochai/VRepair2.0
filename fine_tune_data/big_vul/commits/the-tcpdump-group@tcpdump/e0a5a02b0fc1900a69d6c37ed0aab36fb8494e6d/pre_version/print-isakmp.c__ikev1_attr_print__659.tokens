static const u_char * //<S2SV> ikev1_attr_print ( netdissect_options * ndo , const u_char * p , const u_char * ep ) //<S2SV> { //<S2SV> int totlen ; //<S2SV> uint32_t t ; //<S2SV> if ( p [ 0 ] & 0x80 ) //<S2SV> totlen = 4 ; //<S2SV> else //<S2SV> totlen = 4 + EXTRACT_16BITS ( & p [ 2 ] ) ; //<S2SV> if ( ep < p + totlen ) { //<S2SV> ND_PRINT ( ( ndo , "[|attr]" ) ) ; //<S2SV> return ep + 1 ; //<S2SV> } //<S2SV> ND_PRINT ( ( ndo , "(" ) ) ; //<S2SV> t = EXTRACT_16BITS ( & p [ 0 ] ) & 0x7fff ; //<S2SV> ND_PRINT ( ( ndo , "type=#%d<S2SV_blank>" , t ) ) ; //<S2SV> if ( p [ 0 ] & 0x80 ) { //<S2SV> ND_PRINT ( ( ndo , "value=" ) ) ; //<S2SV> t = p [ 2 ] ; //<S2SV> rawprint ( ndo , ( const uint8_t * ) & p [ 2 ] , 2 ) ; //<S2SV> } else { //<S2SV> ND_PRINT ( ( ndo , "len=%d<S2SV_blank>value=" , EXTRACT_16BITS ( & p [ 2 ] ) ) ) ; //<S2SV> rawprint ( ndo , ( const uint8_t * ) & p [ 4 ] , EXTRACT_16BITS ( & p [ 2 ] ) ) ; //<S2SV> } //<S2SV> ND_PRINT ( ( ndo , ")" ) ) ; //<S2SV> return p + totlen ; //<S2SV> } //<S2SV> 