int //<S2SV> frag6_print ( netdissect_options * ndo , register const u_char * bp , register const u_char * bp2 ) //<S2SV> { //<S2SV> register const struct ip6_frag * dp ; //<S2SV> register const struct ip6_hdr * ip6 ; //<S2SV> dp = ( const struct ip6_frag * ) bp ; //<S2SV> ip6 = ( const struct ip6_hdr * ) bp2 ; //<S2SV> ND_TCHECK ( dp -> ip6f_offlg ) ; //<S2SV> if ( ndo -> ndo_vflag ) { //<S2SV> ND_PRINT ( ( ndo , "frag<S2SV_blank>(0x%08x:%d|%ld)" , //<S2SV> EXTRACT_32BITS ( & dp -> ip6f_ident ) , //<S2SV> EXTRACT_16BITS ( & dp -> ip6f_offlg ) & IP6F_OFF_MASK , //<S2SV> sizeof ( struct ip6_hdr ) + EXTRACT_16BITS ( & ip6 -> ip6_plen ) - //<S2SV> ( long ) ( bp - bp2 ) - sizeof ( struct ip6_frag ) ) ) ; //<S2SV> } else { //<S2SV> ND_PRINT ( ( ndo , "frag<S2SV_blank>(%d|%ld)" , //<S2SV> EXTRACT_16BITS ( & dp -> ip6f_offlg ) & IP6F_OFF_MASK , //<S2SV> sizeof ( struct ip6_hdr ) + EXTRACT_16BITS ( & ip6 -> ip6_plen ) - //<S2SV> ( long ) ( bp - bp2 ) - sizeof ( struct ip6_frag ) ) ) ; //<S2SV> } //<S2SV> if ( ( EXTRACT_16BITS ( & dp -> ip6f_offlg ) & IP6F_OFF_MASK ) != 0 ) //<S2SV> return - 1 ; //<S2SV> else //<S2SV> { //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>" ) ) ; //<S2SV> return sizeof ( struct ip6_frag ) ; //<S2SV> } //<S2SV> trunc : //<S2SV> ND_PRINT ( ( ndo , "[|frag]" ) ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> 