static int //<S2SV> mp_dss_print ( netdissect_options * ndo , //<S2SV> const u_char * opt , u_int opt_len , u_char flags ) //<S2SV> { //<S2SV> const struct mp_dss * mdss = ( const struct mp_dss * ) opt ; //<S2SV> if ( ( opt_len != mp_dss_len ( mdss , 1 ) && //<S2SV> opt_len != mp_dss_len ( mdss , 0 ) ) || flags & TH_SYN ) //<S2SV> return 0 ; //<S2SV> if ( mdss -> flags & MP_DSS_F ) //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>fin" ) ) ; //<S2SV> opt += 4 ; //<S2SV> if ( mdss -> flags & MP_DSS_A ) { //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>ack<S2SV_blank>" ) ) ; //<S2SV> if ( mdss -> flags & MP_DSS_a ) { //<S2SV> ND_PRINT ( ( ndo , "%" PRIu64 , EXTRACT_64BITS ( opt ) ) ) ; //<S2SV> opt += 8 ; //<S2SV> } else { //<S2SV> ND_PRINT ( ( ndo , "%u" , EXTRACT_32BITS ( opt ) ) ) ; //<S2SV> opt += 4 ; //<S2SV> } //<S2SV> } //<S2SV> if ( mdss -> flags & MP_DSS_M ) { //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>seq<S2SV_blank>" ) ) ; //<S2SV> if ( mdss -> flags & MP_DSS_m ) { //<S2SV> ND_PRINT ( ( ndo , "%" PRIu64 , EXTRACT_64BITS ( opt ) ) ) ; //<S2SV> opt += 8 ; //<S2SV> } else { //<S2SV> ND_PRINT ( ( ndo , "%u" , EXTRACT_32BITS ( opt ) ) ) ; //<S2SV> opt += 4 ; //<S2SV> } //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>subseq<S2SV_blank>%u" , EXTRACT_32BITS ( opt ) ) ) ; //<S2SV> opt += 4 ; //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>len<S2SV_blank>%u" , EXTRACT_16BITS ( opt ) ) ) ; //<S2SV> opt += 2 ; //<S2SV> if ( opt_len == mp_dss_len ( mdss , 1 ) ) //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>csum<S2SV_blank>0x%x" , EXTRACT_16BITS ( opt ) ) ) ; //<S2SV> } //<S2SV> return 1 ; //<S2SV> } //<S2SV> 