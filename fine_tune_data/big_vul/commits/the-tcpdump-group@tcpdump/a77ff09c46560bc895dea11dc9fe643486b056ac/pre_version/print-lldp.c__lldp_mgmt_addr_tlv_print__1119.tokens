static int //<S2SV> lldp_mgmt_addr_tlv_print ( netdissect_options * ndo , //<S2SV> const u_char * pptr , u_int len ) //<S2SV> { //<S2SV> uint8_t mgmt_addr_len , intf_num_subtype , oid_len ; //<S2SV> const u_char * tptr ; //<S2SV> u_int tlen ; //<S2SV> char * mgmt_addr ; //<S2SV> tlen = len ; //<S2SV> tptr = pptr ; //<S2SV> if ( tlen < 1 ) { //<S2SV> return 0 ; //<S2SV> } //<S2SV> mgmt_addr_len = * tptr ++ ; //<S2SV> tlen -- ; //<S2SV> if ( tlen < mgmt_addr_len ) { //<S2SV> return 0 ; //<S2SV> } //<S2SV> mgmt_addr = lldp_network_addr_print ( ndo , tptr , mgmt_addr_len ) ; //<S2SV> if ( mgmt_addr == NULL ) { //<S2SV> return 0 ; //<S2SV> } //<S2SV> ND_PRINT ( ( ndo , "\\n\\t<S2SV_blank><S2SV_blank>Management<S2SV_blank>Address<S2SV_blank>length<S2SV_blank>%u,<S2SV_blank>%s" , //<S2SV> mgmt_addr_len , mgmt_addr ) ) ; //<S2SV> tptr += mgmt_addr_len ; //<S2SV> tlen -= mgmt_addr_len ; //<S2SV> if ( tlen < LLDP_INTF_NUM_LEN ) { //<S2SV> return 0 ; //<S2SV> } //<S2SV> intf_num_subtype = * tptr ; //<S2SV> ND_PRINT ( ( ndo , "\\n\\t<S2SV_blank><S2SV_blank>%s<S2SV_blank>Interface<S2SV_blank>Numbering<S2SV_blank>(%u):<S2SV_blank>%u" , //<S2SV> tok2str ( lldp_intf_numb_subtype_values , "Unknown" , intf_num_subtype ) , //<S2SV> intf_num_subtype , //<S2SV> EXTRACT_32BITS ( tptr + 1 ) ) ) ; //<S2SV> tptr += LLDP_INTF_NUM_LEN ; //<S2SV> tlen -= LLDP_INTF_NUM_LEN ; //<S2SV> if ( tlen ) { //<S2SV> oid_len = * tptr ; //<S2SV> if ( tlen < oid_len ) { //<S2SV> return 0 ; //<S2SV> } //<S2SV> if ( oid_len ) { //<S2SV> ND_PRINT ( ( ndo , "\\n\\t<S2SV_blank><S2SV_blank>OID<S2SV_blank>length<S2SV_blank>%u" , oid_len ) ) ; //<S2SV> safeputs ( ndo , tptr + 1 , oid_len ) ; //<S2SV> } //<S2SV> } //<S2SV> return 1 ; //<S2SV> } //<S2SV> 