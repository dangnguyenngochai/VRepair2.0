static void //<S2SV> rpl_print ( netdissect_options * ndo , //<S2SV> const struct icmp6_hdr * hdr , //<S2SV> const u_char * bp , u_int length ) //<S2SV> { //<S2SV> int secured = hdr -> icmp6_code & 0x80 ; //<S2SV> int basecode = hdr -> icmp6_code & 0x7f ; //<S2SV> if ( secured ) { //<S2SV> ND_PRINT ( ( ndo , ",<S2SV_blank>(SEC)<S2SV_blank>[worktodo]" ) ) ; //<S2SV> return ; //<S2SV> } else { //<S2SV> ND_PRINT ( ( ndo , ",<S2SV_blank>(CLR)" ) ) ; //<S2SV> } //<S2SV> switch ( basecode ) { //<S2SV> case ND_RPL_DAG_IS : //<S2SV> ND_PRINT ( ( ndo , "DODAG<S2SV_blank>Information<S2SV_blank>Solicitation" ) ) ; //<S2SV> if ( ndo -> ndo_vflag ) { //<S2SV> } //<S2SV> break ; //<S2SV> case ND_RPL_DAG_IO : //<S2SV> ND_PRINT ( ( ndo , "DODAG<S2SV_blank>Information<S2SV_blank>Object" ) ) ; //<S2SV> if ( ndo -> ndo_vflag ) { //<S2SV> rpl_dio_print ( ndo , bp , length ) ; //<S2SV> } //<S2SV> break ; //<S2SV> case ND_RPL_DAO : //<S2SV> ND_PRINT ( ( ndo , "Destination<S2SV_blank>Advertisement<S2SV_blank>Object" ) ) ; //<S2SV> if ( ndo -> ndo_vflag ) { //<S2SV> rpl_dao_print ( ndo , bp , length ) ; //<S2SV> } //<S2SV> break ; //<S2SV> case ND_RPL_DAO_ACK : //<S2SV> ND_PRINT ( ( ndo , "Destination<S2SV_blank>Advertisement<S2SV_blank>Object<S2SV_blank>Ack" ) ) ; //<S2SV> if ( ndo -> ndo_vflag ) { //<S2SV> rpl_daoack_print ( ndo , bp , length ) ; //<S2SV> } //<S2SV> break ; //<S2SV> default : //<S2SV> ND_PRINT ( ( ndo , "RPL<S2SV_blank>message,<S2SV_blank>unknown<S2SV_blank>code<S2SV_blank>%u" , hdr -> icmp6_code ) ) ; //<S2SV> break ; //<S2SV> } //<S2SV> return ; //<S2SV> # if 0 //<S2SV> trunc : //<S2SV> ND_PRINT ( ( ndo , "%s" , rpl_tstr ) ) ; //<S2SV> return ; //<S2SV> # endif //<S2SV> } //<S2SV> 