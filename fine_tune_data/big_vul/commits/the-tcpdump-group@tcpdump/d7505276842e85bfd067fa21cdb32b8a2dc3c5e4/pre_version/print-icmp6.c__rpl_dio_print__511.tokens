static void //<S2SV> rpl_dio_print ( netdissect_options * ndo , //<S2SV> const u_char * bp , u_int length ) //<S2SV> { //<S2SV> const struct nd_rpl_dio * dio = ( const struct nd_rpl_dio * ) bp ; //<S2SV> const char * dagid_str ; //<S2SV> ND_TCHECK ( * dio ) ; //<S2SV> dagid_str = ip6addr_string ( ndo , dio -> rpl_dagid ) ; //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>[dagid:%s,seq:%u,instance:%u,rank:%u,%smop:%s,prf:%u]" , //<S2SV> dagid_str , //<S2SV> dio -> rpl_dtsn , //<S2SV> dio -> rpl_instanceid , //<S2SV> EXTRACT_16BITS ( & dio -> rpl_dagrank ) , //<S2SV> RPL_DIO_GROUNDED ( dio -> rpl_mopprf ) ? "grounded," : "" , //<S2SV> tok2str ( rpl_mop_values , "mop%u" , RPL_DIO_MOP ( dio -> rpl_mopprf ) ) , //<S2SV> RPL_DIO_PRF ( dio -> rpl_mopprf ) ) ) ; //<S2SV> if ( ndo -> ndo_vflag > 1 ) { //<S2SV> const struct rpl_dio_genoption * opt = ( const struct rpl_dio_genoption * ) & dio [ 1 ] ; //<S2SV> rpl_dio_printopt ( ndo , opt , length ) ; //<S2SV> } //<S2SV> return ; //<S2SV> trunc : //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>[|truncated]" ) ) ; //<S2SV> return ; //<S2SV> } //<S2SV> 