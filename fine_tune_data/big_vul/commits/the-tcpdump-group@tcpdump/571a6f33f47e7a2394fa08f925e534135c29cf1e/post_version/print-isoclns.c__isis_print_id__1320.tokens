static char * //<S2SV> isis_print_id ( const uint8_t * cp , int id_len ) //<S2SV> { //<S2SV> int i ; //<S2SV> static char id [ sizeof ( "xxxx.xxxx.xxxx.yy-zz" ) ] ; //<S2SV> char * pos = id ; //<S2SV> int sysid_len ; //<S2SV> sysid_len = SYSTEM_ID_LEN ; //<S2SV> if ( sysid_len > id_len ) //<S2SV> sysid_len = id_len ; //<S2SV> for ( i = 1 ; i <= sysid_len ; i ++ ) { //<S2SV> snprintf ( pos , sizeof ( id ) - ( pos - id ) , "%02x" , * cp ++ ) ; //<S2SV> pos += strlen ( pos ) ; //<S2SV> if ( i == 2 || i == 4 ) //<S2SV> * pos ++ = '.' ; //<S2SV> } //<S2SV> if ( id_len >= NODE_ID_LEN ) { //<S2SV> snprintf ( pos , sizeof ( id ) - ( pos - id ) , ".%02x" , * cp ++ ) ; //<S2SV> pos += strlen ( pos ) ; //<S2SV> } //<S2SV> if ( id_len == LSP_ID_LEN ) //<S2SV> snprintf ( pos , sizeof ( id ) - ( pos - id ) , "-%02x" , * cp ) ; //<S2SV> return ( id ) ; //<S2SV> } //<S2SV> 