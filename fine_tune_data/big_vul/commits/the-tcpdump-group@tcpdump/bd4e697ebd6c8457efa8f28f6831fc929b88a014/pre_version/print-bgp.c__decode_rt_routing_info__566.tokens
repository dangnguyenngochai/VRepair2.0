static int //<S2SV> decode_rt_routing_info ( netdissect_options * ndo , //<S2SV> const u_char * pptr , char * buf , u_int buflen ) //<S2SV> { //<S2SV> uint8_t route_target [ 8 ] ; //<S2SV> u_int plen ; //<S2SV> ND_TCHECK ( pptr [ 0 ] ) ; //<S2SV> plen = pptr [ 0 ] ; //<S2SV> if ( 0 == plen ) { //<S2SV> snprintf ( buf , buflen , "default<S2SV_blank>route<S2SV_blank>target" ) ; //<S2SV> return 1 ; //<S2SV> } //<S2SV> if ( 32 > plen ) //<S2SV> return - 1 ; //<S2SV> plen -= 32 ; //<S2SV> if ( 64 < plen ) //<S2SV> return - 1 ; //<S2SV> memset ( & route_target , 0 , sizeof ( route_target ) ) ; //<S2SV> ND_TCHECK2 ( pptr [ 1 ] , ( plen + 7 ) / 8 ) ; //<S2SV> memcpy ( & route_target , & pptr [ 1 ] , ( plen + 7 ) / 8 ) ; //<S2SV> if ( plen % 8 ) { //<S2SV> ( ( u_char * ) & route_target ) [ ( plen + 7 ) / 8 - 1 ] &= //<S2SV> ( ( 0xff00 >> ( plen % 8 ) ) & 0xff ) ; //<S2SV> } //<S2SV> snprintf ( buf , buflen , "origin<S2SV_blank>AS:<S2SV_blank>%s,<S2SV_blank>route<S2SV_blank>target<S2SV_blank>%s" , //<S2SV> as_printf ( ndo , astostr , sizeof ( astostr ) , EXTRACT_32BITS ( pptr + 1 ) ) , //<S2SV> bgp_vpn_rd_print ( ndo , ( u_char * ) & route_target ) ) ; //<S2SV> return 5 + ( plen + 7 ) / 8 ; //<S2SV> trunc : //<S2SV> return - 2 ; //<S2SV> } //<S2SV> 