static const u_char * //<S2SV> ikev1_nonce_print ( netdissect_options * ndo , u_char tpay _U_ , //<S2SV> const struct isakmp_gen * ext , //<S2SV> u_int item_len _U_ , //<S2SV> const u_char * ep , //<S2SV> uint32_t phase _U_ , uint32_t doi _U_ , //<S2SV> uint32_t proto _U_ , int depth _U_ ) //<S2SV> { //<S2SV> struct isakmp_gen e ; //<S2SV> ND_PRINT ( ( ndo , "%s:" , NPSTR ( ISAKMP_NPTYPE_NONCE ) ) ) ; //<S2SV> ND_TCHECK ( * ext ) ; //<S2SV> UNALIGNED_MEMCPY ( & e , ext , sizeof ( e ) ) ; //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>n<S2SV_blank>len=%d" , ntohs ( e . len ) - 4 ) ) ; //<S2SV> if ( 2 < ndo -> ndo_vflag && 4 < ntohs ( e . len ) ) { //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>" ) ) ; //<S2SV> if ( ! rawprint ( ndo , ( const uint8_t * ) ( ext + 1 ) , ntohs ( e . len ) - 4 ) ) //<S2SV> goto trunc ; //<S2SV> } else if ( 1 < ndo -> ndo_vflag && 4 < ntohs ( e . len ) ) { //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>" ) ) ; //<S2SV> if ( ! ike_show_somedata ( ndo , ( const u_char * ) ( const uint8_t * ) ( ext + 1 ) , ep ) ) //<S2SV> goto trunc ; //<S2SV> } //<S2SV> return ( const u_char * ) ext + ntohs ( e . len ) ; //<S2SV> trunc : //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>[|%s]" , NPSTR ( ISAKMP_NPTYPE_NONCE ) ) ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> 