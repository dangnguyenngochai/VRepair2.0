static int //<S2SV> name_len ( netdissect_options * ndo , //<S2SV> const unsigned char * s , const unsigned char * maxbuf ) //<S2SV> { //<S2SV> const unsigned char * s0 = s ; //<S2SV> unsigned char c ; //<S2SV> if ( s >= maxbuf ) //<S2SV> return ( - 1 ) ; //<S2SV> ND_TCHECK2 ( * s , 1 ) ; //<S2SV> c = * s ; //<S2SV> if ( ( c & 0xC0 ) == 0xC0 ) //<S2SV> return ( 2 ) ; //<S2SV> while ( * s ) { //<S2SV> if ( s >= maxbuf ) //<S2SV> return ( - 1 ) ; //<S2SV> ND_TCHECK2 ( * s , 1 ) ; //<S2SV> s += ( * s ) + 1 ; //<S2SV> } //<S2SV> return ( PTR_DIFF ( s , s0 ) + 1 ) ; //<S2SV> trunc : //<S2SV> return ( - 1 ) ; //<S2SV> } //<S2SV> 