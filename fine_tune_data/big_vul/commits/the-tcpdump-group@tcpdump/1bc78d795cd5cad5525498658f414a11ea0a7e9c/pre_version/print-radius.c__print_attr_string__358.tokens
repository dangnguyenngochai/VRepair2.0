static void //<S2SV> print_attr_string ( netdissect_options * ndo , //<S2SV> register const u_char * data , u_int length , u_short attr_code ) //<S2SV> { //<S2SV> register u_int i ; //<S2SV> ND_TCHECK2 ( data [ 0 ] , length ) ; //<S2SV> switch ( attr_code ) //<S2SV> { //<S2SV> case TUNNEL_PASS : //<S2SV> if ( length < 3 ) //<S2SV> { //<S2SV> ND_PRINT ( ( ndo , "%s" , tstr ) ) ; //<S2SV> return ; //<S2SV> } //<S2SV> if ( * data && ( * data <= 0x1F ) ) //<S2SV> ND_PRINT ( ( ndo , "Tag[%u]<S2SV_blank>" , * data ) ) ; //<S2SV> else //<S2SV> ND_PRINT ( ( ndo , "Tag[Unused]<S2SV_blank>" ) ) ; //<S2SV> data ++ ; //<S2SV> length -- ; //<S2SV> ND_PRINT ( ( ndo , "Salt<S2SV_blank>%u<S2SV_blank>" , EXTRACT_16BITS ( data ) ) ) ; //<S2SV> data += 2 ; //<S2SV> length -= 2 ; //<S2SV> break ; //<S2SV> case TUNNEL_CLIENT_END : //<S2SV> case TUNNEL_SERVER_END : //<S2SV> case TUNNEL_PRIV_GROUP : //<S2SV> case TUNNEL_ASSIGN_ID : //<S2SV> case TUNNEL_CLIENT_AUTH : //<S2SV> case TUNNEL_SERVER_AUTH : //<S2SV> if ( * data <= 0x1F ) //<S2SV> { //<S2SV> if ( length < 1 ) //<S2SV> { //<S2SV> ND_PRINT ( ( ndo , "%s" , tstr ) ) ; //<S2SV> return ; //<S2SV> } //<S2SV> if ( * data ) //<S2SV> ND_PRINT ( ( ndo , "Tag[%u]<S2SV_blank>" , * data ) ) ; //<S2SV> else //<S2SV> ND_PRINT ( ( ndo , "Tag[Unused]<S2SV_blank>" ) ) ; //<S2SV> data ++ ; //<S2SV> length -- ; //<S2SV> } //<S2SV> break ; //<S2SV> case EGRESS_VLAN_NAME : //<S2SV> ND_PRINT ( ( ndo , "%s<S2SV_blank>(0x%02x)<S2SV_blank>" , //<S2SV> tok2str ( rfc4675_tagged , "Unknown<S2SV_blank>tag" , * data ) , //<S2SV> * data ) ) ; //<S2SV> data ++ ; //<S2SV> length -- ; //<S2SV> break ; //<S2SV> } //<S2SV> for ( i = 0 ; * data && i < length ; i ++ , data ++ ) //<S2SV> ND_PRINT ( ( ndo , "%c" , ( * data < 32 || * data > 126 ) ? '.' : * data ) ) ; //<S2SV> return ; //<S2SV> trunc : //<S2SV> ND_PRINT ( ( ndo , "%s" , tstr ) ) ; //<S2SV> } //<S2SV> 