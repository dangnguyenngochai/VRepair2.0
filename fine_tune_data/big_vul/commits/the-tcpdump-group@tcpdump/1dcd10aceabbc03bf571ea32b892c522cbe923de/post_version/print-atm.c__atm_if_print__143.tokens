u_int //<S2SV> atm_if_print ( netdissect_options * ndo , //<S2SV> const struct pcap_pkthdr * h , const u_char * p ) //<S2SV> { //<S2SV> u_int caplen = h -> caplen ; //<S2SV> u_int length = h -> len ; //<S2SV> uint32_t llchdr ; //<S2SV> u_int hdrlen = 0 ; //<S2SV> if ( caplen < 1 || length < 1 ) { //<S2SV> ND_PRINT ( ( ndo , "%s" , tstr ) ) ; //<S2SV> return ( caplen ) ; //<S2SV> } //<S2SV> if ( * p == LLC_UI ) { //<S2SV> if ( ndo -> ndo_eflag ) //<S2SV> ND_PRINT ( ( ndo , "CNLPID<S2SV_blank>" ) ) ; //<S2SV> isoclns_print ( ndo , p + 1 , length - 1 ) ; //<S2SV> return hdrlen ; //<S2SV> } //<S2SV> if ( caplen < 3 || length < 3 ) { //<S2SV> ND_PRINT ( ( ndo , "%s" , tstr ) ) ; //<S2SV> return ( caplen ) ; //<S2SV> } //<S2SV> llchdr = EXTRACT_24BITS ( p ) ; //<S2SV> if ( llchdr != LLC_UI_HDR ( LLCSAP_SNAP ) && //<S2SV> llchdr != LLC_UI_HDR ( LLCSAP_ISONS ) && //<S2SV> llchdr != LLC_UI_HDR ( LLCSAP_IP ) ) { //<S2SV> if ( caplen < 20 || length < 20 ) { //<S2SV> ND_PRINT ( ( ndo , "%s" , tstr ) ) ; //<S2SV> return ( caplen ) ; //<S2SV> } //<S2SV> if ( ndo -> ndo_eflag ) //<S2SV> ND_PRINT ( ( ndo , "%08x%08x<S2SV_blank>%08x%08x<S2SV_blank>" , //<S2SV> EXTRACT_32BITS ( p ) , //<S2SV> EXTRACT_32BITS ( p + 4 ) , //<S2SV> EXTRACT_32BITS ( p + 8 ) , //<S2SV> EXTRACT_32BITS ( p + 12 ) ) ) ; //<S2SV> p += 20 ; //<S2SV> length -= 20 ; //<S2SV> caplen -= 20 ; //<S2SV> hdrlen += 20 ; //<S2SV> } //<S2SV> hdrlen += atm_llc_print ( ndo , p , length , caplen ) ; //<S2SV> return ( hdrlen ) ; //<S2SV> } //<S2SV> 