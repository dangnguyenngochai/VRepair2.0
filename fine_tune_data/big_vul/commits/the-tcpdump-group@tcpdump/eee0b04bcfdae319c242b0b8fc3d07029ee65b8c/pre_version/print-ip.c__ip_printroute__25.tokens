static void //<S2SV> ip_printroute ( netdissect_options * ndo , //<S2SV> register const u_char * cp , u_int length ) //<S2SV> { //<S2SV> register u_int ptr ; //<S2SV> register u_int len ; //<S2SV> if ( length < 3 ) { //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>[bad<S2SV_blank>length<S2SV_blank>%u]" , length ) ) ; //<S2SV> return ; //<S2SV> } //<S2SV> if ( ( length + 1 ) & 3 ) //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>[bad<S2SV_blank>length<S2SV_blank>%u]" , length ) ) ; //<S2SV> ptr = cp [ 2 ] - 1 ; //<S2SV> if ( ptr < 3 || ( ( ptr + 1 ) & 3 ) || ptr > length + 1 ) //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>[bad<S2SV_blank>ptr<S2SV_blank>%u]" , cp [ 2 ] ) ) ; //<S2SV> for ( len = 3 ; len < length ; len += 4 ) { //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>%s" , ipaddr_string ( ndo , & cp [ len ] ) ) ) ; //<S2SV> if ( ptr > len ) //<S2SV> ND_PRINT ( ( ndo , "," ) ) ; //<S2SV> } //<S2SV> } //<S2SV> 