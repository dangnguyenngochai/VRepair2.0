void //<S2SV> wb_print ( netdissect_options * ndo , //<S2SV> register const void * hdr , register u_int len ) //<S2SV> { //<S2SV> register const struct pkt_hdr * ph ; //<S2SV> ph = ( const struct pkt_hdr * ) hdr ; //<S2SV> if ( len < sizeof ( * ph ) || ! ND_TTEST ( * ph ) ) { //<S2SV> ND_PRINT ( ( ndo , "%s" , tstr ) ) ; //<S2SV> return ; //<S2SV> } //<S2SV> len -= sizeof ( * ph ) ; //<S2SV> if ( ph -> ph_flags ) //<S2SV> ND_PRINT ( ( ndo , "*" ) ) ; //<S2SV> switch ( ph -> ph_type ) { //<S2SV> case PT_KILL : //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>wb-kill" ) ) ; //<S2SV> return ; //<S2SV> case PT_ID : //<S2SV> if ( wb_id ( ndo , ( const struct pkt_id * ) ( ph + 1 ) , len ) >= 0 ) //<S2SV> return ; //<S2SV> break ; //<S2SV> case PT_RREQ : //<S2SV> if ( wb_rreq ( ndo , ( const struct pkt_rreq * ) ( ph + 1 ) , len ) >= 0 ) //<S2SV> return ; //<S2SV> break ; //<S2SV> case PT_RREP : //<S2SV> if ( wb_rrep ( ndo , ( const struct pkt_rrep * ) ( ph + 1 ) , len ) >= 0 ) //<S2SV> return ; //<S2SV> break ; //<S2SV> case PT_DRAWOP : //<S2SV> if ( wb_drawop ( ndo , ( const struct pkt_dop * ) ( ph + 1 ) , len ) >= 0 ) //<S2SV> return ; //<S2SV> break ; //<S2SV> case PT_PREQ : //<S2SV> if ( wb_preq ( ndo , ( const struct pkt_preq * ) ( ph + 1 ) , len ) >= 0 ) //<S2SV> return ; //<S2SV> break ; //<S2SV> case PT_PREP : //<S2SV> if ( wb_prep ( ndo , ( const struct pkt_prep * ) ( ph + 1 ) , len ) >= 0 ) //<S2SV> return ; //<S2SV> break ; //<S2SV> default : //<S2SV> ND_PRINT ( ( ndo , "<S2SV_blank>wb-%d!" , ph -> ph_type ) ) ; //<S2SV> return ; //<S2SV> } //<S2SV> } //<S2SV> 