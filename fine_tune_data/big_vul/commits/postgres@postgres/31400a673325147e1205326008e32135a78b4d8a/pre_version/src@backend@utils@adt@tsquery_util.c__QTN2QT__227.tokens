TSQuery //<S2SV> QTN2QT ( QTNode * in ) //<S2SV> { //<S2SV> TSQuery out ; //<S2SV> int len ; //<S2SV> int sumlen = 0 , //<S2SV> nnode = 0 ; //<S2SV> QTN2QTState state ; //<S2SV> cntsize ( in , & sumlen , & nnode ) ; //<S2SV> len = COMPUTESIZE ( nnode , sumlen ) ; //<S2SV> out = ( TSQuery ) palloc0 ( len ) ; //<S2SV> SET_VARSIZE ( out , len ) ; //<S2SV> out -> size = nnode ; //<S2SV> state . curitem = GETQUERY ( out ) ; //<S2SV> state . operand = state . curoperand = GETOPERAND ( out ) ; //<S2SV> fillQT ( & state , in ) ; //<S2SV> return out ; //<S2SV> } //<S2SV> 