EXPORTED const char * dlist_reserve_path ( const char * part , int isarchive , //<S2SV> const struct message_guid * guid ) //<S2SV> { //<S2SV> static char buf [ MAX_MAILBOX_PATH ] ; //<S2SV> const char * base ; //<S2SV> if ( strchr ( part , '/' ) ) { //<S2SV> base = part ; //<S2SV> } //<S2SV> else { //<S2SV> base = isarchive ? config_archivepartitiondir ( part ) //<S2SV> : config_partitiondir ( part ) ; //<S2SV> } //<S2SV> assert ( base != NULL ) ; //<S2SV> snprintf ( buf , MAX_MAILBOX_PATH , "%s/sync./%lu/%s" , //<S2SV> base , ( unsigned long ) getpid ( ) , //<S2SV> message_guid_encode ( guid ) ) ; //<S2SV> if ( cyrus_mkdir ( buf , 0755 ) ) { //<S2SV> syslog ( LOG_ERR , "IOERROR:<S2SV_blank>failed<S2SV_blank>to<S2SV_blank>create<S2SV_blank>%s/sync./%lu/<S2SV_blank>for<S2SV_blank>reserve:<S2SV_blank>%m" , //<S2SV> base , ( unsigned long ) getpid ( ) ) ; //<S2SV> } //<S2SV> return buf ; //<S2SV> } //<S2SV> 