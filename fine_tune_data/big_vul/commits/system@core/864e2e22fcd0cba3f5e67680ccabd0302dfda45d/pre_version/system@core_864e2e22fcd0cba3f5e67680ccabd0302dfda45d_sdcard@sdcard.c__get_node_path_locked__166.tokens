static ssize_t get_node_path_locked ( struct node * node , char * buf , size_t bufsize ) { //<S2SV> const char * name ; //<S2SV> size_t namelen ; //<S2SV> if ( node -> graft_path ) { //<S2SV> name = node -> graft_path ; //<S2SV> namelen = node -> graft_pathlen ; //<S2SV> } else if ( node -> actual_name ) { //<S2SV> name = node -> actual_name ; //<S2SV> namelen = node -> namelen ; //<S2SV> } else { //<S2SV> name = node -> name ; //<S2SV> namelen = node -> namelen ; //<S2SV> } //<S2SV> if ( bufsize < namelen + 1 ) { //<S2SV> return - 1 ; //<S2SV> } //<S2SV> ssize_t pathlen = 0 ; //<S2SV> if ( node -> parent && node -> graft_path == NULL ) { //<S2SV> pathlen = get_node_path_locked ( node -> parent , buf , bufsize - namelen - 2 ) ; //<S2SV> if ( pathlen < 0 ) { //<S2SV> return - 1 ; //<S2SV> } //<S2SV> buf [ pathlen ++ ] = '/' ; //<S2SV> } //<S2SV> memcpy ( buf + pathlen , name , namelen + 1 ) ; //<S2SV> return pathlen + namelen ; //<S2SV> } //<S2SV> 