int dns_packet_is_reply_for ( DnsPacket * p , const DnsResourceKey * key ) { //<S2SV> int r ; //<S2SV> assert ( p ) ; //<S2SV> assert ( key ) ; //<S2SV> if ( DNS_PACKET_QR ( p ) != 1 ) //<S2SV> return 0 ; //<S2SV> r = dns_packet_extract ( p ) ; //<S2SV> if ( r < 0 ) //<S2SV> return r ; //<S2SV> if ( ! p -> question ) //<S2SV> return 0 ; //<S2SV> if ( p -> question -> n_keys != 1 ) //<S2SV> return 0 ; //<S2SV> return dns_resource_key_equal ( p -> question -> keys [ 0 ] , key ) ; //<S2SV> } //<S2SV> 