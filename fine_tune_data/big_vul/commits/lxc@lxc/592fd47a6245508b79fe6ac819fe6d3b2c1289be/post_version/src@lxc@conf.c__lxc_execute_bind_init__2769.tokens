void lxc_execute_bind_init ( struct lxc_conf * conf ) //<S2SV> { //<S2SV> int ret ; //<S2SV> char path [ PATH_MAX ] , destpath [ PATH_MAX ] , * p ; //<S2SV> p = choose_init ( conf -> rootfs . mount ) ; //<S2SV> if ( p ) { //<S2SV> free ( p ) ; //<S2SV> return ; //<S2SV> } //<S2SV> ret = snprintf ( path , PATH_MAX , SBINDIR "/init.lxc.static" ) ; //<S2SV> if ( ret < 0 || ret >= PATH_MAX ) { //<S2SV> WARN ( "Path<S2SV_blank>name<S2SV_blank>too<S2SV_blank>long<S2SV_blank>searching<S2SV_blank>for<S2SV_blank>lxc.init.static" ) ; //<S2SV> return ; //<S2SV> } //<S2SV> if ( ! file_exists ( path ) ) { //<S2SV> INFO ( "%s<S2SV_blank>does<S2SV_blank>not<S2SV_blank>exist<S2SV_blank>on<S2SV_blank>host" , path ) ; //<S2SV> return ; //<S2SV> } //<S2SV> ret = snprintf ( destpath , PATH_MAX , "%s%s" , conf -> rootfs . mount , "/init.lxc.static" ) ; //<S2SV> if ( ret < 0 || ret >= PATH_MAX ) { //<S2SV> WARN ( "Path<S2SV_blank>name<S2SV_blank>too<S2SV_blank>long<S2SV_blank>for<S2SV_blank>container\'s<S2SV_blank>lxc.init.static" ) ; //<S2SV> return ; //<S2SV> } //<S2SV> if ( ! file_exists ( destpath ) ) { //<S2SV> FILE * pathfile = fopen ( destpath , "wb" ) ; //<S2SV> if ( ! pathfile ) { //<S2SV> SYSERROR ( "Failed<S2SV_blank>to<S2SV_blank>create<S2SV_blank>mount<S2SV_blank>target<S2SV_blank>\'%s\'" , destpath ) ; //<S2SV> return ; //<S2SV> } //<S2SV> fclose ( pathfile ) ; //<S2SV> } //<S2SV> ret = safe_mount ( path , destpath , "none" , MS_BIND , NULL , conf -> rootfs . mount ) ; //<S2SV> if ( ret < 0 ) //<S2SV> SYSERROR ( "Failed<S2SV_blank>to<S2SV_blank>bind<S2SV_blank>lxc.init.static<S2SV_blank>into<S2SV_blank>container" ) ; //<S2SV> INFO ( "lxc.init.static<S2SV_blank>bound<S2SV_blank>into<S2SV_blank>container<S2SV_blank>at<S2SV_blank>%s" , path ) ; //<S2SV> } //<S2SV> 