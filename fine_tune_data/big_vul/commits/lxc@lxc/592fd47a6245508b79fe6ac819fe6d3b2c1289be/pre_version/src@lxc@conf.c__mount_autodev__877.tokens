static int mount_autodev ( const char * name , const struct lxc_rootfs * rootfs , const char * lxcpath ) //<S2SV> { //<S2SV> int ret ; //<S2SV> size_t clen ; //<S2SV> char * path ; //<S2SV> INFO ( "Mounting<S2SV_blank>container<S2SV_blank>/dev" ) ; //<S2SV> clen = ( rootfs -> path ? strlen ( rootfs -> mount ) : 0 ) + 9 ; //<S2SV> path = alloca ( clen ) ; //<S2SV> ret = snprintf ( path , clen , "%s/dev" , rootfs -> path ? rootfs -> mount : "" ) ; //<S2SV> if ( ret < 0 || ret >= clen ) //<S2SV> return - 1 ; //<S2SV> if ( ! dir_exists ( path ) ) { //<S2SV> WARN ( "No<S2SV_blank>/dev<S2SV_blank>in<S2SV_blank>container." ) ; //<S2SV> WARN ( "Proceeding<S2SV_blank>without<S2SV_blank>autodev<S2SV_blank>setup" ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> if ( mount ( "none" , path , "tmpfs" , 0 , "size=100000,mode=755" ) ) { //<S2SV> SYSERROR ( "Failed<S2SV_blank>mounting<S2SV_blank>tmpfs<S2SV_blank>onto<S2SV_blank>%s\\n" , path ) ; //<S2SV> return false ; //<S2SV> } //<S2SV> INFO ( "Mounted<S2SV_blank>tmpfs<S2SV_blank>onto<S2SV_blank>%s" , path ) ; //<S2SV> ret = snprintf ( path , clen , "%s/dev/pts" , rootfs -> path ? rootfs -> mount : "" ) ; //<S2SV> if ( ret < 0 || ret >= clen ) //<S2SV> return - 1 ; //<S2SV> if ( ! dir_exists ( path ) ) { //<S2SV> ret = mkdir ( path , S_IRWXU | S_IRGRP | S_IXGRP | S_IROTH | S_IXOTH ) ; //<S2SV> if ( ret ) { //<S2SV> SYSERROR ( "Failed<S2SV_blank>to<S2SV_blank>create<S2SV_blank>/dev/pts<S2SV_blank>in<S2SV_blank>container" ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> } //<S2SV> INFO ( "Mounted<S2SV_blank>container<S2SV_blank>/dev" ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 