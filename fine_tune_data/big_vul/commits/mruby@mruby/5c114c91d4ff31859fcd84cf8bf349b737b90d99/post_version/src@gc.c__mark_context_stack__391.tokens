static void //<S2SV> mark_context_stack ( mrb_state * mrb , struct mrb_context * c ) //<S2SV> { //<S2SV> size_t i ; //<S2SV> size_t e ; //<S2SV> mrb_value nil ; //<S2SV> if ( c -> stack == NULL ) return ; //<S2SV> e = c -> stack - c -> stbase ; //<S2SV> if ( c -> ci ) e += c -> ci -> nregs ; //<S2SV> if ( c -> stbase + e > c -> stend ) e = c -> stend - c -> stbase ; //<S2SV> for ( i = 0 ; i < e ; i ++ ) { //<S2SV> mrb_value v = c -> stbase [ i ] ; //<S2SV> if ( ! mrb_immediate_p ( v ) ) { //<S2SV> mrb_gc_mark ( mrb , mrb_basic_ptr ( v ) ) ; //<S2SV> } //<S2SV> } //<S2SV> e = c -> stend - c -> stbase ; //<S2SV> nil = mrb_nil_value ( ) ; //<S2SV> for ( ; i < e ; i ++ ) { //<S2SV> c -> stbase [ i ] = nil ; //<S2SV> } //<S2SV> } //<S2SV> 