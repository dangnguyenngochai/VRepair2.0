static void Sp_search ( js_State * J ) //<S2SV> { //<S2SV> js_Regexp * re ; //<S2SV> const char * text ; //<S2SV> Resub m ; //<S2SV> text = checkstring ( J , 0 ) ; //<S2SV> if ( js_isregexp ( J , 1 ) ) //<S2SV> js_copy ( J , 1 ) ; //<S2SV> else if ( js_isundefined ( J , 1 ) ) //<S2SV> js_newregexp ( J , "" , 0 ) ; //<S2SV> else //<S2SV> js_newregexp ( J , js_tostring ( J , 1 ) , 0 ) ; //<S2SV> re = js_toregexp ( J , - 1 ) ; //<S2SV> if ( ! js_doregexec ( J , re -> prog , text , & m , 0 ) ) //<S2SV> js_pushnumber ( J , js_utfptrtoidx ( text , m . sub [ 0 ] . sp ) ) ; //<S2SV> else //<S2SV> js_pushnumber ( J , - 1 ) ; //<S2SV> } //<S2SV> 