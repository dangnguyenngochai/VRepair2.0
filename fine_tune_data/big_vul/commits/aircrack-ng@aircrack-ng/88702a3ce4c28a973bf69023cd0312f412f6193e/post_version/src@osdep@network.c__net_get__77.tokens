int net_get ( int s , void * arg , int * len ) //<S2SV> { //<S2SV> struct net_hdr nh ; //<S2SV> int plen ; //<S2SV> if ( net_read_exact ( s , & nh , sizeof ( nh ) ) == - 1 ) //<S2SV> { //<S2SV> return - 1 ; //<S2SV> } //<S2SV> plen = ntohl ( nh . nh_len ) ; //<S2SV> if ( ! ( plen <= * len ) ) //<S2SV> printf ( "PLEN<S2SV_blank>%d<S2SV_blank>type<S2SV_blank>%d<S2SV_blank>len<S2SV_blank>%d\\n" , //<S2SV> plen , nh . nh_type , * len ) ; //<S2SV> assert ( plen <= * len && plen > 0 ) ; //<S2SV> * len = plen ; //<S2SV> if ( ( * len ) && ( net_read_exact ( s , arg , * len ) == - 1 ) ) //<S2SV> { //<S2SV> return - 1 ; //<S2SV> } //<S2SV> return nh . nh_type ; //<S2SV> } //<S2SV> 