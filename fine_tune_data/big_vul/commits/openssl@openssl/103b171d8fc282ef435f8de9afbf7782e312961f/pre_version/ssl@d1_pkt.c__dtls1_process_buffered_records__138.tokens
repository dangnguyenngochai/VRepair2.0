static int //<S2SV> dtls1_process_buffered_records ( SSL * s ) //<S2SV> { //<S2SV> pitem * item ; //<S2SV> item = pqueue_peek ( s -> d1 -> unprocessed_rcds . q ) ; //<S2SV> if ( item ) //<S2SV> { //<S2SV> if ( s -> d1 -> unprocessed_rcds . epoch != s -> d1 -> r_epoch ) //<S2SV> return ( 1 ) ; //<S2SV> while ( pqueue_peek ( s -> d1 -> unprocessed_rcds . q ) ) //<S2SV> { //<S2SV> dtls1_get_unprocessed_record ( s ) ; //<S2SV> if ( ! dtls1_process_record ( s ) ) //<S2SV> return ( 0 ) ; //<S2SV> dtls1_buffer_record ( s , & ( s -> d1 -> processed_rcds ) , //<S2SV> s -> s3 -> rrec . seq_num ) ; //<S2SV> } //<S2SV> } //<S2SV> s -> d1 -> processed_rcds . epoch = s -> d1 -> r_epoch ; //<S2SV> s -> d1 -> unprocessed_rcds . epoch = s -> d1 -> r_epoch + 1 ; //<S2SV> return ( 1 ) ; //<S2SV> } //<S2SV> 