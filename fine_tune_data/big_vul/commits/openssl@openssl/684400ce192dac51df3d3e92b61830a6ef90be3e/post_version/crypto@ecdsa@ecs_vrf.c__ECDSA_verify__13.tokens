int ECDSA_verify ( int type , const unsigned char * dgst , int dgst_len , //<S2SV> const unsigned char * sigbuf , int sig_len , EC_KEY * eckey ) //<S2SV> { //<S2SV> ECDSA_SIG * s ; //<S2SV> const unsigned char * p = sigbuf ; //<S2SV> unsigned char * der = NULL ; //<S2SV> int derlen = - 1 ; //<S2SV> int ret = - 1 ; //<S2SV> s = ECDSA_SIG_new ( ) ; //<S2SV> if ( s == NULL ) return ( ret ) ; //<S2SV> if ( d2i_ECDSA_SIG ( & s , & p , sig_len ) == NULL ) goto err ; //<S2SV> derlen = i2d_ECDSA_SIG ( s , & der ) ; //<S2SV> if ( derlen != sig_len || memcmp ( sigbuf , der , derlen ) ) //<S2SV> goto err ; //<S2SV> ret = ECDSA_do_verify ( dgst , dgst_len , s , eckey ) ; //<S2SV> err : //<S2SV> if ( derlen > 0 ) //<S2SV> { //<S2SV> OPENSSL_cleanse ( der , derlen ) ; //<S2SV> OPENSSL_free ( der ) ; //<S2SV> } //<S2SV> ECDSA_SIG_free ( s ) ; //<S2SV> return ( ret ) ; //<S2SV> } //<S2SV> 