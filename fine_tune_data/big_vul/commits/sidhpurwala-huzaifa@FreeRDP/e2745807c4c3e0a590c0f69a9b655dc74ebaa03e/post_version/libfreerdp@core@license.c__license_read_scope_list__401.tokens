BOOL license_read_scope_list ( wStream * s , SCOPE_LIST * scopeList ) //<S2SV> { //<S2SV> UINT32 i ; //<S2SV> UINT32 scopeCount ; //<S2SV> if ( Stream_GetRemainingLength ( s ) < 4 ) //<S2SV> return FALSE ; //<S2SV> Stream_Read_UINT32 ( s , scopeCount ) ; //<S2SV> if ( Stream_GetRemainingLength ( s ) / sizeof ( LICENSE_BLOB ) < scopeCount ) //<S2SV> return FALSE ; //<S2SV> scopeList -> count = scopeCount ; //<S2SV> scopeList -> array = ( LICENSE_BLOB * ) malloc ( sizeof ( LICENSE_BLOB ) * scopeCount ) ; //<S2SV> for ( i = 0 ; i < scopeCount ; i ++ ) //<S2SV> { //<S2SV> scopeList -> array [ i ] . type = BB_SCOPE_BLOB ; //<S2SV> if ( ! license_read_binary_blob ( s , & scopeList -> array [ i ] ) ) //<S2SV> return FALSE ; //<S2SV> } //<S2SV> return TRUE ; //<S2SV> } //<S2SV> 