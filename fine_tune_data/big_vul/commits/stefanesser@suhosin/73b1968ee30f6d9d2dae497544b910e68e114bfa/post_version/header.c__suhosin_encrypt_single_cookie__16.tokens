char * suhosin_encrypt_single_cookie ( char * name , int name_len , char * value , int value_len , char * key TSRMLS_DC ) //<S2SV> { //<S2SV> char * buf , * buf2 , * d , * d_url ; //<S2SV> int l ; //<S2SV> buf = estrndup ( name , name_len ) ; //<S2SV> name_len = php_url_decode ( buf , name_len ) ; //<S2SV> normalize_varname ( buf ) ; //<S2SV> name_len = strlen ( buf ) ; //<S2SV> if ( SUHOSIN_G ( cookie_plainlist ) ) { //<S2SV> if ( zend_hash_exists ( SUHOSIN_G ( cookie_plainlist ) , buf , name_len + 1 ) ) { //<S2SV> encrypt_return_plain : //<S2SV> efree ( buf ) ; //<S2SV> return estrndup ( value , value_len ) ; //<S2SV> } //<S2SV> } else if ( SUHOSIN_G ( cookie_cryptlist ) ) { //<S2SV> if ( ! zend_hash_exists ( SUHOSIN_G ( cookie_cryptlist ) , buf , name_len + 1 ) ) { //<S2SV> goto encrypt_return_plain ; //<S2SV> } //<S2SV> } //<S2SV> buf2 = estrndup ( value , value_len ) ; //<S2SV> value_len = php_url_decode ( buf2 , value_len ) ; //<S2SV> d = suhosin_encrypt_string ( buf2 , value_len , buf , name_len , key TSRMLS_CC ) ; //<S2SV> d_url = php_url_encode ( d , strlen ( d ) , & l ) ; //<S2SV> efree ( d ) ; //<S2SV> efree ( buf ) ; //<S2SV> efree ( buf2 ) ; //<S2SV> return d_url ; //<S2SV> } //<S2SV> 