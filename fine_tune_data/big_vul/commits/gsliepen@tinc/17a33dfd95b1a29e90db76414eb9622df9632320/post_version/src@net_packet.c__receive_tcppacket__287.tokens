void receive_tcppacket ( connection_t * c , const char * buffer , int len ) { //<S2SV> vpn_packet_t outpkt ; //<S2SV> if ( len > sizeof outpkt . data ) //<S2SV> return ; //<S2SV> outpkt . len = len ; //<S2SV> if ( c -> options & OPTION_TCPONLY ) //<S2SV> outpkt . priority = 0 ; //<S2SV> else //<S2SV> outpkt . priority = - 1 ; //<S2SV> memcpy ( outpkt . data , buffer , len ) ; //<S2SV> receive_packet ( c -> node , & outpkt ) ; //<S2SV> } //<S2SV> 