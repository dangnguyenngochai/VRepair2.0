static int handle_emulation_failure ( struct kvm_vcpu * vcpu ) //<S2SV> { //<S2SV> int r = EMULATE_DONE ; //<S2SV> ++ vcpu -> stat . insn_emulation_fail ; //<S2SV> trace_kvm_emulate_insn_failed ( vcpu ) ; //<S2SV> if ( ! is_guest_mode ( vcpu ) && kvm_x86_ops -> get_cpl ( vcpu ) == 0 ) { //<S2SV> vcpu -> run -> exit_reason = KVM_EXIT_INTERNAL_ERROR ; //<S2SV> vcpu -> run -> internal . suberror = KVM_INTERNAL_ERROR_EMULATION ; //<S2SV> vcpu -> run -> internal . ndata = 0 ; //<S2SV> r = EMULATE_FAIL ; //<S2SV> } //<S2SV> kvm_queue_exception ( vcpu , UD_VECTOR ) ; //<S2SV> return r ; //<S2SV> } //<S2SV> 