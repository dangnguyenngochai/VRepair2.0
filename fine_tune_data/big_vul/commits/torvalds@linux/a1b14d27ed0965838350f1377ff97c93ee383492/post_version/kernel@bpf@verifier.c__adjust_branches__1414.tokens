static void adjust_branches ( struct bpf_prog * prog , int pos , int delta ) //<S2SV> { //<S2SV> struct bpf_insn * insn = prog -> insnsi ; //<S2SV> int insn_cnt = prog -> len ; //<S2SV> int i ; //<S2SV> for ( i = 0 ; i < insn_cnt ; i ++ , insn ++ ) { //<S2SV> if ( BPF_CLASS ( insn -> code ) != BPF_JMP || //<S2SV> BPF_OP ( insn -> code ) == BPF_CALL || //<S2SV> BPF_OP ( insn -> code ) == BPF_EXIT ) //<S2SV> continue ; //<S2SV> if ( i < pos && i + insn -> off + 1 > pos ) //<S2SV> insn -> off += delta ; //<S2SV> else if ( i > pos + delta && i + insn -> off + 1 <= pos + delta ) //<S2SV> insn -> off -= delta ; //<S2SV> } //<S2SV> } //<S2SV> 