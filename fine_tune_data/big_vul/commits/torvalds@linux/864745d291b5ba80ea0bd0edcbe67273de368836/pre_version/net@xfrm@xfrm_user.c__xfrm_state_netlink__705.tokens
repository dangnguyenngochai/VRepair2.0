static struct sk_buff * xfrm_state_netlink ( struct sk_buff * in_skb , //<S2SV> struct xfrm_state * x , u32 seq ) //<S2SV> { //<S2SV> struct xfrm_dump_info info ; //<S2SV> struct sk_buff * skb ; //<S2SV> skb = nlmsg_new ( NLMSG_DEFAULT_SIZE , GFP_ATOMIC ) ; //<S2SV> if ( ! skb ) //<S2SV> return ERR_PTR ( - ENOMEM ) ; //<S2SV> info . in_skb = in_skb ; //<S2SV> info . out_skb = skb ; //<S2SV> info . nlmsg_seq = seq ; //<S2SV> info . nlmsg_flags = 0 ; //<S2SV> if ( dump_one_state ( x , 0 , & info ) ) { //<S2SV> kfree_skb ( skb ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> return skb ; //<S2SV> } //<S2SV> 