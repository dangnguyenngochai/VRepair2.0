static void vmx_refresh_apicv_exec_ctrl ( struct kvm_vcpu * vcpu ) //<S2SV> { //<S2SV> struct vcpu_vmx * vmx = to_vmx ( vcpu ) ; //<S2SV> vmcs_write32 ( PIN_BASED_VM_EXEC_CONTROL , vmx_pin_based_exec_ctrl ( vmx ) ) ; //<S2SV> if ( cpu_has_secondary_exec_ctrls ( ) ) { //<S2SV> if ( kvm_vcpu_apicv_active ( vcpu ) ) //<S2SV> vmcs_set_bits ( SECONDARY_VM_EXEC_CONTROL , //<S2SV> SECONDARY_EXEC_APIC_REGISTER_VIRT | //<S2SV> SECONDARY_EXEC_VIRTUAL_INTR_DELIVERY ) ; //<S2SV> else //<S2SV> vmcs_clear_bits ( SECONDARY_VM_EXEC_CONTROL , //<S2SV> SECONDARY_EXEC_APIC_REGISTER_VIRT | //<S2SV> SECONDARY_EXEC_VIRTUAL_INTR_DELIVERY ) ; //<S2SV> } //<S2SV> if ( cpu_has_vmx_msr_bitmap ( ) ) //<S2SV> vmx_set_msr_bitmap ( vcpu ) ; //<S2SV> } //<S2SV> 