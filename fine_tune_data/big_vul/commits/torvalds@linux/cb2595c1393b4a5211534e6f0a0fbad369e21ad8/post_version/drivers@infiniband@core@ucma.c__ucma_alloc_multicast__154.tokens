static struct ucma_multicast * ucma_alloc_multicast ( struct ucma_context * ctx ) //<S2SV> { //<S2SV> struct ucma_multicast * mc ; //<S2SV> mc = kzalloc ( sizeof ( * mc ) , GFP_KERNEL ) ; //<S2SV> if ( ! mc ) //<S2SV> return NULL ; //<S2SV> mutex_lock ( & mut ) ; //<S2SV> mc -> id = idr_alloc ( & multicast_idr , NULL , 0 , 0 , GFP_KERNEL ) ; //<S2SV> mutex_unlock ( & mut ) ; //<S2SV> if ( mc -> id < 0 ) //<S2SV> goto error ; //<S2SV> mc -> ctx = ctx ; //<S2SV> list_add_tail ( & mc -> list , & ctx -> mc_list ) ; //<S2SV> return mc ; //<S2SV> error : //<S2SV> kfree ( mc ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> 