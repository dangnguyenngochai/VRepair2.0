static int override_release ( char __user * release , size_t len ) //<S2SV> { //<S2SV> int ret = 0 ; //<S2SV> if ( current -> personality & UNAME26 ) { //<S2SV> const char * rest = UTS_RELEASE ; //<S2SV> char buf [ 65 ] = { 0 } ; //<S2SV> int ndots = 0 ; //<S2SV> unsigned v ; //<S2SV> size_t copy ; //<S2SV> while ( * rest ) { //<S2SV> if ( * rest == '.' && ++ ndots >= 3 ) //<S2SV> break ; //<S2SV> if ( ! isdigit ( * rest ) && * rest != '.' ) //<S2SV> break ; //<S2SV> rest ++ ; //<S2SV> } //<S2SV> v = ( ( LINUX_VERSION_CODE >> 8 ) & 0xff ) + 40 ; //<S2SV> copy = min ( sizeof ( buf ) , max_t ( size_t , 1 , len ) ) ; //<S2SV> copy = scnprintf ( buf , copy , "2.6.%u%s" , v , rest ) ; //<S2SV> ret = copy_to_user ( release , buf , copy + 1 ) ; //<S2SV> } //<S2SV> return ret ; //<S2SV> } //<S2SV> 