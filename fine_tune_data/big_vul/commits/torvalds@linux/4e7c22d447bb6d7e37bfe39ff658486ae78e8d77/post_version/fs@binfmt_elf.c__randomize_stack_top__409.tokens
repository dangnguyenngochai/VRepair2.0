static unsigned long randomize_stack_top ( unsigned long stack_top ) //<S2SV> { //<S2SV> unsigned long random_variable = 0 ; //<S2SV> if ( ( current -> flags & PF_RANDOMIZE ) && //<S2SV> ! ( current -> personality & ADDR_NO_RANDOMIZE ) ) { //<S2SV> random_variable = ( unsigned long ) get_random_int ( ) ; //<S2SV> random_variable &= STACK_RND_MASK ; //<S2SV> random_variable <<= PAGE_SHIFT ; //<S2SV> } //<S2SV> # ifdef CONFIG_STACK_GROWSUP //<S2SV> return PAGE_ALIGN ( stack_top ) + random_variable ; //<S2SV> # else //<S2SV> return PAGE_ALIGN ( stack_top ) - random_variable ; //<S2SV> # endif //<S2SV> } //<S2SV> 