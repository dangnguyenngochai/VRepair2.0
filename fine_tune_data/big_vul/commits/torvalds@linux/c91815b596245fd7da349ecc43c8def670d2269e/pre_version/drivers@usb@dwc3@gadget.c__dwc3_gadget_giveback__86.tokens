void dwc3_gadget_giveback ( struct dwc3_ep * dep , struct dwc3_request * req , //<S2SV> int status ) //<S2SV> { //<S2SV> struct dwc3 * dwc = dep -> dwc ; //<S2SV> req -> started = false ; //<S2SV> list_del ( & req -> list ) ; //<S2SV> req -> remaining = 0 ; //<S2SV> if ( req -> request . status == - EINPROGRESS ) //<S2SV> req -> request . status = status ; //<S2SV> if ( req -> trb ) //<S2SV> usb_gadget_unmap_request_by_dev ( dwc -> sysdev , //<S2SV> & req -> request , req -> direction ) ; //<S2SV> req -> trb = NULL ; //<S2SV> trace_dwc3_gadget_giveback ( req ) ; //<S2SV> spin_unlock ( & dwc -> lock ) ; //<S2SV> usb_gadget_giveback_request ( & dep -> endpoint , & req -> request ) ; //<S2SV> spin_lock ( & dwc -> lock ) ; //<S2SV> if ( dep -> number > 1 ) //<S2SV> pm_runtime_put ( dwc -> dev ) ; //<S2SV> } //<S2SV> 