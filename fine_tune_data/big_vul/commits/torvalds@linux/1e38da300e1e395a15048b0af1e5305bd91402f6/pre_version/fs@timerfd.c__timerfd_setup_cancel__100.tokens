static void timerfd_setup_cancel ( struct timerfd_ctx * ctx , int flags ) //<S2SV> { //<S2SV> if ( ( ctx -> clockid == CLOCK_REALTIME || //<S2SV> ctx -> clockid == CLOCK_REALTIME_ALARM ) && //<S2SV> ( flags & TFD_TIMER_ABSTIME ) && ( flags & TFD_TIMER_CANCEL_ON_SET ) ) { //<S2SV> if ( ! ctx -> might_cancel ) { //<S2SV> ctx -> might_cancel = true ; //<S2SV> spin_lock ( & cancel_lock ) ; //<S2SV> list_add_rcu ( & ctx -> clist , & cancel_list ) ; //<S2SV> spin_unlock ( & cancel_lock ) ; //<S2SV> } //<S2SV> } else if ( ctx -> might_cancel ) { //<S2SV> timerfd_remove_cancel ( ctx ) ; //<S2SV> } //<S2SV> } //<S2SV> 