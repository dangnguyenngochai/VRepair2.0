static void tcp_cwnd_reduction ( struct sock * sk , const int prior_unsacked , //<S2SV> int fast_rexmit , int flag ) //<S2SV> { //<S2SV> struct tcp_sock * tp = tcp_sk ( sk ) ; //<S2SV> int sndcnt = 0 ; //<S2SV> int delta = tp -> snd_ssthresh - tcp_packets_in_flight ( tp ) ; //<S2SV> int newly_acked_sacked = prior_unsacked - //<S2SV> ( tp -> packets_out - tp -> sacked_out ) ; //<S2SV> if ( newly_acked_sacked <= 0 || WARN_ON_ONCE ( ! tp -> prior_cwnd ) ) //<S2SV> return ; //<S2SV> tp -> prr_delivered += newly_acked_sacked ; //<S2SV> if ( delta < 0 ) { //<S2SV> u64 dividend = ( u64 ) tp -> snd_ssthresh * tp -> prr_delivered + //<S2SV> tp -> prior_cwnd - 1 ; //<S2SV> sndcnt = div_u64 ( dividend , tp -> prior_cwnd ) - tp -> prr_out ; //<S2SV> } else if ( ( flag & FLAG_RETRANS_DATA_ACKED ) && //<S2SV> ! ( flag & FLAG_LOST_RETRANS ) ) { //<S2SV> sndcnt = min_t ( int , delta , //<S2SV> max_t ( int , tp -> prr_delivered - tp -> prr_out , //<S2SV> newly_acked_sacked ) + 1 ) ; //<S2SV> } else { //<S2SV> sndcnt = min ( delta , newly_acked_sacked ) ; //<S2SV> } //<S2SV> sndcnt = max ( sndcnt , ( fast_rexmit ? 1 : 0 ) ) ; //<S2SV> tp -> snd_cwnd = tcp_packets_in_flight ( tp ) + sndcnt ; //<S2SV> } //<S2SV> 