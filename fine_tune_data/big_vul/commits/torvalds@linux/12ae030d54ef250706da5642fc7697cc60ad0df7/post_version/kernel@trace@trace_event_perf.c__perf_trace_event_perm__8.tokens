static int perf_trace_event_perm ( struct ftrace_event_call * tp_event , //<S2SV> struct perf_event * p_event ) //<S2SV> { //<S2SV> if ( ftrace_event_is_function ( tp_event ) && //<S2SV> perf_paranoid_tracepoint_raw ( ) && ! capable ( CAP_SYS_ADMIN ) ) //<S2SV> return - EPERM ; //<S2SV> if ( ! ( p_event -> attr . sample_type & PERF_SAMPLE_RAW ) ) //<S2SV> return 0 ; //<S2SV> if ( p_event -> attach_state == PERF_ATTACH_TASK ) { //<S2SV> if ( tp_event -> flags & TRACE_EVENT_FL_CAP_ANY ) //<S2SV> return 0 ; //<S2SV> } //<S2SV> if ( perf_paranoid_tracepoint_raw ( ) && ! capable ( CAP_SYS_ADMIN ) ) //<S2SV> return - EPERM ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 