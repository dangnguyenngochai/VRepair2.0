static struct pid * good_sigevent ( sigevent_t * event ) //<S2SV> { //<S2SV> struct task_struct * rtn = current -> group_leader ; //<S2SV> switch ( event -> sigev_notify ) { //<S2SV> case SIGEV_SIGNAL | SIGEV_THREAD_ID : //<S2SV> rtn = find_task_by_vpid ( event -> sigev_notify_thread_id ) ; //<S2SV> if ( ! rtn || ! same_thread_group ( rtn , current ) ) //<S2SV> return NULL ; //<S2SV> case SIGEV_SIGNAL : //<S2SV> case SIGEV_THREAD : //<S2SV> if ( event -> sigev_signo <= 0 || event -> sigev_signo > SIGRTMAX ) //<S2SV> return NULL ; //<S2SV> case SIGEV_NONE : //<S2SV> return task_pid ( rtn ) ; //<S2SV> default : //<S2SV> return NULL ; //<S2SV> } //<S2SV> } //<S2SV> 