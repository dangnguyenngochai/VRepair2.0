static int xfrm_alloc_replay_state_esn ( struct xfrm_replay_state_esn * * replay_esn , //<S2SV> struct xfrm_replay_state_esn * * preplay_esn , //<S2SV> struct nlattr * rta ) //<S2SV> { //<S2SV> struct xfrm_replay_state_esn * p , * pp , * up ; //<S2SV> int klen , ulen ; //<S2SV> if ( ! rta ) //<S2SV> return 0 ; //<S2SV> up = nla_data ( rta ) ; //<S2SV> klen = xfrm_replay_state_esn_len ( up ) ; //<S2SV> ulen = nla_len ( rta ) >= klen ? klen : sizeof ( * up ) ; //<S2SV> p = kzalloc ( klen , GFP_KERNEL ) ; //<S2SV> if ( ! p ) //<S2SV> return - ENOMEM ; //<S2SV> pp = kzalloc ( klen , GFP_KERNEL ) ; //<S2SV> if ( ! pp ) { //<S2SV> kfree ( p ) ; //<S2SV> return - ENOMEM ; //<S2SV> } //<S2SV> memcpy ( p , up , ulen ) ; //<S2SV> memcpy ( pp , up , ulen ) ; //<S2SV> * replay_esn = p ; //<S2SV> * preplay_esn = pp ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 