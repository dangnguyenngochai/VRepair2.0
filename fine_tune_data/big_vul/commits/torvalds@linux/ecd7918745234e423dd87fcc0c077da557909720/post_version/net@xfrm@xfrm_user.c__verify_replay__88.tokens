static inline int verify_replay ( struct xfrm_usersa_info * p , //<S2SV> struct nlattr * * attrs ) //<S2SV> { //<S2SV> struct nlattr * rt = attrs [ XFRMA_REPLAY_ESN_VAL ] ; //<S2SV> struct xfrm_replay_state_esn * rs ; //<S2SV> if ( p -> flags & XFRM_STATE_ESN ) { //<S2SV> if ( ! rt ) //<S2SV> return - EINVAL ; //<S2SV> rs = nla_data ( rt ) ; //<S2SV> if ( rs -> bmp_len > XFRMA_REPLAY_ESN_MAX / sizeof ( rs -> bmp [ 0 ] ) / 8 ) //<S2SV> return - EINVAL ; //<S2SV> if ( nla_len ( rt ) < xfrm_replay_state_esn_len ( rs ) && //<S2SV> nla_len ( rt ) != sizeof ( * rs ) ) //<S2SV> return - EINVAL ; //<S2SV> } //<S2SV> if ( ! rt ) //<S2SV> return 0 ; //<S2SV> if ( p -> id . proto != IPPROTO_ESP ) //<S2SV> return - EINVAL ; //<S2SV> if ( p -> replay_window != 0 ) //<S2SV> return - EINVAL ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 