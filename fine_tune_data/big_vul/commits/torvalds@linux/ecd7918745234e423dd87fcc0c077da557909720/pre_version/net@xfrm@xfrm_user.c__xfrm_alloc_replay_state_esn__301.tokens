static int xfrm_alloc_replay_state_esn ( struct xfrm_replay_state_esn * * replay_esn , //<S2SV> struct xfrm_replay_state_esn * * preplay_esn , //<S2SV> struct nlattr * rta ) //<S2SV> { //<S2SV> struct xfrm_replay_state_esn * p , * pp , * up ; //<S2SV> if ( ! rta ) //<S2SV> return 0 ; //<S2SV> up = nla_data ( rta ) ; //<S2SV> p = kmemdup ( up , xfrm_replay_state_esn_len ( up ) , GFP_KERNEL ) ; //<S2SV> if ( ! p ) //<S2SV> return - ENOMEM ; //<S2SV> pp = kmemdup ( up , xfrm_replay_state_esn_len ( up ) , GFP_KERNEL ) ; //<S2SV> if ( ! pp ) { //<S2SV> kfree ( p ) ; //<S2SV> return - ENOMEM ; //<S2SV> } //<S2SV> * replay_esn = p ; //<S2SV> * preplay_esn = pp ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 