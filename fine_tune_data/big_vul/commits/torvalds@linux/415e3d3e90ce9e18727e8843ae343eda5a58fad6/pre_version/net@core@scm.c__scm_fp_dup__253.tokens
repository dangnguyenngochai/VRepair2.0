struct scm_fp_list * scm_fp_dup ( struct scm_fp_list * fpl ) //<S2SV> { //<S2SV> struct scm_fp_list * new_fpl ; //<S2SV> int i ; //<S2SV> if ( ! fpl ) //<S2SV> return NULL ; //<S2SV> new_fpl = kmemdup ( fpl , offsetof ( struct scm_fp_list , fp [ fpl -> count ] ) , //<S2SV> GFP_KERNEL ) ; //<S2SV> if ( new_fpl ) { //<S2SV> for ( i = 0 ; i < fpl -> count ; i ++ ) //<S2SV> get_file ( fpl -> fp [ i ] ) ; //<S2SV> new_fpl -> max = new_fpl -> count ; //<S2SV> } //<S2SV> return new_fpl ; //<S2SV> } //<S2SV> 