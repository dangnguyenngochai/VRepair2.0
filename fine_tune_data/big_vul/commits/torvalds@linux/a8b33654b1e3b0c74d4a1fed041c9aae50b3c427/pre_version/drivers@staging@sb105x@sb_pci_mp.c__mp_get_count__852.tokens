static int mp_get_count ( struct sb_uart_state * state , struct serial_icounter_struct * icnt ) //<S2SV> { //<S2SV> struct serial_icounter_struct icount ; //<S2SV> struct sb_uart_icount cnow ; //<S2SV> struct sb_uart_port * port = state -> port ; //<S2SV> spin_lock_irq ( & port -> lock ) ; //<S2SV> memcpy ( & cnow , & port -> icount , sizeof ( struct sb_uart_icount ) ) ; //<S2SV> spin_unlock_irq ( & port -> lock ) ; //<S2SV> icount . cts = cnow . cts ; //<S2SV> icount . dsr = cnow . dsr ; //<S2SV> icount . rng = cnow . rng ; //<S2SV> icount . dcd = cnow . dcd ; //<S2SV> icount . rx = cnow . rx ; //<S2SV> icount . tx = cnow . tx ; //<S2SV> icount . frame = cnow . frame ; //<S2SV> icount . overrun = cnow . overrun ; //<S2SV> icount . parity = cnow . parity ; //<S2SV> icount . brk = cnow . brk ; //<S2SV> icount . buf_overrun = cnow . buf_overrun ; //<S2SV> return copy_to_user ( icnt , & icount , sizeof ( icount ) ) ? - EFAULT : 0 ; //<S2SV> } //<S2SV> 