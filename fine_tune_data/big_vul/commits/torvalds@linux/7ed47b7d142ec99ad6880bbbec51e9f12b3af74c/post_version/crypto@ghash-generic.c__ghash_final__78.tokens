static int ghash_final ( struct shash_desc * desc , u8 * dst ) //<S2SV> { //<S2SV> struct ghash_desc_ctx * dctx = shash_desc_ctx ( desc ) ; //<S2SV> struct ghash_ctx * ctx = crypto_shash_ctx ( desc -> tfm ) ; //<S2SV> u8 * buf = dctx -> buffer ; //<S2SV> if ( ! ctx -> gf128 ) //<S2SV> return - ENOKEY ; //<S2SV> ghash_flush ( ctx , dctx ) ; //<S2SV> memcpy ( dst , buf , GHASH_BLOCK_SIZE ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 