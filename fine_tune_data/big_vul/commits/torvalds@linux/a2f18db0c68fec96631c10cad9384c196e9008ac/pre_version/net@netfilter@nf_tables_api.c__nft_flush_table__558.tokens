static int nft_flush_table ( struct nft_ctx * ctx ) //<S2SV> { //<S2SV> int err ; //<S2SV> struct nft_chain * chain , * nc ; //<S2SV> struct nft_set * set , * ns ; //<S2SV> list_for_each_entry_safe ( chain , nc , & ctx -> table -> chains , list ) { //<S2SV> ctx -> chain = chain ; //<S2SV> err = nft_delrule_by_chain ( ctx ) ; //<S2SV> if ( err < 0 ) //<S2SV> goto out ; //<S2SV> err = nft_delchain ( ctx ) ; //<S2SV> if ( err < 0 ) //<S2SV> goto out ; //<S2SV> } //<S2SV> list_for_each_entry_safe ( set , ns , & ctx -> table -> sets , list ) { //<S2SV> if ( set -> flags & NFT_SET_ANONYMOUS && //<S2SV> ! list_empty ( & set -> bindings ) ) //<S2SV> continue ; //<S2SV> err = nft_delset ( ctx , set ) ; //<S2SV> if ( err < 0 ) //<S2SV> goto out ; //<S2SV> } //<S2SV> err = nft_deltable ( ctx ) ; //<S2SV> out : //<S2SV> return err ; //<S2SV> } //<S2SV> 