void unix_inflight ( struct file * fp ) //<S2SV> { //<S2SV> struct sock * s = unix_get_socket ( fp ) ; //<S2SV> spin_lock ( & unix_gc_lock ) ; //<S2SV> if ( s ) { //<S2SV> struct unix_sock * u = unix_sk ( s ) ; //<S2SV> if ( atomic_long_inc_return ( & u -> inflight ) == 1 ) { //<S2SV> BUG_ON ( ! list_empty ( & u -> link ) ) ; //<S2SV> list_add_tail ( & u -> link , & gc_inflight_list ) ; //<S2SV> } else { //<S2SV> BUG_ON ( list_empty ( & u -> link ) ) ; //<S2SV> } //<S2SV> unix_tot_inflight ++ ; //<S2SV> } //<S2SV> fp -> f_cred -> user -> unix_inflight ++ ; //<S2SV> spin_unlock ( & unix_gc_lock ) ; //<S2SV> } //<S2SV> 