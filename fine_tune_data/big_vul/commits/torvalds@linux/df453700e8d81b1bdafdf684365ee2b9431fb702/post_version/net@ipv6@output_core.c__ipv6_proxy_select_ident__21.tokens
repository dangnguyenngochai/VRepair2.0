__be32 ipv6_proxy_select_ident ( struct net * net , struct sk_buff * skb ) //<S2SV> { //<S2SV> struct in6_addr buf [ 2 ] ; //<S2SV> struct in6_addr * addrs ; //<S2SV> u32 id ; //<S2SV> addrs = skb_header_pointer ( skb , //<S2SV> skb_network_offset ( skb ) + //<S2SV> offsetof ( struct ipv6hdr , saddr ) , //<S2SV> sizeof ( buf ) , buf ) ; //<S2SV> if ( ! addrs ) //<S2SV> return 0 ; //<S2SV> id = __ipv6_select_ident ( net , & addrs [ 1 ] , & addrs [ 0 ] ) ; //<S2SV> return htonl ( id ) ; //<S2SV> } //<S2SV> 