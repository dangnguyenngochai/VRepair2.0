void __ip_select_ident ( struct net * net , struct iphdr * iph , int segs ) //<S2SV> { //<S2SV> static u32 ip_idents_hashrnd __read_mostly ; //<S2SV> u32 hash , id ; //<S2SV> net_get_random_once ( & ip_idents_hashrnd , sizeof ( ip_idents_hashrnd ) ) ; //<S2SV> hash = jhash_3words ( ( __force u32 ) iph -> daddr , //<S2SV> ( __force u32 ) iph -> saddr , //<S2SV> iph -> protocol ^ net_hash_mix ( net ) , //<S2SV> ip_idents_hashrnd ) ; //<S2SV> id = ip_idents_reserve ( hash , segs ) ; //<S2SV> iph -> id = htons ( id ) ; //<S2SV> } //<S2SV> 