void __detach_mounts ( struct dentry * dentry ) //<S2SV> { //<S2SV> struct mountpoint * mp ; //<S2SV> struct mount * mnt ; //<S2SV> namespace_lock ( ) ; //<S2SV> mp = lookup_mountpoint ( dentry ) ; //<S2SV> if ( ! mp ) //<S2SV> goto out_unlock ; //<S2SV> lock_mount_hash ( ) ; //<S2SV> while ( ! hlist_empty ( & mp -> m_list ) ) { //<S2SV> mnt = hlist_entry ( mp -> m_list . first , struct mount , mnt_mp_list ) ; //<S2SV> umount_tree ( mnt , 0 ) ; //<S2SV> } //<S2SV> unlock_mount_hash ( ) ; //<S2SV> put_mountpoint ( mp ) ; //<S2SV> out_unlock : //<S2SV> namespace_unlock ( ) ; //<S2SV> } //<S2SV> 