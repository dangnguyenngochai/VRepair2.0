static int copy_to_user_auth ( struct xfrm_algo_auth * auth , struct sk_buff * skb ) //<S2SV> { //<S2SV> struct xfrm_algo * algo ; //<S2SV> struct nlattr * nla ; //<S2SV> nla = nla_reserve ( skb , XFRMA_ALG_AUTH , //<S2SV> sizeof ( * algo ) + ( auth -> alg_key_len + 7 ) / 8 ) ; //<S2SV> if ( ! nla ) //<S2SV> return - EMSGSIZE ; //<S2SV> algo = nla_data ( nla ) ; //<S2SV> strncpy ( algo -> alg_name , auth -> alg_name , sizeof ( algo -> alg_name ) ) ; //<S2SV> memcpy ( algo -> alg_key , auth -> alg_key , ( auth -> alg_key_len + 7 ) / 8 ) ; //<S2SV> algo -> alg_key_len = auth -> alg_key_len ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 