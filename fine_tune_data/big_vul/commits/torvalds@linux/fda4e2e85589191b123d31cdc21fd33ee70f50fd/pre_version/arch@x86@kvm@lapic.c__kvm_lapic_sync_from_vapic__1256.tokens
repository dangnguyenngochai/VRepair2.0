void kvm_lapic_sync_from_vapic ( struct kvm_vcpu * vcpu ) //<S2SV> { //<S2SV> u32 data ; //<S2SV> void * vapic ; //<S2SV> if ( test_bit ( KVM_APIC_PV_EOI_PENDING , & vcpu -> arch . apic_attention ) ) //<S2SV> apic_sync_pv_eoi_from_guest ( vcpu , vcpu -> arch . apic ) ; //<S2SV> if ( ! test_bit ( KVM_APIC_CHECK_VAPIC , & vcpu -> arch . apic_attention ) ) //<S2SV> return ; //<S2SV> vapic = kmap_atomic ( vcpu -> arch . apic -> vapic_page ) ; //<S2SV> data = * ( u32 * ) ( vapic + offset_in_page ( vcpu -> arch . apic -> vapic_addr ) ) ; //<S2SV> kunmap_atomic ( vapic ) ; //<S2SV> apic_set_tpr ( vcpu -> arch . apic , data & 0xff ) ; //<S2SV> } //<S2SV> 