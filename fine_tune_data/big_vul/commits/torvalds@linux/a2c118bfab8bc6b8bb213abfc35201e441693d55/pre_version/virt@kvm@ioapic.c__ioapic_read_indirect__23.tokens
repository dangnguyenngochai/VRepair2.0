static unsigned long ioapic_read_indirect ( struct kvm_ioapic * ioapic , //<S2SV> unsigned long addr , //<S2SV> unsigned long length ) //<S2SV> { //<S2SV> unsigned long result = 0 ; //<S2SV> switch ( ioapic -> ioregsel ) { //<S2SV> case IOAPIC_REG_VERSION : //<S2SV> result = ( ( ( ( IOAPIC_NUM_PINS - 1 ) & 0xff ) << 16 ) //<S2SV> | ( IOAPIC_VERSION_ID & 0xff ) ) ; //<S2SV> break ; //<S2SV> case IOAPIC_REG_APIC_ID : //<S2SV> case IOAPIC_REG_ARB_ID : //<S2SV> result = ( ( ioapic -> id & 0xf ) << 24 ) ; //<S2SV> break ; //<S2SV> default : //<S2SV> { //<S2SV> u32 redir_index = ( ioapic -> ioregsel - 0x10 ) >> 1 ; //<S2SV> u64 redir_content ; //<S2SV> ASSERT ( redir_index < IOAPIC_NUM_PINS ) ; //<S2SV> redir_content = ioapic -> redirtbl [ redir_index ] . bits ; //<S2SV> result = ( ioapic -> ioregsel & 0x1 ) ? //<S2SV> ( redir_content >> 32 ) & 0xffffffff : //<S2SV> redir_content & 0xffffffff ; //<S2SV> break ; //<S2SV> } //<S2SV> } //<S2SV> return result ; //<S2SV> } //<S2SV> 