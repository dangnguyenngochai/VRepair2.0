static inline int xfrm_replay_verify_len ( struct xfrm_replay_state_esn * replay_esn , //<S2SV> struct nlattr * rp ) //<S2SV> { //<S2SV> struct xfrm_replay_state_esn * up ; //<S2SV> int ulen ; //<S2SV> if ( ! replay_esn || ! rp ) //<S2SV> return 0 ; //<S2SV> up = nla_data ( rp ) ; //<S2SV> ulen = xfrm_replay_state_esn_len ( up ) ; //<S2SV> if ( nla_len ( rp ) < ulen || xfrm_replay_state_esn_len ( replay_esn ) != ulen ) //<S2SV> return - EINVAL ; //<S2SV> if ( up -> replay_window > up -> bmp_len * sizeof ( __u32 ) * 8 ) //<S2SV> return - EINVAL ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 