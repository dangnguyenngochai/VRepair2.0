void ipv4_pktinfo_prepare ( const struct sock * sk , struct sk_buff * skb ) //<S2SV> { //<S2SV> struct in_pktinfo * pktinfo = PKTINFO_SKB_CB ( skb ) ; //<S2SV> bool prepare = ( inet_sk ( sk ) -> cmsg_flags & IP_CMSG_PKTINFO ) || //<S2SV> ipv6_sk_rxinfo ( sk ) ; //<S2SV> if ( prepare && skb_rtable ( skb ) ) { //<S2SV> if ( pktinfo -> ipi_ifindex == LOOPBACK_IFINDEX ) //<S2SV> pktinfo -> ipi_ifindex = inet_iif ( skb ) ; //<S2SV> pktinfo -> ipi_spec_dst . s_addr = fib_compute_spec_dst ( skb ) ; //<S2SV> } else { //<S2SV> pktinfo -> ipi_ifindex = 0 ; //<S2SV> pktinfo -> ipi_spec_dst . s_addr = 0 ; //<S2SV> } //<S2SV> skb_dst_drop ( skb ) ; //<S2SV> } //<S2SV> 