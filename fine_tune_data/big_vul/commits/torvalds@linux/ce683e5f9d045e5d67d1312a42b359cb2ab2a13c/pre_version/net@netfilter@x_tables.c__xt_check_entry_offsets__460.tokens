int xt_check_entry_offsets ( const void * base , //<S2SV> unsigned int target_offset , //<S2SV> unsigned int next_offset ) //<S2SV> { //<S2SV> const struct xt_entry_target * t ; //<S2SV> const char * e = base ; //<S2SV> if ( target_offset + sizeof ( * t ) > next_offset ) //<S2SV> return - EINVAL ; //<S2SV> t = ( void * ) ( e + target_offset ) ; //<S2SV> if ( t -> u . target_size < sizeof ( * t ) ) //<S2SV> return - EINVAL ; //<S2SV> if ( target_offset + t -> u . target_size > next_offset ) //<S2SV> return - EINVAL ; //<S2SV> if ( strcmp ( t -> u . user . name , XT_STANDARD_TARGET ) == 0 && //<S2SV> target_offset + sizeof ( struct xt_standard_target ) != next_offset ) //<S2SV> return - EINVAL ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 