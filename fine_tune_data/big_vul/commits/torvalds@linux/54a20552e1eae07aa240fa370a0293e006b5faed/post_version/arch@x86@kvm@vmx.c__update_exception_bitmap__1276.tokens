static void update_exception_bitmap ( struct kvm_vcpu * vcpu ) //<S2SV> { //<S2SV> u32 eb ; //<S2SV> eb = ( 1u << PF_VECTOR ) | ( 1u << UD_VECTOR ) | ( 1u << MC_VECTOR ) | //<S2SV> ( 1u << NM_VECTOR ) | ( 1u << DB_VECTOR ) | ( 1u << AC_VECTOR ) ; //<S2SV> if ( ( vcpu -> guest_debug & //<S2SV> ( KVM_GUESTDBG_ENABLE | KVM_GUESTDBG_USE_SW_BP ) ) == //<S2SV> ( KVM_GUESTDBG_ENABLE | KVM_GUESTDBG_USE_SW_BP ) ) //<S2SV> eb |= 1u << BP_VECTOR ; //<S2SV> if ( to_vmx ( vcpu ) -> rmode . vm86_active ) //<S2SV> eb = ~ 0 ; //<S2SV> if ( enable_ept ) //<S2SV> eb &= ~ ( 1u << PF_VECTOR ) ; //<S2SV> if ( vcpu -> fpu_active ) //<S2SV> eb &= ~ ( 1u << NM_VECTOR ) ; //<S2SV> if ( is_guest_mode ( vcpu ) ) //<S2SV> eb |= get_vmcs12 ( vcpu ) -> exception_bitmap ; //<S2SV> vmcs_write32 ( EXCEPTION_BITMAP , eb ) ; //<S2SV> } //<S2SV> 