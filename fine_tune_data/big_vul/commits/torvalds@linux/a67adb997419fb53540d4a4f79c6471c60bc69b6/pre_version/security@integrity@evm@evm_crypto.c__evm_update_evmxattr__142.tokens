int evm_update_evmxattr ( struct dentry * dentry , const char * xattr_name , //<S2SV> const char * xattr_value , size_t xattr_value_len ) //<S2SV> { //<S2SV> struct inode * inode = dentry -> d_inode ; //<S2SV> struct evm_ima_xattr_data xattr_data ; //<S2SV> int rc = 0 ; //<S2SV> rc = evm_calc_hmac ( dentry , xattr_name , xattr_value , //<S2SV> xattr_value_len , xattr_data . digest ) ; //<S2SV> if ( rc == 0 ) { //<S2SV> xattr_data . type = EVM_XATTR_HMAC ; //<S2SV> rc = __vfs_setxattr_noperm ( dentry , XATTR_NAME_EVM , //<S2SV> & xattr_data , //<S2SV> sizeof ( xattr_data ) , 0 ) ; //<S2SV> } //<S2SV> else if ( rc == - ENODATA ) //<S2SV> rc = inode -> i_op -> removexattr ( dentry , XATTR_NAME_EVM ) ; //<S2SV> return rc ; //<S2SV> } //<S2SV> 