static int caif_seqpkt_recvmsg ( struct kiocb * iocb , struct socket * sock , //<S2SV> struct msghdr * m , size_t len , int flags ) //<S2SV> { //<S2SV> struct sock * sk = sock -> sk ; //<S2SV> struct sk_buff * skb ; //<S2SV> int ret ; //<S2SV> int copylen ; //<S2SV> ret = - EOPNOTSUPP ; //<S2SV> if ( m -> msg_flags & MSG_OOB ) //<S2SV> goto read_error ; //<S2SV> m -> msg_namelen = 0 ; //<S2SV> skb = skb_recv_datagram ( sk , flags , 0 , & ret ) ; //<S2SV> if ( ! skb ) //<S2SV> goto read_error ; //<S2SV> copylen = skb -> len ; //<S2SV> if ( len < copylen ) { //<S2SV> m -> msg_flags |= MSG_TRUNC ; //<S2SV> copylen = len ; //<S2SV> } //<S2SV> ret = skb_copy_datagram_iovec ( skb , 0 , m -> msg_iov , copylen ) ; //<S2SV> if ( ret ) //<S2SV> goto out_free ; //<S2SV> ret = ( flags & MSG_TRUNC ) ? skb -> len : copylen ; //<S2SV> out_free : //<S2SV> skb_free_datagram ( sk , skb ) ; //<S2SV> caif_check_flow_release ( sk ) ; //<S2SV> return ret ; //<S2SV> read_error : //<S2SV> return ret ; //<S2SV> } //<S2SV> 