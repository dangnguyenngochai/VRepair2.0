static void hugetlb_vm_op_close ( struct vm_area_struct * vma ) //<S2SV> { //<S2SV> struct hstate * h = hstate_vma ( vma ) ; //<S2SV> struct resv_map * reservations = vma_resv_map ( vma ) ; //<S2SV> struct hugepage_subpool * spool = subpool_vma ( vma ) ; //<S2SV> unsigned long reserve ; //<S2SV> unsigned long start ; //<S2SV> unsigned long end ; //<S2SV> if ( reservations ) { //<S2SV> start = vma_hugecache_offset ( h , vma , vma -> vm_start ) ; //<S2SV> end = vma_hugecache_offset ( h , vma , vma -> vm_end ) ; //<S2SV> reserve = ( end - start ) - //<S2SV> region_count ( & reservations -> regions , start , end ) ; //<S2SV> resv_map_put ( vma ) ; //<S2SV> if ( reserve ) { //<S2SV> hugetlb_acct_memory ( h , - reserve ) ; //<S2SV> hugepage_subpool_put_pages ( spool , reserve ) ; //<S2SV> } //<S2SV> } //<S2SV> } //<S2SV> 