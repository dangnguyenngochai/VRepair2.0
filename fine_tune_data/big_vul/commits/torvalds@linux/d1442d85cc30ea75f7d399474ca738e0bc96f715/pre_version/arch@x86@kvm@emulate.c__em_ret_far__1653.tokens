static int em_ret_far ( struct x86_emulate_ctxt * ctxt ) //<S2SV> { //<S2SV> int rc ; //<S2SV> unsigned long cs ; //<S2SV> int cpl = ctxt -> ops -> cpl ( ctxt ) ; //<S2SV> rc = emulate_pop ( ctxt , & ctxt -> _eip , ctxt -> op_bytes ) ; //<S2SV> if ( rc != X86EMUL_CONTINUE ) //<S2SV> return rc ; //<S2SV> if ( ctxt -> op_bytes == 4 ) //<S2SV> ctxt -> _eip = ( u32 ) ctxt -> _eip ; //<S2SV> rc = emulate_pop ( ctxt , & cs , ctxt -> op_bytes ) ; //<S2SV> if ( rc != X86EMUL_CONTINUE ) //<S2SV> return rc ; //<S2SV> if ( ctxt -> mode >= X86EMUL_MODE_PROT16 && ( cs & 3 ) > cpl ) //<S2SV> return X86EMUL_UNHANDLEABLE ; //<S2SV> rc = load_segment_descriptor ( ctxt , ( u16 ) cs , VCPU_SREG_CS ) ; //<S2SV> return rc ; //<S2SV> } //<S2SV> 