static int em_call_far ( struct x86_emulate_ctxt * ctxt ) //<S2SV> { //<S2SV> u16 sel , old_cs ; //<S2SV> ulong old_eip ; //<S2SV> int rc ; //<S2SV> old_cs = get_segment_selector ( ctxt , VCPU_SREG_CS ) ; //<S2SV> old_eip = ctxt -> _eip ; //<S2SV> memcpy ( & sel , ctxt -> src . valptr + ctxt -> op_bytes , 2 ) ; //<S2SV> if ( load_segment_descriptor ( ctxt , sel , VCPU_SREG_CS ) ) //<S2SV> return X86EMUL_CONTINUE ; //<S2SV> ctxt -> _eip = 0 ; //<S2SV> memcpy ( & ctxt -> _eip , ctxt -> src . valptr , ctxt -> op_bytes ) ; //<S2SV> ctxt -> src . val = old_cs ; //<S2SV> rc = em_push ( ctxt ) ; //<S2SV> if ( rc != X86EMUL_CONTINUE ) //<S2SV> return rc ; //<S2SV> ctxt -> src . val = old_eip ; //<S2SV> return em_push ( ctxt ) ; //<S2SV> } //<S2SV> 