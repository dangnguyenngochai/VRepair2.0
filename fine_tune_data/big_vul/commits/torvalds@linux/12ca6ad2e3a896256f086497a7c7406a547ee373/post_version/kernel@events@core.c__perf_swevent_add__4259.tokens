static int perf_swevent_add ( struct perf_event * event , int flags ) //<S2SV> { //<S2SV> struct swevent_htable * swhash = this_cpu_ptr ( & swevent_htable ) ; //<S2SV> struct hw_perf_event * hwc = & event -> hw ; //<S2SV> struct hlist_head * head ; //<S2SV> if ( is_sampling_event ( event ) ) { //<S2SV> hwc -> last_period = hwc -> sample_period ; //<S2SV> perf_swevent_set_period ( event ) ; //<S2SV> } //<S2SV> hwc -> state = ! ( flags & PERF_EF_START ) ; //<S2SV> head = find_swevent_head ( swhash , event ) ; //<S2SV> if ( WARN_ON_ONCE ( ! head ) ) //<S2SV> return - EINVAL ; //<S2SV> hlist_add_head_rcu ( & event -> hlist_entry , head ) ; //<S2SV> perf_event_update_userpage ( event ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 