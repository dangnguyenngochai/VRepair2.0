void sas_unregister_dev ( struct asd_sas_port * port , struct domain_device * dev ) //<S2SV> { //<S2SV> if ( ! test_bit ( SAS_DEV_DESTROY , & dev -> state ) && //<S2SV> ! list_empty ( & dev -> disco_list_node ) ) { //<S2SV> list_del_init ( & dev -> disco_list_node ) ; //<S2SV> sas_rphy_free ( dev -> rphy ) ; //<S2SV> sas_unregister_common_dev ( port , dev ) ; //<S2SV> return ; //<S2SV> } //<S2SV> if ( ! test_and_set_bit ( SAS_DEV_DESTROY , & dev -> state ) ) { //<S2SV> sas_rphy_unlink ( dev -> rphy ) ; //<S2SV> list_move_tail ( & dev -> disco_list_node , & port -> destroy_list ) ; //<S2SV> sas_discover_event ( dev -> port , DISCE_DESTRUCT ) ; //<S2SV> } //<S2SV> } //<S2SV> 