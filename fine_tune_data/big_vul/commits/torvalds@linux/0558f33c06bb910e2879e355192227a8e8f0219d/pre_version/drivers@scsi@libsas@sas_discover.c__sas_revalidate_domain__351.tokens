static void sas_revalidate_domain ( struct work_struct * work ) //<S2SV> { //<S2SV> int res = 0 ; //<S2SV> struct sas_discovery_event * ev = to_sas_discovery_event ( work ) ; //<S2SV> struct asd_sas_port * port = ev -> port ; //<S2SV> struct sas_ha_struct * ha = port -> ha ; //<S2SV> struct domain_device * ddev = port -> port_dev ; //<S2SV> mutex_lock ( & ha -> disco_mutex ) ; //<S2SV> if ( test_bit ( SAS_HA_ATA_EH_ACTIVE , & ha -> state ) ) { //<S2SV> SAS_DPRINTK ( "REVALIDATION<S2SV_blank>DEFERRED<S2SV_blank>on<S2SV_blank>port<S2SV_blank>%d,<S2SV_blank>pid:%d\\n" , //<S2SV> port -> id , task_pid_nr ( current ) ) ; //<S2SV> goto out ; //<S2SV> } //<S2SV> clear_bit ( DISCE_REVALIDATE_DOMAIN , & port -> disc . pending ) ; //<S2SV> SAS_DPRINTK ( "REVALIDATING<S2SV_blank>DOMAIN<S2SV_blank>on<S2SV_blank>port<S2SV_blank>%d,<S2SV_blank>pid:%d\\n" , port -> id , //<S2SV> task_pid_nr ( current ) ) ; //<S2SV> if ( ddev && ( ddev -> dev_type == SAS_FANOUT_EXPANDER_DEVICE || //<S2SV> ddev -> dev_type == SAS_EDGE_EXPANDER_DEVICE ) ) //<S2SV> res = sas_ex_revalidate_domain ( ddev ) ; //<S2SV> SAS_DPRINTK ( "done<S2SV_blank>REVALIDATING<S2SV_blank>DOMAIN<S2SV_blank>on<S2SV_blank>port<S2SV_blank>%d,<S2SV_blank>pid:%d,<S2SV_blank>res<S2SV_blank>0x%x\\n" , //<S2SV> port -> id , task_pid_nr ( current ) , res ) ; //<S2SV> out : //<S2SV> mutex_unlock ( & ha -> disco_mutex ) ; //<S2SV> } //<S2SV> 