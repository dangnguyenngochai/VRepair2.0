static ssize_t ib_ucm_write ( struct file * filp , const char __user * buf , //<S2SV> size_t len , loff_t * pos ) //<S2SV> { //<S2SV> struct ib_ucm_file * file = filp -> private_data ; //<S2SV> struct ib_ucm_cmd_hdr hdr ; //<S2SV> ssize_t result ; //<S2SV> if ( WARN_ON_ONCE ( ! ib_safe_file_access ( filp ) ) ) //<S2SV> return - EACCES ; //<S2SV> if ( len < sizeof ( hdr ) ) //<S2SV> return - EINVAL ; //<S2SV> if ( copy_from_user ( & hdr , buf , sizeof ( hdr ) ) ) //<S2SV> return - EFAULT ; //<S2SV> if ( hdr . cmd >= ARRAY_SIZE ( ucm_cmd_table ) ) //<S2SV> return - EINVAL ; //<S2SV> if ( hdr . in + sizeof ( hdr ) > len ) //<S2SV> return - EINVAL ; //<S2SV> result = ucm_cmd_table [ hdr . cmd ] ( file , buf + sizeof ( hdr ) , //<S2SV> hdr . in , hdr . out ) ; //<S2SV> if ( ! result ) //<S2SV> result = len ; //<S2SV> return result ; //<S2SV> } //<S2SV> 