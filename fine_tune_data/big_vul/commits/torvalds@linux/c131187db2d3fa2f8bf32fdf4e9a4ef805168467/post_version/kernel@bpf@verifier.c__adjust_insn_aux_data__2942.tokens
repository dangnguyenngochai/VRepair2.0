static int adjust_insn_aux_data ( struct bpf_verifier_env * env , u32 prog_len , //<S2SV> u32 off , u32 cnt ) //<S2SV> { //<S2SV> struct bpf_insn_aux_data * new_data , * old_data = env -> insn_aux_data ; //<S2SV> int i ; //<S2SV> if ( cnt == 1 ) //<S2SV> return 0 ; //<S2SV> new_data = vzalloc ( sizeof ( struct bpf_insn_aux_data ) * prog_len ) ; //<S2SV> if ( ! new_data ) //<S2SV> return - ENOMEM ; //<S2SV> memcpy ( new_data , old_data , sizeof ( struct bpf_insn_aux_data ) * off ) ; //<S2SV> memcpy ( new_data + off + cnt - 1 , old_data + off , //<S2SV> sizeof ( struct bpf_insn_aux_data ) * ( prog_len - off - cnt + 1 ) ) ; //<S2SV> for ( i = off ; i < off + cnt - 1 ; i ++ ) //<S2SV> new_data [ i ] . seen = true ; //<S2SV> env -> insn_aux_data = new_data ; //<S2SV> vfree ( old_data ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 