static __inline__ int scm_check_creds ( struct ucred * creds ) //<S2SV> { //<S2SV> const struct cred * cred = current_cred ( ) ; //<S2SV> kuid_t uid = make_kuid ( cred -> user_ns , creds -> uid ) ; //<S2SV> kgid_t gid = make_kgid ( cred -> user_ns , creds -> gid ) ; //<S2SV> if ( ! uid_valid ( uid ) || ! gid_valid ( gid ) ) //<S2SV> return - EINVAL ; //<S2SV> if ( ( creds -> pid == task_tgid_vnr ( current ) || //<S2SV> ns_capable ( task_active_pid_ns ( current ) -> user_ns , CAP_SYS_ADMIN ) ) && //<S2SV> ( ( uid_eq ( uid , cred -> uid ) || uid_eq ( uid , cred -> euid ) || //<S2SV> uid_eq ( uid , cred -> suid ) ) || nsown_capable ( CAP_SETUID ) ) && //<S2SV> ( ( gid_eq ( gid , cred -> gid ) || gid_eq ( gid , cred -> egid ) || //<S2SV> gid_eq ( gid , cred -> sgid ) ) || nsown_capable ( CAP_SETGID ) ) ) { //<S2SV> return 0 ; //<S2SV> } //<S2SV> return - EPERM ; //<S2SV> } //<S2SV> 