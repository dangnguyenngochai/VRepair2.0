static int cdrom_ioctl_media_changed ( struct cdrom_device_info * cdi , //<S2SV> unsigned long arg ) //<S2SV> { //<S2SV> struct cdrom_changer_info * info ; //<S2SV> int ret ; //<S2SV> cd_dbg ( CD_DO_IOCTL , "entering<S2SV_blank>CDROM_MEDIA_CHANGED\\n" ) ; //<S2SV> if ( ! CDROM_CAN ( CDC_MEDIA_CHANGED ) ) //<S2SV> return - ENOSYS ; //<S2SV> if ( ! CDROM_CAN ( CDC_SELECT_DISC ) || arg == CDSL_CURRENT ) //<S2SV> return media_changed ( cdi , 1 ) ; //<S2SV> if ( ( unsigned int ) arg >= cdi -> capacity ) //<S2SV> return - EINVAL ; //<S2SV> info = kmalloc ( sizeof ( * info ) , GFP_KERNEL ) ; //<S2SV> if ( ! info ) //<S2SV> return - ENOMEM ; //<S2SV> ret = cdrom_read_mech_status ( cdi , info ) ; //<S2SV> if ( ! ret ) //<S2SV> ret = info -> slots [ arg ] . change ; //<S2SV> kfree ( info ) ; //<S2SV> return ret ; //<S2SV> } //<S2SV> 