static int key_notify_sa_flush ( const struct km_event * c ) //<S2SV> { //<S2SV> struct sk_buff * skb ; //<S2SV> struct sadb_msg * hdr ; //<S2SV> skb = alloc_skb ( sizeof ( struct sadb_msg ) + 16 , GFP_ATOMIC ) ; //<S2SV> if ( ! skb ) //<S2SV> return - ENOBUFS ; //<S2SV> hdr = ( struct sadb_msg * ) skb_put ( skb , sizeof ( struct sadb_msg ) ) ; //<S2SV> hdr -> sadb_msg_satype = pfkey_proto2satype ( c -> data . proto ) ; //<S2SV> hdr -> sadb_msg_type = SADB_FLUSH ; //<S2SV> hdr -> sadb_msg_seq = c -> seq ; //<S2SV> hdr -> sadb_msg_pid = c -> portid ; //<S2SV> hdr -> sadb_msg_version = PF_KEY_V2 ; //<S2SV> hdr -> sadb_msg_errno = ( uint8_t ) 0 ; //<S2SV> hdr -> sadb_msg_len = ( sizeof ( struct sadb_msg ) / sizeof ( uint64_t ) ) ; //<S2SV> hdr -> sadb_msg_reserved = 0 ; //<S2SV> pfkey_broadcast ( skb , GFP_ATOMIC , BROADCAST_ALL , NULL , c -> net ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 