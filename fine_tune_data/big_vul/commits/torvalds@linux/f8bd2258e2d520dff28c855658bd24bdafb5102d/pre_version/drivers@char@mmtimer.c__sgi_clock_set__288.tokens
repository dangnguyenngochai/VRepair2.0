static int sgi_clock_set ( clockid_t clockid , struct timespec * tp ) //<S2SV> { //<S2SV> u64 nsec ; //<S2SV> u64 rem ; //<S2SV> nsec = rtc_time ( ) * sgi_clock_period ; //<S2SV> sgi_clock_offset . tv_sec = tp -> tv_sec - div_long_long_rem ( nsec , NSEC_PER_SEC , & rem ) ; //<S2SV> if ( rem <= tp -> tv_nsec ) //<S2SV> sgi_clock_offset . tv_nsec = tp -> tv_sec - rem ; //<S2SV> else { //<S2SV> sgi_clock_offset . tv_nsec = tp -> tv_sec + NSEC_PER_SEC - rem ; //<S2SV> sgi_clock_offset . tv_sec -- ; //<S2SV> } //<S2SV> return 0 ; //<S2SV> } //<S2SV> 