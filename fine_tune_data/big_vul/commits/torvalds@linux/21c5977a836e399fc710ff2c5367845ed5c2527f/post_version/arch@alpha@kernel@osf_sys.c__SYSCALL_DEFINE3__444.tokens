SYSCALL_DEFINE3 ( osf_sysinfo , int , command , char __user * , buf , long , count ) //<S2SV> { //<S2SV> const char * sysinfo_table [ ] = { //<S2SV> utsname ( ) -> sysname , //<S2SV> utsname ( ) -> nodename , //<S2SV> utsname ( ) -> release , //<S2SV> utsname ( ) -> version , //<S2SV> utsname ( ) -> machine , //<S2SV> "alpha" , //<S2SV> "dummy" , //<S2SV> "dummy" , //<S2SV> "dummy" , //<S2SV> } ; //<S2SV> unsigned long offset ; //<S2SV> const char * res ; //<S2SV> long len , err = - EINVAL ; //<S2SV> offset = command - 1 ; //<S2SV> if ( offset >= ARRAY_SIZE ( sysinfo_table ) ) { //<S2SV> printk ( "sysinfo(%d)" , command ) ; //<S2SV> goto out ; //<S2SV> } //<S2SV> down_read ( & uts_sem ) ; //<S2SV> res = sysinfo_table [ offset ] ; //<S2SV> len = strlen ( res ) + 1 ; //<S2SV> if ( ( unsigned long ) len > ( unsigned long ) count ) //<S2SV> len = count ; //<S2SV> if ( copy_to_user ( buf , res , len ) ) //<S2SV> err = - EFAULT ; //<S2SV> else //<S2SV> err = 0 ; //<S2SV> up_read ( & uts_sem ) ; //<S2SV> out : //<S2SV> return err ; //<S2SV> } //<S2SV> 