static int nested_vmx_check_permission ( struct kvm_vcpu * vcpu ) //<S2SV> { //<S2SV> if ( vmx_get_cpl ( vcpu ) ) { //<S2SV> kvm_queue_exception ( vcpu , UD_VECTOR ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> if ( ! to_vmx ( vcpu ) -> nested . vmxon ) { //<S2SV> kvm_queue_exception ( vcpu , UD_VECTOR ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> return 1 ; //<S2SV> } //<S2SV> 