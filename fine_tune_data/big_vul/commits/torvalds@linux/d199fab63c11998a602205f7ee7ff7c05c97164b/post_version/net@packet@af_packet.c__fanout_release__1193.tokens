static void fanout_release ( struct sock * sk ) //<S2SV> { //<S2SV> struct packet_sock * po = pkt_sk ( sk ) ; //<S2SV> struct packet_fanout * f ; //<S2SV> mutex_lock ( & fanout_mutex ) ; //<S2SV> f = po -> fanout ; //<S2SV> if ( f ) { //<S2SV> po -> fanout = NULL ; //<S2SV> if ( atomic_dec_and_test ( & f -> sk_ref ) ) { //<S2SV> list_del ( & f -> list ) ; //<S2SV> dev_remove_pack ( & f -> prot_hook ) ; //<S2SV> fanout_release_data ( f ) ; //<S2SV> kfree ( f ) ; //<S2SV> } //<S2SV> if ( po -> rollover ) //<S2SV> kfree_rcu ( po -> rollover , rcu ) ; //<S2SV> } //<S2SV> mutex_unlock ( & fanout_mutex ) ; //<S2SV> } //<S2SV> 