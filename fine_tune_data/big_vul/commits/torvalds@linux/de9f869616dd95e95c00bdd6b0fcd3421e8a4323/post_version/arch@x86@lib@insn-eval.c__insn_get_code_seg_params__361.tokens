int insn_get_code_seg_params ( struct pt_regs * regs ) //<S2SV> { //<S2SV> struct desc_struct desc ; //<S2SV> short sel ; //<S2SV> if ( v8086_mode ( regs ) ) //<S2SV> return INSN_CODE_SEG_PARAMS ( 2 , 2 ) ; //<S2SV> sel = get_segment_selector ( regs , INAT_SEG_REG_CS ) ; //<S2SV> if ( sel < 0 ) //<S2SV> return sel ; //<S2SV> if ( ! get_desc ( & desc , sel ) ) //<S2SV> return - EINVAL ; //<S2SV> if ( ! ( desc . type & BIT ( 3 ) ) ) //<S2SV> return - EINVAL ; //<S2SV> switch ( ( desc . l << 1 ) | desc . d ) { //<S2SV> case 0 : //<S2SV> return INSN_CODE_SEG_PARAMS ( 2 , 2 ) ; //<S2SV> case 1 : //<S2SV> return INSN_CODE_SEG_PARAMS ( 4 , 4 ) ; //<S2SV> case 2 : //<S2SV> return INSN_CODE_SEG_PARAMS ( 4 , 8 ) ; //<S2SV> case 3 : //<S2SV> default : //<S2SV> return - EINVAL ; //<S2SV> } //<S2SV> } //<S2SV> 