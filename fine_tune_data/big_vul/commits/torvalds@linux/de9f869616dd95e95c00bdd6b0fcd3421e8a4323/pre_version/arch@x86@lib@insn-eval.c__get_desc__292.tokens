static struct desc_struct * get_desc ( unsigned short sel ) //<S2SV> { //<S2SV> struct desc_ptr gdt_desc = { 0 , 0 } ; //<S2SV> unsigned long desc_base ; //<S2SV> # ifdef CONFIG_MODIFY_LDT_SYSCALL //<S2SV> if ( ( sel & SEGMENT_TI_MASK ) == SEGMENT_LDT ) { //<S2SV> struct desc_struct * desc = NULL ; //<S2SV> struct ldt_struct * ldt ; //<S2SV> sel >>= 3 ; //<S2SV> mutex_lock ( & current -> active_mm -> context . lock ) ; //<S2SV> ldt = current -> active_mm -> context . ldt ; //<S2SV> if ( ldt && sel < ldt -> nr_entries ) //<S2SV> desc = & ldt -> entries [ sel ] ; //<S2SV> mutex_unlock ( & current -> active_mm -> context . lock ) ; //<S2SV> return desc ; //<S2SV> } //<S2SV> # endif //<S2SV> native_store_gdt ( & gdt_desc ) ; //<S2SV> desc_base = sel & ~ ( SEGMENT_RPL_MASK | SEGMENT_TI_MASK ) ; //<S2SV> if ( desc_base > gdt_desc . size ) //<S2SV> return NULL ; //<S2SV> return ( struct desc_struct * ) ( gdt_desc . address + desc_base ) ; //<S2SV> } //<S2SV> 