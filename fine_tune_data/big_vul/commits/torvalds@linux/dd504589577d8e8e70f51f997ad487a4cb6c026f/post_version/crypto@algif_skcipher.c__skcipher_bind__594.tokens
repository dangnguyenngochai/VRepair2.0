static void * skcipher_bind ( const char * name , u32 type , u32 mask ) //<S2SV> { //<S2SV> struct skcipher_tfm * tfm ; //<S2SV> struct crypto_skcipher * skcipher ; //<S2SV> tfm = kzalloc ( sizeof ( * tfm ) , GFP_KERNEL ) ; //<S2SV> if ( ! tfm ) //<S2SV> return ERR_PTR ( - ENOMEM ) ; //<S2SV> skcipher = crypto_alloc_skcipher ( name , type , mask ) ; //<S2SV> if ( IS_ERR ( skcipher ) ) { //<S2SV> kfree ( tfm ) ; //<S2SV> return ERR_CAST ( skcipher ) ; //<S2SV> } //<S2SV> tfm -> skcipher = skcipher ; //<S2SV> return tfm ; //<S2SV> } //<S2SV> 