int crypto_rng_reset ( struct crypto_rng * tfm , const u8 * seed , unsigned int slen ) //<S2SV> { //<S2SV> u8 * buf = NULL ; //<S2SV> int err ; //<S2SV> if ( ! seed && slen ) { //<S2SV> buf = kmalloc ( slen , GFP_KERNEL ) ; //<S2SV> if ( ! buf ) //<S2SV> return - ENOMEM ; //<S2SV> get_random_bytes ( buf , slen ) ; //<S2SV> seed = buf ; //<S2SV> } //<S2SV> err = tfm -> seed ( tfm , seed , slen ) ; //<S2SV> kfree ( buf ) ; //<S2SV> return err ; //<S2SV> } //<S2SV> 