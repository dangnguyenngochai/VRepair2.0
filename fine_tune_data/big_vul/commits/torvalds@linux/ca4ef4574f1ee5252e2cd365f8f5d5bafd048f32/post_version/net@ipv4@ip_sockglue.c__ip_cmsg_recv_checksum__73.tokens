static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , //<S2SV> int tlen , int offset ) //<S2SV> { //<S2SV> __wsum csum = skb -> csum ; //<S2SV> if ( skb -> ip_summed != CHECKSUM_COMPLETE ) //<S2SV> return ; //<S2SV> if ( offset != 0 ) { //<S2SV> int tend_off = skb_transport_offset ( skb ) + tlen ; //<S2SV> csum = csum_sub ( csum , skb_checksum ( skb , tend_off , offset , 0 ) ) ; //<S2SV> } //<S2SV> put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; //<S2SV> } //<S2SV> 