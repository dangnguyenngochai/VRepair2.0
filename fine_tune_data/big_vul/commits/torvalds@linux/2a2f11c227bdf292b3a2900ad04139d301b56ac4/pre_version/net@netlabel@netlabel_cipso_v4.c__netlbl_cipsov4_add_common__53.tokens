static int netlbl_cipsov4_add_common ( struct genl_info * info , //<S2SV> struct cipso_v4_doi * doi_def ) //<S2SV> { //<S2SV> struct nlattr * nla ; //<S2SV> int nla_rem ; //<S2SV> u32 iter = 0 ; //<S2SV> doi_def -> doi = nla_get_u32 ( info -> attrs [ NLBL_CIPSOV4_A_DOI ] ) ; //<S2SV> if ( nla_validate_nested ( info -> attrs [ NLBL_CIPSOV4_A_TAGLST ] , //<S2SV> NLBL_CIPSOV4_A_MAX , //<S2SV> netlbl_cipsov4_genl_policy ) != 0 ) //<S2SV> return - EINVAL ; //<S2SV> nla_for_each_nested ( nla , info -> attrs [ NLBL_CIPSOV4_A_TAGLST ] , nla_rem ) //<S2SV> if ( nla -> nla_type == NLBL_CIPSOV4_A_TAG ) { //<S2SV> if ( iter > CIPSO_V4_TAG_MAXCNT ) //<S2SV> return - EINVAL ; //<S2SV> doi_def -> tags [ iter ++ ] = nla_get_u8 ( nla ) ; //<S2SV> } //<S2SV> if ( iter < CIPSO_V4_TAG_MAXCNT ) //<S2SV> doi_def -> tags [ iter ] = CIPSO_V4_TAG_INVALID ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 