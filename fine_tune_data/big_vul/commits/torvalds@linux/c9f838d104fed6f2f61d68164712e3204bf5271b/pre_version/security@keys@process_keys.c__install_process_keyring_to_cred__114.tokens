int install_process_keyring_to_cred ( struct cred * new ) //<S2SV> { //<S2SV> struct key * keyring ; //<S2SV> if ( new -> process_keyring ) //<S2SV> return - EEXIST ; //<S2SV> keyring = keyring_alloc ( "_pid" , new -> uid , new -> gid , new , //<S2SV> KEY_POS_ALL | KEY_USR_VIEW , //<S2SV> KEY_ALLOC_QUOTA_OVERRUN , //<S2SV> NULL , NULL ) ; //<S2SV> if ( IS_ERR ( keyring ) ) //<S2SV> return PTR_ERR ( keyring ) ; //<S2SV> new -> process_keyring = keyring ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 