static //<S2SV> struct ipv6_txoptions * ipv6_update_options ( struct sock * sk , //<S2SV> struct ipv6_txoptions * opt ) //<S2SV> { //<S2SV> if ( inet_sk ( sk ) -> is_icsk ) { //<S2SV> if ( opt && //<S2SV> ! ( ( 1 << sk -> sk_state ) & ( TCPF_LISTEN | TCPF_CLOSE ) ) && //<S2SV> inet_sk ( sk ) -> inet_daddr != LOOPBACK4_IPV6 ) { //<S2SV> struct inet_connection_sock * icsk = inet_csk ( sk ) ; //<S2SV> icsk -> icsk_ext_hdr_len = opt -> opt_flen + opt -> opt_nflen ; //<S2SV> icsk -> icsk_sync_mss ( sk , icsk -> icsk_pmtu_cookie ) ; //<S2SV> } //<S2SV> } //<S2SV> opt = xchg ( ( __force struct ipv6_txoptions * * ) & inet6_sk ( sk ) -> opt , //<S2SV> opt ) ; //<S2SV> sk_dst_reset ( sk ) ; //<S2SV> return opt ; //<S2SV> } //<S2SV> 