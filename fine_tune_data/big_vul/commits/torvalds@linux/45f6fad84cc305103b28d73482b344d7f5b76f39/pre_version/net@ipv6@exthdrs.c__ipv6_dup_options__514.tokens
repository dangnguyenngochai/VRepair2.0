struct ipv6_txoptions * //<S2SV> ipv6_dup_options ( struct sock * sk , struct ipv6_txoptions * opt ) //<S2SV> { //<S2SV> struct ipv6_txoptions * opt2 ; //<S2SV> opt2 = sock_kmalloc ( sk , opt -> tot_len , GFP_ATOMIC ) ; //<S2SV> if ( opt2 ) { //<S2SV> long dif = ( char * ) opt2 - ( char * ) opt ; //<S2SV> memcpy ( opt2 , opt , opt -> tot_len ) ; //<S2SV> if ( opt2 -> hopopt ) //<S2SV> * ( ( char * * ) & opt2 -> hopopt ) += dif ; //<S2SV> if ( opt2 -> dst0opt ) //<S2SV> * ( ( char * * ) & opt2 -> dst0opt ) += dif ; //<S2SV> if ( opt2 -> dst1opt ) //<S2SV> * ( ( char * * ) & opt2 -> dst1opt ) += dif ; //<S2SV> if ( opt2 -> srcrt ) //<S2SV> * ( ( char * * ) & opt2 -> srcrt ) += dif ; //<S2SV> } //<S2SV> return opt2 ; //<S2SV> } //<S2SV> 