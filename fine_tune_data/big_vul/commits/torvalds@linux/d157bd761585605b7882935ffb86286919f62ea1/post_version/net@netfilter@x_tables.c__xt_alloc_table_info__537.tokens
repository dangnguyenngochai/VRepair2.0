struct xt_table_info * xt_alloc_table_info ( unsigned int size ) //<S2SV> { //<S2SV> struct xt_table_info * info = NULL ; //<S2SV> size_t sz = sizeof ( * info ) + size ; //<S2SV> if ( sz < sizeof ( * info ) ) //<S2SV> return NULL ; //<S2SV> if ( ( SMP_ALIGN ( size ) >> PAGE_SHIFT ) + 2 > totalram_pages ) //<S2SV> return NULL ; //<S2SV> if ( sz <= ( PAGE_SIZE << PAGE_ALLOC_COSTLY_ORDER ) ) //<S2SV> info = kmalloc ( sz , GFP_KERNEL | __GFP_NOWARN | __GFP_NORETRY ) ; //<S2SV> if ( ! info ) { //<S2SV> info = vmalloc ( sz ) ; //<S2SV> if ( ! info ) //<S2SV> return NULL ; //<S2SV> } //<S2SV> memset ( info , 0 , sizeof ( * info ) ) ; //<S2SV> info -> size = size ; //<S2SV> return info ; //<S2SV> } //<S2SV> 