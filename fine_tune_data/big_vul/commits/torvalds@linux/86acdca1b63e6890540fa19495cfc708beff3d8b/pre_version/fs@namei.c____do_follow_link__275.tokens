static __always_inline int __do_follow_link ( struct path * path , struct nameidata * nd ) //<S2SV> { //<S2SV> int error ; //<S2SV> void * cookie ; //<S2SV> struct dentry * dentry = path -> dentry ; //<S2SV> touch_atime ( path -> mnt , dentry ) ; //<S2SV> nd_set_link ( nd , NULL ) ; //<S2SV> if ( path -> mnt != nd -> path . mnt ) { //<S2SV> path_to_nameidata ( path , nd ) ; //<S2SV> dget ( dentry ) ; //<S2SV> } //<S2SV> mntget ( path -> mnt ) ; //<S2SV> cookie = dentry -> d_inode -> i_op -> follow_link ( dentry , nd ) ; //<S2SV> error = PTR_ERR ( cookie ) ; //<S2SV> if ( ! IS_ERR ( cookie ) ) { //<S2SV> char * s = nd_get_link ( nd ) ; //<S2SV> error = 0 ; //<S2SV> if ( s ) //<S2SV> error = __vfs_follow_link ( nd , s ) ; //<S2SV> else if ( nd -> last_type == LAST_BIND ) { //<S2SV> error = force_reval_path ( & nd -> path , nd ) ; //<S2SV> if ( error ) //<S2SV> path_put ( & nd -> path ) ; //<S2SV> } //<S2SV> if ( dentry -> d_inode -> i_op -> put_link ) //<S2SV> dentry -> d_inode -> i_op -> put_link ( dentry , nd , cookie ) ; //<S2SV> } //<S2SV> return error ; //<S2SV> } //<S2SV> 