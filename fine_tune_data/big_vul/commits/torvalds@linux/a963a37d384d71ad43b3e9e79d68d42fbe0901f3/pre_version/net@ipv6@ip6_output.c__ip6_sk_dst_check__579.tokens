static struct dst_entry * ip6_sk_dst_check ( struct sock * sk , //<S2SV> struct dst_entry * dst , //<S2SV> const struct flowi6 * fl6 ) //<S2SV> { //<S2SV> struct ipv6_pinfo * np = inet6_sk ( sk ) ; //<S2SV> struct rt6_info * rt = ( struct rt6_info * ) dst ; //<S2SV> if ( ! dst ) //<S2SV> goto out ; //<S2SV> if ( ip6_rt_check ( & rt -> rt6i_dst , & fl6 -> daddr , np -> daddr_cache ) || //<S2SV> # ifdef CONFIG_IPV6_SUBTREES //<S2SV> ip6_rt_check ( & rt -> rt6i_src , & fl6 -> saddr , np -> saddr_cache ) || //<S2SV> # endif //<S2SV> ( fl6 -> flowi6_oif && fl6 -> flowi6_oif != dst -> dev -> ifindex ) ) { //<S2SV> dst_release ( dst ) ; //<S2SV> dst = NULL ; //<S2SV> } //<S2SV> out : //<S2SV> return dst ; //<S2SV> } //<S2SV> 