int kvm_set_msr ( struct kvm_vcpu * vcpu , struct msr_data * msr ) //<S2SV> { //<S2SV> switch ( msr -> index ) { //<S2SV> case MSR_FS_BASE : //<S2SV> case MSR_GS_BASE : //<S2SV> case MSR_KERNEL_GS_BASE : //<S2SV> case MSR_CSTAR : //<S2SV> case MSR_LSTAR : //<S2SV> if ( is_noncanonical_address ( msr -> data ) ) //<S2SV> return 1 ; //<S2SV> break ; //<S2SV> case MSR_IA32_SYSENTER_EIP : //<S2SV> case MSR_IA32_SYSENTER_ESP : //<S2SV> msr -> data = get_canonical ( msr -> data ) ; //<S2SV> } //<S2SV> return kvm_x86_ops -> set_msr ( vcpu , msr ) ; //<S2SV> } //<S2SV> 