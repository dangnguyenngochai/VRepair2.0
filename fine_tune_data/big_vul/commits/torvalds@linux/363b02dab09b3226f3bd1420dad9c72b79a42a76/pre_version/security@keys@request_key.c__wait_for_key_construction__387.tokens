int wait_for_key_construction ( struct key * key , bool intr ) //<S2SV> { //<S2SV> int ret ; //<S2SV> ret = wait_on_bit ( & key -> flags , KEY_FLAG_USER_CONSTRUCT , //<S2SV> intr ? TASK_INTERRUPTIBLE : TASK_UNINTERRUPTIBLE ) ; //<S2SV> if ( ret ) //<S2SV> return - ERESTARTSYS ; //<S2SV> if ( test_bit ( KEY_FLAG_NEGATIVE , & key -> flags ) ) { //<S2SV> smp_rmb ( ) ; //<S2SV> return key -> reject_error ; //<S2SV> } //<S2SV> return key_validate ( key ) ; //<S2SV> } //<S2SV> 