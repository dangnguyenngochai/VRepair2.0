int wait_for_key_construction ( struct key * key , bool intr ) //<S2SV> { //<S2SV> int ret ; //<S2SV> ret = wait_on_bit ( & key -> flags , KEY_FLAG_USER_CONSTRUCT , //<S2SV> intr ? TASK_INTERRUPTIBLE : TASK_UNINTERRUPTIBLE ) ; //<S2SV> if ( ret ) //<S2SV> return - ERESTARTSYS ; //<S2SV> ret = key_read_state ( key ) ; //<S2SV> if ( ret < 0 ) //<S2SV> return ret ; //<S2SV> return key_validate ( key ) ; //<S2SV> } //<S2SV> 