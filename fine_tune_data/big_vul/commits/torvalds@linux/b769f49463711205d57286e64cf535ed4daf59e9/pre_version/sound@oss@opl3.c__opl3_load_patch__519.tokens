static int opl3_load_patch ( int dev , int format , const char __user * addr , //<S2SV> int offs , int count , int pmgr_flag ) //<S2SV> { //<S2SV> struct sbi_instrument ins ; //<S2SV> if ( count < sizeof ( ins ) ) //<S2SV> { //<S2SV> printk ( KERN_WARNING "FM<S2SV_blank>Error:<S2SV_blank>Patch<S2SV_blank>record<S2SV_blank>too<S2SV_blank>short\\n" ) ; //<S2SV> return - EINVAL ; //<S2SV> } //<S2SV> if ( copy_from_user ( & ( ( char * ) & ins ) [ offs ] , addr + offs , sizeof ( ins ) - offs ) ) //<S2SV> return - EFAULT ; //<S2SV> if ( ins . channel < 0 || ins . channel >= SBFM_MAXINSTR ) //<S2SV> { //<S2SV> printk ( KERN_WARNING "FM<S2SV_blank>Error:<S2SV_blank>Invalid<S2SV_blank>instrument<S2SV_blank>number<S2SV_blank>%d\\n" , ins . channel ) ; //<S2SV> return - EINVAL ; //<S2SV> } //<S2SV> ins . key = format ; //<S2SV> return store_instr ( ins . channel , & ins ) ; //<S2SV> } //<S2SV> 