static int __sock_diag_rcv_msg ( struct sk_buff * skb , struct nlmsghdr * nlh ) //<S2SV> { //<S2SV> int err ; //<S2SV> struct sock_diag_req * req = nlmsg_data ( nlh ) ; //<S2SV> const struct sock_diag_handler * hndl ; //<S2SV> if ( nlmsg_len ( nlh ) < sizeof ( * req ) ) //<S2SV> return - EINVAL ; //<S2SV> if ( req -> sdiag_family >= AF_MAX ) //<S2SV> return - EINVAL ; //<S2SV> hndl = sock_diag_lock_handler ( req -> sdiag_family ) ; //<S2SV> if ( hndl == NULL ) //<S2SV> err = - ENOENT ; //<S2SV> else //<S2SV> err = hndl -> dump ( skb , nlh ) ; //<S2SV> sock_diag_unlock_handler ( hndl ) ; //<S2SV> return err ; //<S2SV> } //<S2SV> 