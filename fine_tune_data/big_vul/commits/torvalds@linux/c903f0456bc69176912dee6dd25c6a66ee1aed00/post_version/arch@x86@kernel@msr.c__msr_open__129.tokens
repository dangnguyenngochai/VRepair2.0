static int msr_open ( struct inode * inode , struct file * file ) //<S2SV> { //<S2SV> unsigned int cpu ; //<S2SV> struct cpuinfo_x86 * c ; //<S2SV> if ( ! capable ( CAP_SYS_RAWIO ) ) //<S2SV> return - EPERM ; //<S2SV> cpu = iminor ( file -> f_path . dentry -> d_inode ) ; //<S2SV> if ( cpu >= nr_cpu_ids || ! cpu_online ( cpu ) ) //<S2SV> return - ENXIO ; //<S2SV> c = & cpu_data ( cpu ) ; //<S2SV> if ( ! cpu_has ( c , X86_FEATURE_MSR ) ) //<S2SV> return - EIO ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 