static int raw_cmd_copyout ( int cmd , void __user * param , //<S2SV> struct floppy_raw_cmd * ptr ) //<S2SV> { //<S2SV> int ret ; //<S2SV> while ( ptr ) { //<S2SV> ret = copy_to_user ( param , ptr , sizeof ( * ptr ) ) ; //<S2SV> if ( ret ) //<S2SV> return - EFAULT ; //<S2SV> param += sizeof ( struct floppy_raw_cmd ) ; //<S2SV> if ( ( ptr -> flags & FD_RAW_READ ) && ptr -> buffer_length ) { //<S2SV> if ( ptr -> length >= 0 && //<S2SV> ptr -> length <= ptr -> buffer_length ) { //<S2SV> long length = ptr -> buffer_length - ptr -> length ; //<S2SV> ret = fd_copyout ( ptr -> data , ptr -> kernel_data , //<S2SV> length ) ; //<S2SV> if ( ret ) //<S2SV> return ret ; //<S2SV> } //<S2SV> } //<S2SV> ptr = ptr -> next ; //<S2SV> } //<S2SV> return 0 ; //<S2SV> } //<S2SV> 