static int get_core_reg ( struct kvm_vcpu * vcpu , const struct kvm_one_reg * reg ) //<S2SV> { //<S2SV> __u32 __user * uaddr = ( __u32 __user * ) ( unsigned long ) reg -> addr ; //<S2SV> struct kvm_regs * regs = vcpu_gp_regs ( vcpu ) ; //<S2SV> int nr_regs = sizeof ( * regs ) / sizeof ( __u32 ) ; //<S2SV> u32 off ; //<S2SV> off = core_reg_offset_from_id ( reg -> id ) ; //<S2SV> if ( off >= nr_regs || //<S2SV> ( off + ( KVM_REG_SIZE ( reg -> id ) / sizeof ( __u32 ) ) ) >= nr_regs ) //<S2SV> return - ENOENT ; //<S2SV> if ( validate_core_offset ( reg ) ) //<S2SV> return - EINVAL ; //<S2SV> if ( copy_to_user ( uaddr , ( ( u32 * ) regs ) + off , KVM_REG_SIZE ( reg -> id ) ) ) //<S2SV> return - EFAULT ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 