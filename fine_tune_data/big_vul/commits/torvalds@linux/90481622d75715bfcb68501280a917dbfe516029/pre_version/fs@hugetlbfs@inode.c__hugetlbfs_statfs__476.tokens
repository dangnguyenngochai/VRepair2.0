static int hugetlbfs_statfs ( struct dentry * dentry , struct kstatfs * buf ) //<S2SV> { //<S2SV> struct hugetlbfs_sb_info * sbinfo = HUGETLBFS_SB ( dentry -> d_sb ) ; //<S2SV> struct hstate * h = hstate_inode ( dentry -> d_inode ) ; //<S2SV> buf -> f_type = HUGETLBFS_MAGIC ; //<S2SV> buf -> f_bsize = huge_page_size ( h ) ; //<S2SV> if ( sbinfo ) { //<S2SV> spin_lock ( & sbinfo -> stat_lock ) ; //<S2SV> if ( sbinfo -> max_blocks >= 0 ) { //<S2SV> buf -> f_blocks = sbinfo -> max_blocks ; //<S2SV> buf -> f_bavail = buf -> f_bfree = sbinfo -> free_blocks ; //<S2SV> buf -> f_files = sbinfo -> max_inodes ; //<S2SV> buf -> f_ffree = sbinfo -> free_inodes ; //<S2SV> } //<S2SV> spin_unlock ( & sbinfo -> stat_lock ) ; //<S2SV> } //<S2SV> buf -> f_namelen = NAME_MAX ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 