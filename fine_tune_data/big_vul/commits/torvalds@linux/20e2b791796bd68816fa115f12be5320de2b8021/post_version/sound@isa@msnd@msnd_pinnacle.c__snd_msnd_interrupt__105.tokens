static irqreturn_t snd_msnd_interrupt ( int irq , void * dev_id ) //<S2SV> { //<S2SV> struct snd_msnd * chip = dev_id ; //<S2SV> void * pwDSPQData = chip -> mappedbase + DSPQ_DATA_BUFF ; //<S2SV> u16 head , tail , size ; //<S2SV> head = readw ( chip -> DSPQ + JQS_wHead ) ; //<S2SV> tail = readw ( chip -> DSPQ + JQS_wTail ) ; //<S2SV> size = readw ( chip -> DSPQ + JQS_wSize ) ; //<S2SV> if ( head > size || tail > size ) //<S2SV> goto out ; //<S2SV> while ( head != tail ) { //<S2SV> snd_msnd_eval_dsp_msg ( chip , readw ( pwDSPQData + 2 * head ) ) ; //<S2SV> if ( ++ head > size ) //<S2SV> head = 0 ; //<S2SV> writew ( head , chip -> DSPQ + JQS_wHead ) ; //<S2SV> } //<S2SV> out : //<S2SV> inb ( chip -> io + HP_RXL ) ; //<S2SV> return IRQ_HANDLED ; //<S2SV> } //<S2SV> 