static int copy_cred ( struct svc_cred * target , struct svc_cred * source ) //<S2SV> { //<S2SV> int ret ; //<S2SV> ret = strdup_if_nonnull ( & target -> cr_principal , source -> cr_principal ) ; //<S2SV> if ( ret ) //<S2SV> return ret ; //<S2SV> ret = strdup_if_nonnull ( & target -> cr_raw_principal , //<S2SV> source -> cr_raw_principal ) ; //<S2SV> if ( ret ) //<S2SV> return ret ; //<S2SV> target -> cr_flavor = source -> cr_flavor ; //<S2SV> target -> cr_uid = source -> cr_uid ; //<S2SV> target -> cr_gid = source -> cr_gid ; //<S2SV> target -> cr_group_info = source -> cr_group_info ; //<S2SV> get_group_info ( target -> cr_group_info ) ; //<S2SV> target -> cr_gss_mech = source -> cr_gss_mech ; //<S2SV> if ( source -> cr_gss_mech ) //<S2SV> gss_mech_get ( source -> cr_gss_mech ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 