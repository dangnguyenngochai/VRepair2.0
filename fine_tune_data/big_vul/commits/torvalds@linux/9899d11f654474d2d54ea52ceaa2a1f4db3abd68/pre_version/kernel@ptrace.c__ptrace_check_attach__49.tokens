static int ptrace_check_attach ( struct task_struct * child , bool ignore_state ) //<S2SV> { //<S2SV> int ret = - ESRCH ; //<S2SV> read_lock ( & tasklist_lock ) ; //<S2SV> if ( ( child -> ptrace & PT_PTRACED ) && child -> parent == current ) { //<S2SV> spin_lock_irq ( & child -> sighand -> siglock ) ; //<S2SV> WARN_ON_ONCE ( task_is_stopped ( child ) ) ; //<S2SV> if ( ignore_state || ( task_is_traced ( child ) && //<S2SV> ! ( child -> jobctl & JOBCTL_LISTENING ) ) ) //<S2SV> ret = 0 ; //<S2SV> spin_unlock_irq ( & child -> sighand -> siglock ) ; //<S2SV> } //<S2SV> read_unlock ( & tasklist_lock ) ; //<S2SV> if ( ! ret && ! ignore_state ) //<S2SV> ret = wait_task_inactive ( child , TASK_TRACED ) ? 0 : - ESRCH ; //<S2SV> return ret ; //<S2SV> } //<S2SV> 