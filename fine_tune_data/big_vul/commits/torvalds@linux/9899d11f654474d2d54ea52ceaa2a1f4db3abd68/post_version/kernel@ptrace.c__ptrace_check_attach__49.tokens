static int ptrace_check_attach ( struct task_struct * child , bool ignore_state ) //<S2SV> { //<S2SV> int ret = - ESRCH ; //<S2SV> read_lock ( & tasklist_lock ) ; //<S2SV> if ( child -> ptrace && child -> parent == current ) { //<S2SV> WARN_ON ( child -> state == __TASK_TRACED ) ; //<S2SV> if ( ignore_state || ptrace_freeze_traced ( child ) ) //<S2SV> ret = 0 ; //<S2SV> } //<S2SV> read_unlock ( & tasklist_lock ) ; //<S2SV> if ( ! ret && ! ignore_state ) { //<S2SV> if ( ! wait_task_inactive ( child , __TASK_TRACED ) ) { //<S2SV> WARN_ON ( child -> state == __TASK_TRACED ) ; //<S2SV> ret = - ESRCH ; //<S2SV> } //<S2SV> } //<S2SV> return ret ; //<S2SV> } //<S2SV> 