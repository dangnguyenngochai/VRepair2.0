struct vm_area_struct * //<S2SV> find_extend_vma ( struct mm_struct * mm , unsigned long addr ) //<S2SV> { //<S2SV> struct vm_area_struct * vma ; //<S2SV> unsigned long start ; //<S2SV> addr &= PAGE_MASK ; //<S2SV> vma = find_vma ( mm , addr ) ; //<S2SV> if ( ! vma ) //<S2SV> return NULL ; //<S2SV> if ( vma -> vm_start <= addr ) //<S2SV> return vma ; //<S2SV> if ( ! ( vma -> vm_flags & VM_GROWSDOWN ) ) //<S2SV> return NULL ; //<S2SV> if ( ! mmget_still_valid ( mm ) ) //<S2SV> return NULL ; //<S2SV> start = vma -> vm_start ; //<S2SV> if ( expand_stack ( vma , addr ) ) //<S2SV> return NULL ; //<S2SV> if ( vma -> vm_flags & VM_LOCKED ) //<S2SV> populate_vma_page_range ( vma , addr , start , NULL ) ; //<S2SV> return vma ; //<S2SV> } //<S2SV> 