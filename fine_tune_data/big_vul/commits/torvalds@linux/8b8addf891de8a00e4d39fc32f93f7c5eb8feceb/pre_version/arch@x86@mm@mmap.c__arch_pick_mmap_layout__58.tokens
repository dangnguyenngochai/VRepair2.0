void arch_pick_mmap_layout ( struct mm_struct * mm ) //<S2SV> { //<S2SV> unsigned long random_factor = 0UL ; //<S2SV> if ( current -> flags & PF_RANDOMIZE ) //<S2SV> random_factor = arch_mmap_rnd ( ) ; //<S2SV> mm -> mmap_legacy_base = mmap_legacy_base ( random_factor ) ; //<S2SV> if ( mmap_is_legacy ( ) ) { //<S2SV> mm -> mmap_base = mm -> mmap_legacy_base ; //<S2SV> mm -> get_unmapped_area = arch_get_unmapped_area ; //<S2SV> } else { //<S2SV> mm -> mmap_base = mmap_base ( random_factor ) ; //<S2SV> mm -> get_unmapped_area = arch_get_unmapped_area_topdown ; //<S2SV> } //<S2SV> } //<S2SV> 