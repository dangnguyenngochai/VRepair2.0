static int get_bitmap_file ( struct mddev * mddev , void __user * arg ) //<S2SV> { //<S2SV> mdu_bitmap_file_t * file = NULL ; //<S2SV> char * ptr ; //<S2SV> int err ; //<S2SV> file = kzalloc ( sizeof ( * file ) , GFP_NOIO ) ; //<S2SV> if ( ! file ) //<S2SV> return - ENOMEM ; //<S2SV> err = 0 ; //<S2SV> spin_lock ( & mddev -> lock ) ; //<S2SV> if ( ! mddev -> bitmap_info . file ) //<S2SV> file -> pathname [ 0 ] = '\\0' ; //<S2SV> else if ( ( ptr = file_path ( mddev -> bitmap_info . file , //<S2SV> file -> pathname , sizeof ( file -> pathname ) ) ) , //<S2SV> IS_ERR ( ptr ) ) //<S2SV> err = PTR_ERR ( ptr ) ; //<S2SV> else //<S2SV> memmove ( file -> pathname , ptr , //<S2SV> sizeof ( file -> pathname ) - ( ptr - file -> pathname ) ) ; //<S2SV> spin_unlock ( & mddev -> lock ) ; //<S2SV> if ( err == 0 && //<S2SV> copy_to_user ( arg , file , sizeof ( * file ) ) ) //<S2SV> err = - EFAULT ; //<S2SV> kfree ( file ) ; //<S2SV> return err ; //<S2SV> } //<S2SV> 