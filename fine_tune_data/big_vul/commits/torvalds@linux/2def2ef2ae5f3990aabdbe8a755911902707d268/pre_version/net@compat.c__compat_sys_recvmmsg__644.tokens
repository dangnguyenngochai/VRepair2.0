asmlinkage long compat_sys_recvmmsg ( int fd , struct compat_mmsghdr __user * mmsg , //<S2SV> unsigned int vlen , unsigned int flags , //<S2SV> struct compat_timespec __user * timeout ) //<S2SV> { //<S2SV> int datagrams ; //<S2SV> struct timespec ktspec ; //<S2SV> if ( flags & MSG_CMSG_COMPAT ) //<S2SV> return - EINVAL ; //<S2SV> if ( COMPAT_USE_64BIT_TIME ) //<S2SV> return __sys_recvmmsg ( fd , ( struct mmsghdr __user * ) mmsg , vlen , //<S2SV> flags | MSG_CMSG_COMPAT , //<S2SV> ( struct timespec * ) timeout ) ; //<S2SV> if ( timeout == NULL ) //<S2SV> return __sys_recvmmsg ( fd , ( struct mmsghdr __user * ) mmsg , vlen , //<S2SV> flags | MSG_CMSG_COMPAT , NULL ) ; //<S2SV> if ( get_compat_timespec ( & ktspec , timeout ) ) //<S2SV> return - EFAULT ; //<S2SV> datagrams = __sys_recvmmsg ( fd , ( struct mmsghdr __user * ) mmsg , vlen , //<S2SV> flags | MSG_CMSG_COMPAT , & ktspec ) ; //<S2SV> if ( datagrams > 0 && put_compat_timespec ( & ktspec , timeout ) ) //<S2SV> datagrams = - EFAULT ; //<S2SV> return datagrams ; //<S2SV> } //<S2SV> 