static const struct usb_cdc_union_desc * //<S2SV> ims_pcu_get_cdc_union_desc ( struct usb_interface * intf ) //<S2SV> { //<S2SV> const void * buf = intf -> altsetting -> extra ; //<S2SV> size_t buflen = intf -> altsetting -> extralen ; //<S2SV> struct usb_cdc_union_desc * union_desc ; //<S2SV> if ( ! buf ) { //<S2SV> dev_err ( & intf -> dev , "Missing<S2SV_blank>descriptor<S2SV_blank>data\\n" ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> if ( ! buflen ) { //<S2SV> dev_err ( & intf -> dev , "Zero<S2SV_blank>length<S2SV_blank>descriptor\\n" ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> while ( buflen >= sizeof ( * union_desc ) ) { //<S2SV> union_desc = ( struct usb_cdc_union_desc * ) buf ; //<S2SV> if ( union_desc -> bLength > buflen ) { //<S2SV> dev_err ( & intf -> dev , "Too<S2SV_blank>large<S2SV_blank>descriptor\\n" ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> if ( union_desc -> bDescriptorType == USB_DT_CS_INTERFACE && //<S2SV> union_desc -> bDescriptorSubType == USB_CDC_UNION_TYPE ) { //<S2SV> dev_dbg ( & intf -> dev , "Found<S2SV_blank>union<S2SV_blank>header\\n" ) ; //<S2SV> if ( union_desc -> bLength >= sizeof ( * union_desc ) ) //<S2SV> return union_desc ; //<S2SV> dev_err ( & intf -> dev , //<S2SV> "Union<S2SV_blank>descriptor<S2SV_blank>to<S2SV_blank>short<S2SV_blank>(%d<S2SV_blank>vs<S2SV_blank>%zd\\n)" , //<S2SV> union_desc -> bLength , sizeof ( * union_desc ) ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> buflen -= union_desc -> bLength ; //<S2SV> buf += union_desc -> bLength ; //<S2SV> } //<S2SV> dev_err ( & intf -> dev , "Missing<S2SV_blank>CDC<S2SV_blank>union<S2SV_blank>descriptor\\n" ) ; //<S2SV> return NULL ; //<S2SV> } //<S2SV> 