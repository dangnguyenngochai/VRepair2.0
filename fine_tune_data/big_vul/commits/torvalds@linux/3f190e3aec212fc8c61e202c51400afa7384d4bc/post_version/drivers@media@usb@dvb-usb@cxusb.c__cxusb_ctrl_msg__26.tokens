static int cxusb_ctrl_msg ( struct dvb_usb_device * d , //<S2SV> u8 cmd , u8 * wbuf , int wlen , u8 * rbuf , int rlen ) //<S2SV> { //<S2SV> struct cxusb_state * st = d -> priv ; //<S2SV> int ret ; //<S2SV> if ( 1 + wlen > MAX_XFER_SIZE ) { //<S2SV> warn ( "i2c<S2SV_blank>wr:<S2SV_blank>len=%d<S2SV_blank>is<S2SV_blank>too<S2SV_blank>big!\\n" , wlen ) ; //<S2SV> return - EOPNOTSUPP ; //<S2SV> } //<S2SV> if ( rlen > MAX_XFER_SIZE ) { //<S2SV> warn ( "i2c<S2SV_blank>rd:<S2SV_blank>len=%d<S2SV_blank>is<S2SV_blank>too<S2SV_blank>big!\\n" , rlen ) ; //<S2SV> return - EOPNOTSUPP ; //<S2SV> } //<S2SV> mutex_lock ( & d -> data_mutex ) ; //<S2SV> st -> data [ 0 ] = cmd ; //<S2SV> memcpy ( & st -> data [ 1 ] , wbuf , wlen ) ; //<S2SV> ret = dvb_usb_generic_rw ( d , st -> data , 1 + wlen , st -> data , rlen , 0 ) ; //<S2SV> if ( ! ret && rbuf && rlen ) //<S2SV> memcpy ( rbuf , st -> data , rlen ) ; //<S2SV> mutex_unlock ( & d -> data_mutex ) ; //<S2SV> return ret ; //<S2SV> } //<S2SV> 