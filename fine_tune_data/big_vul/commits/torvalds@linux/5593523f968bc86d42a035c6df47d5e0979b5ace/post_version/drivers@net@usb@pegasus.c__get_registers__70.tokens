static int get_registers ( pegasus_t * pegasus , __u16 indx , __u16 size , void * data ) //<S2SV> { //<S2SV> u8 * buf ; //<S2SV> int ret ; //<S2SV> buf = kmalloc ( size , GFP_NOIO ) ; //<S2SV> if ( ! buf ) //<S2SV> return - ENOMEM ; //<S2SV> ret = usb_control_msg ( pegasus -> usb , usb_rcvctrlpipe ( pegasus -> usb , 0 ) , //<S2SV> PEGASUS_REQ_GET_REGS , PEGASUS_REQT_READ , 0 , //<S2SV> indx , buf , size , 1000 ) ; //<S2SV> if ( ret < 0 ) //<S2SV> netif_dbg ( pegasus , drv , pegasus -> net , //<S2SV> "%s<S2SV_blank>returned<S2SV_blank>%d\\n" , __func__ , ret ) ; //<S2SV> else if ( ret <= size ) //<S2SV> memcpy ( data , buf , ret ) ; //<S2SV> kfree ( buf ) ; //<S2SV> return ret ; //<S2SV> } //<S2SV> 