static long madvise_willneed ( struct vm_area_struct * vma , //<S2SV> struct vm_area_struct * * prev , //<S2SV> unsigned long start , unsigned long end ) //<S2SV> { //<S2SV> struct file * file = vma -> vm_file ; //<S2SV> * prev = vma ; //<S2SV> # ifdef CONFIG_SWAP //<S2SV> if ( ! file ) { //<S2SV> force_swapin_readahead ( vma , start , end ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> if ( shmem_mapping ( file -> f_mapping ) ) { //<S2SV> force_shm_swapin_readahead ( vma , start , end , //<S2SV> file -> f_mapping ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> # else //<S2SV> if ( ! file ) //<S2SV> return - EBADF ; //<S2SV> # endif //<S2SV> if ( IS_DAX ( file_inode ( file ) ) ) { //<S2SV> return 0 ; //<S2SV> } //<S2SV> start = ( ( start - vma -> vm_start ) >> PAGE_SHIFT ) + vma -> vm_pgoff ; //<S2SV> if ( end > vma -> vm_end ) //<S2SV> end = vma -> vm_end ; //<S2SV> end = ( ( end - vma -> vm_start ) >> PAGE_SHIFT ) + vma -> vm_pgoff ; //<S2SV> force_page_cache_readahead ( file -> f_mapping , file , start , end - start ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 