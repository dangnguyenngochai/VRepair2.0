int dev_forward_skb ( struct net_device * dev , struct sk_buff * skb ) //<S2SV> { //<S2SV> skb_orphan ( skb ) ; //<S2SV> if ( ! ( dev -> flags & IFF_UP ) ) //<S2SV> return NET_RX_DROP ; //<S2SV> if ( skb -> len > ( dev -> mtu + dev -> hard_header_len ) ) //<S2SV> return NET_RX_DROP ; //<S2SV> skb_set_dev ( skb , dev ) ; //<S2SV> skb -> tstamp . tv64 = 0 ; //<S2SV> skb -> pkt_type = PACKET_HOST ; //<S2SV> skb -> protocol = eth_type_trans ( skb , dev ) ; //<S2SV> return netif_rx ( skb ) ; //<S2SV> } //<S2SV> 