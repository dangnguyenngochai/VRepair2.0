int unshare_userns ( unsigned long unshare_flags , struct cred * * new_cred ) //<S2SV> { //<S2SV> struct cred * cred ; //<S2SV> int err = - ENOMEM ; //<S2SV> if ( ! ( unshare_flags & CLONE_NEWUSER ) ) //<S2SV> return 0 ; //<S2SV> cred = prepare_creds ( ) ; //<S2SV> if ( cred ) { //<S2SV> err = create_user_ns ( cred ) ; //<S2SV> if ( err ) //<S2SV> put_cred ( cred ) ; //<S2SV> else //<S2SV> * new_cred = cred ; //<S2SV> } //<S2SV> return err ; //<S2SV> } //<S2SV> 