static int xfrm_dump_policy ( struct sk_buff * skb , struct netlink_callback * cb ) //<S2SV> { //<S2SV> struct net * net = sock_net ( skb -> sk ) ; //<S2SV> struct xfrm_policy_walk * walk = ( struct xfrm_policy_walk * ) & cb -> args [ 1 ] ; //<S2SV> struct xfrm_dump_info info ; //<S2SV> BUILD_BUG_ON ( sizeof ( struct xfrm_policy_walk ) > //<S2SV> sizeof ( cb -> args ) - sizeof ( cb -> args [ 0 ] ) ) ; //<S2SV> info . in_skb = cb -> skb ; //<S2SV> info . out_skb = skb ; //<S2SV> info . nlmsg_seq = cb -> nlh -> nlmsg_seq ; //<S2SV> info . nlmsg_flags = NLM_F_MULTI ; //<S2SV> if ( ! cb -> args [ 0 ] ) { //<S2SV> cb -> args [ 0 ] = 1 ; //<S2SV> xfrm_policy_walk_init ( walk , XFRM_POLICY_TYPE_ANY ) ; //<S2SV> } //<S2SV> ( void ) xfrm_policy_walk ( net , walk , dump_one_policy , & info ) ; //<S2SV> return skb -> len ; //<S2SV> } //<S2SV> 