static int xfrm_dump_policy ( struct sk_buff * skb , struct netlink_callback * cb ) //<S2SV> { //<S2SV> struct net * net = sock_net ( skb -> sk ) ; //<S2SV> struct xfrm_policy_walk * walk = ( struct xfrm_policy_walk * ) cb -> args ; //<S2SV> struct xfrm_dump_info info ; //<S2SV> info . in_skb = cb -> skb ; //<S2SV> info . out_skb = skb ; //<S2SV> info . nlmsg_seq = cb -> nlh -> nlmsg_seq ; //<S2SV> info . nlmsg_flags = NLM_F_MULTI ; //<S2SV> ( void ) xfrm_policy_walk ( net , walk , dump_one_policy , & info ) ; //<S2SV> return skb -> len ; //<S2SV> } //<S2SV> 