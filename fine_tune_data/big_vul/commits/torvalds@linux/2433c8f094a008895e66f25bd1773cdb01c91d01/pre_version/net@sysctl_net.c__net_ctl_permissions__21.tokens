static int net_ctl_permissions ( struct ctl_table_header * head , //<S2SV> struct ctl_table * table ) //<S2SV> { //<S2SV> struct net * net = container_of ( head -> set , struct net , sysctls ) ; //<S2SV> kuid_t root_uid = make_kuid ( net -> user_ns , 0 ) ; //<S2SV> kgid_t root_gid = make_kgid ( net -> user_ns , 0 ) ; //<S2SV> if ( ns_capable ( net -> user_ns , CAP_NET_ADMIN ) || //<S2SV> uid_eq ( root_uid , current_uid ( ) ) ) { //<S2SV> int mode = ( table -> mode >> 6 ) & 7 ; //<S2SV> return ( mode << 6 ) | ( mode << 3 ) | mode ; //<S2SV> } //<S2SV> if ( gid_eq ( root_gid , current_gid ( ) ) ) { //<S2SV> int mode = ( table -> mode >> 3 ) & 7 ; //<S2SV> return ( mode << 3 ) | mode ; //<S2SV> } //<S2SV> return table -> mode ; //<S2SV> } //<S2SV> 