static int //<S2SV> smbhash ( unsigned char * out , const unsigned char * in , unsigned char * key ) //<S2SV> { //<S2SV> unsigned char key2 [ 8 ] ; //<S2SV> struct crypto_cipher * tfm_des ; //<S2SV> str_to_key ( key , key2 ) ; //<S2SV> tfm_des = crypto_alloc_cipher ( "des" , 0 , 0 ) ; //<S2SV> if ( IS_ERR ( tfm_des ) ) { //<S2SV> cifs_dbg ( VFS , "could<S2SV_blank>not<S2SV_blank>allocate<S2SV_blank>des<S2SV_blank>crypto<S2SV_blank>API\\n" ) ; //<S2SV> return PTR_ERR ( tfm_des ) ; //<S2SV> } //<S2SV> crypto_cipher_setkey ( tfm_des , key2 , 8 ) ; //<S2SV> crypto_cipher_encrypt_one ( tfm_des , out , in ) ; //<S2SV> crypto_free_cipher ( tfm_des ) ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 