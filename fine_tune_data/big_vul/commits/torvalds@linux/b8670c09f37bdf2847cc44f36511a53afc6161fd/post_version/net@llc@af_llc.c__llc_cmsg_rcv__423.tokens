static void llc_cmsg_rcv ( struct msghdr * msg , struct sk_buff * skb ) //<S2SV> { //<S2SV> struct llc_sock * llc = llc_sk ( skb -> sk ) ; //<S2SV> if ( llc -> cmsg_flags & LLC_CMSG_PKTINFO ) { //<S2SV> struct llc_pktinfo info ; //<S2SV> memset ( & info , 0 , sizeof ( info ) ) ; //<S2SV> info . lpi_ifindex = llc_sk ( skb -> sk ) -> dev -> ifindex ; //<S2SV> llc_pdu_decode_dsap ( skb , & info . lpi_sap ) ; //<S2SV> llc_pdu_decode_da ( skb , info . lpi_mac ) ; //<S2SV> put_cmsg ( msg , SOL_LLC , LLC_OPT_PKTINFO , sizeof ( info ) , & info ) ; //<S2SV> } //<S2SV> } //<S2SV> 