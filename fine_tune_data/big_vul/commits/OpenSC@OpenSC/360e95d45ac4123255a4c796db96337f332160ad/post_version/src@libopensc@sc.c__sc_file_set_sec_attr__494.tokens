int sc_file_set_sec_attr ( sc_file_t * file , const u8 * sec_attr , //<S2SV> size_t sec_attr_len ) //<S2SV> { //<S2SV> u8 * tmp ; //<S2SV> if ( ! sc_file_valid ( file ) ) { //<S2SV> return SC_ERROR_INVALID_ARGUMENTS ; //<S2SV> } //<S2SV> if ( sec_attr == NULL || sec_attr_len ) { //<S2SV> if ( file -> sec_attr != NULL ) //<S2SV> free ( file -> sec_attr ) ; //<S2SV> file -> sec_attr = NULL ; //<S2SV> file -> sec_attr_len = 0 ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> tmp = ( u8 * ) realloc ( file -> sec_attr , sec_attr_len ) ; //<S2SV> if ( ! tmp ) { //<S2SV> if ( file -> sec_attr ) //<S2SV> free ( file -> sec_attr ) ; //<S2SV> file -> sec_attr = NULL ; //<S2SV> file -> sec_attr_len = 0 ; //<S2SV> return SC_ERROR_OUT_OF_MEMORY ; //<S2SV> } //<S2SV> file -> sec_attr = tmp ; //<S2SV> memcpy ( file -> sec_attr , sec_attr , sec_attr_len ) ; //<S2SV> file -> sec_attr_len = sec_attr_len ; //<S2SV> return 0 ; //<S2SV> } //<S2SV> 