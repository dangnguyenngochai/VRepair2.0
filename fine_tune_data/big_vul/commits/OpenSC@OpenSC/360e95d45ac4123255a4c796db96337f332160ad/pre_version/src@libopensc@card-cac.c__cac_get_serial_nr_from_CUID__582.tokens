static int cac_get_serial_nr_from_CUID ( sc_card_t * card , sc_serial_number_t * serial ) //<S2SV> { //<S2SV> cac_private_data_t * priv = CAC_DATA ( card ) ; //<S2SV> SC_FUNC_CALLED ( card -> ctx , SC_LOG_DEBUG_NORMAL ) ; //<S2SV> if ( card -> serialnr . len ) { //<S2SV> * serial = card -> serialnr ; //<S2SV> SC_FUNC_RETURN ( card -> ctx , SC_LOG_DEBUG_NORMAL , SC_SUCCESS ) ; //<S2SV> } //<S2SV> if ( priv -> cac_id_len ) { //<S2SV> serial -> len = MIN ( priv -> cac_id_len , SC_MAX_SERIALNR ) ; //<S2SV> memcpy ( serial -> value , priv -> cac_id , priv -> cac_id_len ) ; //<S2SV> SC_FUNC_RETURN ( card -> ctx , SC_LOG_DEBUG_NORMAL , SC_SUCCESS ) ; //<S2SV> } //<S2SV> SC_FUNC_RETURN ( card -> ctx , SC_LOG_DEBUG_NORMAL , SC_ERROR_FILE_NOT_FOUND ) ; //<S2SV> } //<S2SV> 