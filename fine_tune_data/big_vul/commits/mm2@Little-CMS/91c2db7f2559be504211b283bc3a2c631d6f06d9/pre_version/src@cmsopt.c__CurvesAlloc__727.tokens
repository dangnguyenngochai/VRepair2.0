static //<S2SV> Curves16Data * CurvesAlloc ( cmsContext ContextID , int nCurves , int nElements , cmsToneCurve * * G ) //<S2SV> { //<S2SV> int i , j ; //<S2SV> Curves16Data * c16 ; //<S2SV> c16 = _cmsMallocZero ( ContextID , sizeof ( Curves16Data ) ) ; //<S2SV> if ( c16 == NULL ) return NULL ; //<S2SV> c16 -> nCurves = nCurves ; //<S2SV> c16 -> nElements = nElements ; //<S2SV> c16 -> Curves = _cmsCalloc ( ContextID , nCurves , sizeof ( cmsUInt16Number * ) ) ; //<S2SV> if ( c16 -> Curves == NULL ) return NULL ; //<S2SV> for ( i = 0 ; i < nCurves ; i ++ ) { //<S2SV> c16 -> Curves [ i ] = _cmsCalloc ( ContextID , nElements , sizeof ( cmsUInt16Number ) ) ; //<S2SV> if ( nElements == 256 ) { //<S2SV> for ( j = 0 ; j < nElements ; j ++ ) { //<S2SV> c16 -> Curves [ i ] [ j ] = cmsEvalToneCurve16 ( G [ i ] , FROM_8_TO_16 ( j ) ) ; //<S2SV> } //<S2SV> } //<S2SV> else { //<S2SV> for ( j = 0 ; j < nElements ; j ++ ) { //<S2SV> c16 -> Curves [ i ] [ j ] = cmsEvalToneCurve16 ( G [ i ] , ( cmsUInt16Number ) j ) ; //<S2SV> } //<S2SV> } //<S2SV> } //<S2SV> return c16 ; //<S2SV> } //<S2SV> 