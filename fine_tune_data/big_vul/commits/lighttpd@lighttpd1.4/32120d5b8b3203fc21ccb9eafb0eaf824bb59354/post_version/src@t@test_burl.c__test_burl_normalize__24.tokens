static void test_burl_normalize ( void ) { //<S2SV> buffer * psrc = buffer_init ( ) ; //<S2SV> buffer * ptmp = buffer_init ( ) ; //<S2SV> int flags ; //<S2SV> flags = HTTP_PARSEOPT_URL_NORMALIZE_UNRESERVED ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "no-slash" ) , CONST_STR_LEN ( "no-slash" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/" ) , CONST_STR_LEN ( "/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc" ) , CONST_STR_LEN ( "/abc" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc/" ) , CONST_STR_LEN ( "/abc/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc/def" ) , CONST_STR_LEN ( "/abc/def" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?" ) , CONST_STR_LEN ( "/abc?" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d" ) , CONST_STR_LEN ( "/abc?d" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=" ) , CONST_STR_LEN ( "/abc?d=" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e" ) , CONST_STR_LEN ( "/abc?d=e" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&" ) , CONST_STR_LEN ( "/abc?d=e&" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f" ) , CONST_STR_LEN ( "/abc?d=e&f" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f=g" ) , CONST_STR_LEN ( "/abc?d=e&f=g" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f=g#" ) , CONST_STR_LEN ( "/abc?d=e&f=g" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f=g#any" ) , CONST_STR_LEN ( "/abc?d=e&f=g" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2F" ) , CONST_STR_LEN ( "/%2F" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2f" ) , CONST_STR_LEN ( "/%2F" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%20" ) , CONST_STR_LEN ( "/%20" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2b" ) , CONST_STR_LEN ( "/%2B" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2B" ) , CONST_STR_LEN ( "/%2B" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%3a" ) , CONST_STR_LEN ( "/%3A" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%3A" ) , CONST_STR_LEN ( "/%3A" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/~test%20ä_" ) , CONST_STR_LEN ( "/~test%20%C3%A4_" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\375" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\376" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\377" ) , "" , ( size_t ) - 2 ) ; //<S2SV> flags = HTTP_PARSEOPT_URL_NORMALIZE_REQUIRED ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/" ) , CONST_STR_LEN ( "/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc" ) , CONST_STR_LEN ( "/abc" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc/" ) , CONST_STR_LEN ( "/abc/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc/def" ) , CONST_STR_LEN ( "/abc/def" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?" ) , CONST_STR_LEN ( "/abc?" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d" ) , CONST_STR_LEN ( "/abc?d" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=" ) , CONST_STR_LEN ( "/abc?d=" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e" ) , CONST_STR_LEN ( "/abc?d=e" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&" ) , CONST_STR_LEN ( "/abc?d=e&" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f" ) , CONST_STR_LEN ( "/abc?d=e&f" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f=g" ) , CONST_STR_LEN ( "/abc?d=e&f=g" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f=g#" ) , CONST_STR_LEN ( "/abc?d=e&f=g" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/abc?d=e&f=g#any" ) , CONST_STR_LEN ( "/abc?d=e&f=g" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2F" ) , CONST_STR_LEN ( "/%2F" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2f" ) , CONST_STR_LEN ( "/%2F" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%20" ) , CONST_STR_LEN ( "/%20" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2b" ) , CONST_STR_LEN ( "/+" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2B" ) , CONST_STR_LEN ( "/+" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%3a" ) , CONST_STR_LEN ( "/:" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%3A" ) , CONST_STR_LEN ( "/:" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/~test%20ä_" ) , CONST_STR_LEN ( "/~test%20%C3%A4_" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\375" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\376" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\377" ) , "" , ( size_t ) - 2 ) ; //<S2SV> flags |= HTTP_PARSEOPT_URL_NORMALIZE_CTRLS_REJECT ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\a" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\t" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\r" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/\\177" ) , "" , ( size_t ) - 2 ) ; //<S2SV> # if defined ( __WIN32 ) || defined ( __CYGWIN__ ) //<S2SV> flags |= HTTP_PARSEOPT_URL_NORMALIZE_PATH_BACKSLASH_TRANS ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a\\\\b" ) , CONST_STR_LEN ( "/a/b" ) ) ; //<S2SV> # endif //<S2SV> flags |= HTTP_PARSEOPT_URL_NORMALIZE_PATH_2F_DECODE ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b?c=/" ) , CONST_STR_LEN ( "/a/b?c=/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b?c=%2f" ) , CONST_STR_LEN ( "/a/b?c=/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "%2f?" ) , CONST_STR_LEN ( "/?" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/%2f?" ) , CONST_STR_LEN ( "//?" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a%2fb" ) , CONST_STR_LEN ( "/a/b" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a%2Fb" ) , CONST_STR_LEN ( "/a/b" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a%2fb?c=/" ) , CONST_STR_LEN ( "/a/b?c=/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a%2fb?c=%2f" ) , CONST_STR_LEN ( "/a/b?c=/" ) ) ; //<S2SV> flags &= ~ HTTP_PARSEOPT_URL_NORMALIZE_PATH_2F_DECODE ; //<S2SV> flags |= HTTP_PARSEOPT_URL_NORMALIZE_PATH_2F_REJECT ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a%2fb" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a%2Fb" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b?c=%2f" ) , CONST_STR_LEN ( "/a/b?c=/" ) ) ; //<S2SV> flags &= ~ HTTP_PARSEOPT_URL_NORMALIZE_PATH_2F_REJECT ; //<S2SV> flags |= HTTP_PARSEOPT_URL_NORMALIZE_PATH_DOTSEG_REMOVE ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "./a/b" ) , CONST_STR_LEN ( "/a/b" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "../a/b" ) , CONST_STR_LEN ( "/a/b" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/./b" ) , CONST_STR_LEN ( "/a/b" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/../b" ) , CONST_STR_LEN ( "/b" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b/." ) , CONST_STR_LEN ( "/a/b/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b/.." ) , CONST_STR_LEN ( "/a/" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/../b/.." ) , CONST_STR_LEN ( "/" ) ) ; //<S2SV> flags &= ~ HTTP_PARSEOPT_URL_NORMALIZE_PATH_DOTSEG_REMOVE ; //<S2SV> flags |= HTTP_PARSEOPT_URL_NORMALIZE_PATH_DOTSEG_REJECT ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "./a/b" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "../a/b" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/./b" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/../b" ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b/." ) , "" , ( size_t ) - 2 ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b/.." ) , "" , ( size_t ) - 2 ) ; //<S2SV> flags &= ~ HTTP_PARSEOPT_URL_NORMALIZE_PATH_DOTSEG_REJECT ; //<S2SV> flags |= HTTP_PARSEOPT_URL_NORMALIZE_QUERY_20_PLUS ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b?c=d+e" ) , CONST_STR_LEN ( "/a/b?c=d+e" ) ) ; //<S2SV> run_burl_normalize ( psrc , ptmp , flags , __LINE__ , CONST_STR_LEN ( "/a/b?c=d%20e" ) , CONST_STR_LEN ( "/a/b?c=d+e" ) ) ; //<S2SV> flags &= ~ HTTP_PARSEOPT_URL_NORMALIZE_QUERY_20_PLUS ; //<S2SV> buffer_free ( psrc ) ; //<S2SV> buffer_free ( ptmp ) ; //<S2SV> } //<S2SV> 