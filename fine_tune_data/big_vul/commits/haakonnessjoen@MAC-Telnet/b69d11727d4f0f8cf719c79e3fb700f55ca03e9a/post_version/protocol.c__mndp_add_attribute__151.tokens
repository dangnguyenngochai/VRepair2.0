int mndp_add_attribute ( struct mt_packet * packet , enum mt_mndp_attrtype attrtype , void * attrdata , unsigned short data_len ) { //<S2SV> unsigned char * data = packet -> data + packet -> size ; //<S2SV> unsigned short type = attrtype ; //<S2SV> unsigned short len = data_len ; //<S2SV> if ( data_len > MT_PACKET_LEN - 4 - packet -> size ) { //<S2SV> fprintf ( stderr , _ ( "mndp_add_attribute:<S2SV_blank>ERROR,<S2SV_blank>too<S2SV_blank>large<S2SV_blank>packet.<S2SV_blank>Exceeds<S2SV_blank>%d<S2SV_blank>bytes\\n" ) , MT_PACKET_LEN ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> type = htons ( type ) ; //<S2SV> memcpy ( data , & type , sizeof ( type ) ) ; //<S2SV> len = htons ( len ) ; //<S2SV> memcpy ( data + 2 , & len , sizeof ( len ) ) ; //<S2SV> memcpy ( data + 4 , attrdata , data_len ) ; //<S2SV> packet -> size += 4 + data_len ; //<S2SV> return 4 + data_len ; //<S2SV> } //<S2SV> 