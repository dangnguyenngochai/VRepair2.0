static void InsertRow ( Image * image , ssize_t depth , unsigned char * p , ssize_t y , //<S2SV> ExceptionInfo * exception ) //<S2SV> { //<S2SV> size_t bit ; ssize_t x ; //<S2SV> register Quantum * q ; //<S2SV> Quantum index ; //<S2SV> index = 0 ; //<S2SV> switch ( depth ) //<S2SV> { //<S2SV> case 1 : //<S2SV> { //<S2SV> q = QueueAuthenticPixels ( image , 0 , y , image -> columns , 1 , exception ) ; //<S2SV> if ( q == ( Quantum * ) NULL ) //<S2SV> break ; //<S2SV> for ( x = 0 ; x < ( ( ssize_t ) image -> columns - 7 ) ; x += 8 ) //<S2SV> { //<S2SV> for ( bit = 0 ; bit < 8 ; bit ++ ) //<S2SV> { //<S2SV> index = ( Quantum ) ( ( ( ( * p ) & ( 0x80 >> bit ) ) != 0 ) ? 0x01 : 0x00 ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> } //<S2SV> p ++ ; //<S2SV> } //<S2SV> if ( ( image -> columns % 8 ) != 0 ) //<S2SV> { //<S2SV> for ( bit = 0 ; bit < ( image -> columns % 8 ) ; bit ++ ) //<S2SV> { //<S2SV> index = ( Quantum ) ( ( ( ( * p ) & ( 0x80 >> bit ) ) != 0 ) ? 0x01 : 0x00 ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> } //<S2SV> p ++ ; //<S2SV> } //<S2SV> ( void ) SyncAuthenticPixels ( image , exception ) ; //<S2SV> break ; //<S2SV> } //<S2SV> case 2 : //<S2SV> { //<S2SV> q = QueueAuthenticPixels ( image , 0 , y , image -> columns , 1 , exception ) ; //<S2SV> if ( q == ( Quantum * ) NULL ) //<S2SV> break ; //<S2SV> for ( x = 0 ; x < ( ( ssize_t ) image -> columns - 1 ) ; x += 2 ) //<S2SV> { //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 6 ) & 0x3 , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 4 ) & 0x3 , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 2 ) & 0x3 , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> index = ConstrainColormapIndex ( image , ( * p ) & 0x3 , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> p ++ ; //<S2SV> } //<S2SV> if ( ( image -> columns % 4 ) != 0 ) //<S2SV> { //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 6 ) & 0x3 , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> if ( ( image -> columns % 4 ) >= 1 ) //<S2SV> { //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 4 ) & 0x3 , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> if ( ( image -> columns % 4 ) >= 2 ) //<S2SV> { //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 2 ) & 0x3 , //<S2SV> exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> } //<S2SV> } //<S2SV> p ++ ; //<S2SV> } //<S2SV> ( void ) SyncAuthenticPixels ( image , exception ) ; //<S2SV> break ; //<S2SV> } //<S2SV> case 4 : //<S2SV> { //<S2SV> q = QueueAuthenticPixels ( image , 0 , y , image -> columns , 1 , exception ) ; //<S2SV> if ( q == ( Quantum * ) NULL ) //<S2SV> break ; //<S2SV> for ( x = 0 ; x < ( ( ssize_t ) image -> columns - 1 ) ; x += 2 ) //<S2SV> { //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 4 ) & 0xf , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> index = ConstrainColormapIndex ( image , ( * p ) & 0xf , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> p ++ ; //<S2SV> } //<S2SV> if ( ( image -> columns % 2 ) != 0 ) //<S2SV> { //<S2SV> index = ConstrainColormapIndex ( image , ( * p >> 4 ) & 0xf , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> p ++ ; //<S2SV> } //<S2SV> ( void ) SyncAuthenticPixels ( image , exception ) ; //<S2SV> break ; //<S2SV> } //<S2SV> case 8 : //<S2SV> { //<S2SV> q = QueueAuthenticPixels ( image , 0 , y , image -> columns , 1 , exception ) ; //<S2SV> if ( q == ( Quantum * ) NULL ) //<S2SV> break ; //<S2SV> for ( x = 0 ; x < ( ssize_t ) image -> columns ; x ++ ) //<S2SV> { //<S2SV> index = ConstrainColormapIndex ( image , * p , exception ) ; //<S2SV> SetPixelIndex ( image , index , q ) ; //<S2SV> p ++ ; //<S2SV> q += GetPixelChannels ( image ) ; //<S2SV> } //<S2SV> ( void ) SyncAuthenticPixels ( image , exception ) ; //<S2SV> break ; //<S2SV> } //<S2SV> } //<S2SV> } //<S2SV> 