gboolean //<S2SV> _pango_emoji_iter_next ( PangoEmojiIter * iter ) //<S2SV> { //<S2SV> PangoEmojiType current_emoji_type = PANGO_EMOJI_TYPE_INVALID ; //<S2SV> if ( iter -> end == iter -> text_end ) //<S2SV> return FALSE ; //<S2SV> iter -> start = iter -> end ; //<S2SV> for ( ; iter -> end < iter -> text_end ; iter -> end = g_utf8_next_char ( iter -> end ) ) //<S2SV> { //<S2SV> gunichar ch = g_utf8_get_char ( iter -> end ) ; //<S2SV> if ( ( ! ( ch == kZeroWidthJoinerCharacter && ! iter -> is_emoji ) && //<S2SV> ch != kVariationSelector15Character && //<S2SV> ch != kVariationSelector16Character && //<S2SV> ch != kCombiningEnclosingCircleBackslashCharacter && //<S2SV> ! _pango_Is_Regional_Indicator ( ch ) && //<S2SV> ! ( ( ch == kLeftSpeechBubbleCharacter || //<S2SV> ch == kRainbowCharacter || //<S2SV> ch == kMaleSignCharacter || //<S2SV> ch == kFemaleSignCharacter || //<S2SV> ch == kStaffOfAesculapiusCharacter ) && //<S2SV> ! iter -> is_emoji ) ) || //<S2SV> current_emoji_type == PANGO_EMOJI_TYPE_INVALID ) { //<S2SV> current_emoji_type = _pango_get_emoji_type ( ch ) ; //<S2SV> } //<S2SV> if ( g_utf8_next_char ( iter -> end ) < iter -> text_end ) //<S2SV> { //<S2SV> gunichar peek_char = g_utf8_get_char ( g_utf8_next_char ( iter -> end ) ) ; //<S2SV> if ( current_emoji_type == //<S2SV> PANGO_EMOJI_TYPE_EMOJI_EMOJI && //<S2SV> peek_char == kVariationSelector15Character ) { //<S2SV> current_emoji_type = PANGO_EMOJI_TYPE_EMOJI_TEXT ; //<S2SV> } //<S2SV> if ( ( current_emoji_type == //<S2SV> PANGO_EMOJI_TYPE_EMOJI_TEXT || //<S2SV> _pango_Is_Emoji_Keycap_Base ( ch ) ) && //<S2SV> peek_char == kVariationSelector16Character ) { //<S2SV> current_emoji_type = PANGO_EMOJI_TYPE_EMOJI_EMOJI ; //<S2SV> } //<S2SV> if ( _pango_Is_Emoji_Keycap_Base ( ch ) && //<S2SV> peek_char == kCombiningEnclosingKeycapCharacter ) { //<S2SV> current_emoji_type = PANGO_EMOJI_TYPE_EMOJI_EMOJI ; //<S2SV> } ; //<S2SV> if ( _pango_Is_Regional_Indicator ( ch ) && //<S2SV> _pango_Is_Regional_Indicator ( peek_char ) ) { //<S2SV> current_emoji_type = PANGO_EMOJI_TYPE_EMOJI_EMOJI ; //<S2SV> } //<S2SV> if ( ( ch == kEyeCharacter || //<S2SV> ch == kWavingWhiteFlagCharacter ) && //<S2SV> peek_char == kZeroWidthJoinerCharacter ) { //<S2SV> current_emoji_type = PANGO_EMOJI_TYPE_EMOJI_EMOJI ; //<S2SV> } //<S2SV> } //<S2SV> if ( iter -> is_emoji == ( gboolean ) 2 ) //<S2SV> iter -> is_emoji = ! PANGO_EMOJI_TYPE_IS_EMOJI ( current_emoji_type ) ; //<S2SV> if ( iter -> is_emoji == PANGO_EMOJI_TYPE_IS_EMOJI ( current_emoji_type ) ) //<S2SV> { //<S2SV> iter -> is_emoji = ! PANGO_EMOJI_TYPE_IS_EMOJI ( current_emoji_type ) ; //<S2SV> return TRUE ; //<S2SV> } //<S2SV> } //<S2SV> iter -> is_emoji = PANGO_EMOJI_TYPE_IS_EMOJI ( current_emoji_type ) ; //<S2SV> return TRUE ; //<S2SV> } //<S2SV> 