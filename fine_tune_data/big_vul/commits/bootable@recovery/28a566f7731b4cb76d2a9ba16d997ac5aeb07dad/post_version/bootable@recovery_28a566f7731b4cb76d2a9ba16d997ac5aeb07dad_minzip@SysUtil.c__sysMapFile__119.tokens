int sysMapFile ( const char * fn , MemMapping * pMap ) //<S2SV> { //<S2SV> memset ( pMap , 0 , sizeof ( * pMap ) ) ; //<S2SV> if ( fn && fn [ 0 ] == '@' ) { //<S2SV> FILE * mapf = fopen ( fn + 1 , "r" ) ; //<S2SV> if ( mapf == NULL ) { //<S2SV> LOGV ( "Unable<S2SV_blank>to<S2SV_blank>open<S2SV_blank>\'%s\':<S2SV_blank>%s\\n" , fn + 1 , strerror ( errno ) ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> if ( sysMapBlockFile ( mapf , pMap ) != 0 ) { //<S2SV> LOGW ( "Map<S2SV_blank>of<S2SV_blank>\'%s\'<S2SV_blank>failed\\n" , fn ) ; //<S2SV> fclose ( mapf ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> fclose ( mapf ) ; //<S2SV> } else { //<S2SV> int fd = open ( fn , O_RDONLY , 0 ) ; //<S2SV> if ( fd < 0 ) { //<S2SV> LOGE ( "Unable<S2SV_blank>to<S2SV_blank>open<S2SV_blank>\'%s\':<S2SV_blank>%s\\n" , fn , strerror ( errno ) ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> if ( sysMapFD ( fd , pMap ) != 0 ) { //<S2SV> LOGE ( "Map<S2SV_blank>of<S2SV_blank>\'%s\'<S2SV_blank>failed\\n" , fn ) ; //<S2SV> close ( fd ) ; //<S2SV> return - 1 ; //<S2SV> } //<S2SV> close ( fd ) ; //<S2SV> } //<S2SV> return 0 ; //<S2SV> } //<S2SV> 