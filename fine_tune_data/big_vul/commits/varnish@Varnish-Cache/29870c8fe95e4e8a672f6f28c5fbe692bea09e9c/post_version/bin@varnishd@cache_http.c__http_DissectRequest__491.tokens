uint16_t //<S2SV> http_DissectRequest ( struct sess * sp ) //<S2SV> { //<S2SV> struct http_conn * htc ; //<S2SV> struct http * hp ; //<S2SV> uint16_t retval ; //<S2SV> CHECK_OBJ_NOTNULL ( sp , SESS_MAGIC ) ; //<S2SV> htc = sp -> htc ; //<S2SV> CHECK_OBJ_NOTNULL ( htc , HTTP_CONN_MAGIC ) ; //<S2SV> hp = sp -> http ; //<S2SV> CHECK_OBJ_NOTNULL ( hp , HTTP_MAGIC ) ; //<S2SV> hp -> logtag = HTTP_Rx ; //<S2SV> retval = http_splitline ( sp -> wrk , sp -> fd , hp , htc , //<S2SV> HTTP_HDR_REQ , HTTP_HDR_URL , HTTP_HDR_PROTO ) ; //<S2SV> if ( retval != 0 ) { //<S2SV> WSPR ( sp , SLT_HttpGarbage , htc -> rxbuf ) ; //<S2SV> return ( retval ) ; //<S2SV> } //<S2SV> http_ProtoVer ( hp ) ; //<S2SV> retval = htc_request_check_hdrs ( sp , hp ) ; //<S2SV> return ( retval ) ; //<S2SV> } //<S2SV> 